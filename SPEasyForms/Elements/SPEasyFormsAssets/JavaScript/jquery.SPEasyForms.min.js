/*
 * SPEasyForms - modify SharePoint forms using jQuery (i.e. put fields on
 * tabs, show/hide fields, validate field values, modify the controls used 
 * to enter field values etc.)
 *
 * 
 * @requires jQuery-ui v1.9.2 
 * @requires jQuery.SPServices v2015.02 or greater
 * @optional ssw Session Storage Wrapper - Cross Document Transport of
 *    JavaScript Data; used to cache the context across pages if available
 *    and options.useCache === true
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
function shouldSPEasyFormsRibbonButtonBeEnabled(){return spefjQuery.spEasyForms.isConfigurableList()?!0:!1}(function(n,t){function f(){for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++)return/jquery.speasyforms.*\.js/.test(t[n].src)?t[n]:_spPageContextInfo.siteServerRelativeUrl+"/Style Library/SPEasyFormsAssets/2018.03/JavaSccript/jquery.SPEasyForms.min.js"}var u,r,i;typeof n!="undefined"&&(typeof SPClientTemplates!="undefined"&&SPClientTemplates.TemplateManager&&SPClientTemplates.TemplateManager.RegisterTemplateOverrides&&(window.location.href.indexOf("start.aspx#")>=0&&(u=f(),RegisterModuleInit(u,function(){SPClientTemplates.TemplateManager.RegisterTemplateOverrides({OnPreRender:function(){n("body").attr("data-speasyforms-formhidden")!=="true"&&n("body").attr("data-speasyforms-formhidden","true").append("<style type='text/css'>.ms-formtable { display: none; }<\/style>")}})})),SPClientTemplates.TemplateManager.RegisterTemplateOverrides({OnPreRender:function(){n("body").attr("data-speasyforms-formhidden")!=="true"&&n("body").attr("data-speasyforms-formhidden","true").append("<style type='text/css'>.ms-formtable { display: none; }<\/style>")}})),Object.keys||(Object.keys=function(t){return n.map(t,function(n,t){return t})}),Object.create||(Object.create=function(n){function t(){}return t.prototype=n,new t}),r=typeof ssw!="undefined"?ssw.get():t,n.spEasyForms={defaults:{useCache:typeof ssw!="undefined"||typeof ssw_init!="undefined",maxWebCache:6,maxListCache:10,maxNestingLevels:5,jQueryUITheme:"~sitecollection/Style Library/SPEasyFormsAssets/~version/Css/jquery-ui-redmond/jquery-ui.css",css:"~sitecollection/Style Library/SPEasyFormsAssets/~version/Css/speasyforms.css",formBodySelector:"table td.ms-formbody",fieldInternalNameRegex:/FieldInternalName=\"([^\"]*)\"/i,fieldDisplayNameRegex:/FieldName=\"([^\"]*)\"/i,fieldTypeRegex:/FieldType=\"([^\"]*)\"/i,fieldDisplayNameAltSelector:"h3.ms-standardheader",verbose:window.location.href.indexOf("spEasyFormsVerbose=true")>=0,initAsync:window.location.href.indexOf("spEasyFormsAsync=false")<0,version:"2018.03",jQueryUIGallery:["lilac","olive","redmond","salmon","smoothness","sunny"],loadDynamicStylesAlways:!1},isConfigurableList:function(t){var r=n.extend({},i.defaults,t);return(r.currentListContext||(r.currentListContext=n.spEasyForms.sharePointContext.getListContext(this.defaults)),!r.currentListContext)?!1:r.currentListContext.template==="102"||r.currentListContext.template==="108"?!1:!0},init:function(t){var r=n.extend({},i.defaults,t),e,o,u,f;if(!/\/SPEasyFormsSettings[a-zA-Z]*.aspx/.test(window.location.href)&&(e=n("td.ms-formlabel h3.ms-standardheader, td.ms-formlabel span.ms-standardheader"),o=e.first().closest("table"),o.find("iframe[id$='TextField_iframe']").length>0)){n("table.ms-formtable").show();ExecuteOrDelayUntilScriptLoaded(function(){var t=SP.UI.ModalDialog.get_childDialog();t!==null&&setTimeout(function(){(n(".ms-formtable").css("display")==="none"||n("#spEasyFormsContainersPre").length>0)&&n.spEasyForms.utilities.resizeModalDialog()},3e3)},"sp.ui.dialog.js");return}this.initCacheLibrary(r);r.callback=i.contextReady;this.options=r;n("#spEasyFormsBusyScreen").dialog({autoOpen:!1,dialogClass:"speasyforms-busyscreen",closeOnEscape:!1,draggable:!1,width:250,minHeight:25,modal:!0,buttons:{},resizable:!1});n("#spEasyFormsBusyScreen").html("Initializing Form...").dialog("open");r.initAsync?n.spEasyForms.sharePointContext.initAsync(r):this.contextReady(t);ExecuteOrDelayUntilScriptLoaded(function(){var t=SP.UI.ModalDialog.get_childDialog();t!==null&&setTimeout(function(){(n(".ms-formtable").css("display")==="none"||n("#spEasyFormsContainersPre").length>0)&&n.spEasyForms.utilities.resizeModalDialog()},3e3)},"sp.ui.dialog.js");u=n.spEasyForms.utilities.getRequestParameters();f=n.spEasyForms.sharePointFieldRows.init(t);n.each(Object.keys(u),function(t,i){if(i.indexOf("spef_")===0){var e=i.substring(5);e in f&&(r.row=f[e],r.value=u[i],n.spEasyForms.sharePointFieldRows.setValue(r))}});n.spEasyForms.defaults.verbose&&n("#spEasyFormsDiagButton").show().click(function(){var i=window.open();i.document.write("<pre>\n"+JSON.stringify(n.spEasyForms.sharePointContext.getListContext(t),null,4)+"\n<\/pre>");i.document.close()})},contextReady:function(t){var r=n.extend({},i.defaults,t),u,f;try{r.currentContext=n.spEasyForms.sharePointContext.get(r);r.source=n.spEasyForms.utilities.getRequestParameters(r).Source;r.currentListContext=n.spEasyForms.sharePointContext.getListContext(r);r.loadDynamicStylesAlways&&i.loadDynamicStyles(r);i.isSettingsPage(r)?i.containsOldRichTextFields(r)||i.toEditor(r):i.isTransformable(r)?(i.transform(r),_spPageContextInfo.webUIVersion===4&&(u=function(n){return n.substr(0,n.indexOf("?"))},u(document.referrer)!==u(window.location.href)?n("span.ms-error, span.ms-formvalidation").hide():n("span.ms-error, span.ms-formvalidation").show(),f=n("span.ms-formvalidation[role='alert']"),n.each(f,function(t,i){n(i).prev().hasClass("ms-formvalidation")&&n(i).hide()}))):i.isConfigurableListSettings(r)?i.insertListSettingsLink(r):window.location.href.toLowerCase().indexOf("/settings.aspx")>0&&i.insertSiteSettingsLink(r)}finally{n("table.ms-formtable ").show();ExecuteOrDelayUntilScriptLoaded(function(){var t=SP.UI.ModalDialog.get_childDialog();t!==null&&setTimeout(function(){(n(".ms-formtable").css("display")==="none"||n("#spEasyFormsContainersPre").length>0)&&n.spEasyForms.utilities.resizeModalDialog()},3e3)},"sp.ui.dialog.js");n("#spEasyFormsBusyScreen").dialog("close")}return this},containsOldRichTextFields:function(i){var r=[],f=function(){var t=!1;return r=[],n.each(Object.keys(i.currentListContext.schema),function(u,f){var e=i.currentListContext.schema[f];e.type==="Note"&&e.subtype==="RichText"&&(n.inArray(e.displayName,r)<0&&r.push(e.displayName),t=!0)}),t},u=f(),e;return u===!0&&(n.spEasyForms.clearCachedContext(i),n.spEasyForms.sharePointContext.ctx=t,i.currentContext=n.spEasyForms.sharePointContext.get(i),i.currentListContext=n.spEasyForms.sharePointContext.getListContext(i),u=f(),u===!0&&(n.spEasyForms.loadDynamicStyles(i),n("#spEasyFormsBusyScreen").dialog("close"),e={modal:!0,buttons:{Ok:function(){return window.location.href=n.spEasyForms.utilities.getRequestParameters(i).Source,!1}},autoOpen:!1,width:400},n("#spEasyFormsErrorDialog").attr("title","Unsupported Field Type"),n("#spEasyFormsErrorDialog").html("This list contains Rich Text Multi-line fields, which are not compatible with SPEasyForms (The display name(s) are: <b>"+r.join(", ")+"<\/b>).<br/><br/>If you wish to configure this list with SPEasyForms, you must change them to either Enhanced Rich Text or Plain Text Multi-line fields."),n("#spEasyFormsErrorDialog").dialog(e),n("#spEasyFormsErrorDialog").dialog("open"))),u},isConfigurableListSettings:function(t){var r=n.extend({},i.defaults,t);return i.isConfigurableList(r)?window.location.href.toLowerCase().indexOf("listedit.aspx")>=0:!1},isSettingsPage:function(t){var r=n.extend({},i.defaults,t);return i.isConfigurableList(r)?/\/SPEasyFormsSettings[a-zA-Z]*.aspx/.test(window.location.href):(/\/SPEasyFormsSettings[a-zA-Z]*.aspx/.test(window.location.href)&&n("#spEasyFormsInitializationError").show(),!1)},isTransformable:function(t){var r=n.extend({},i.defaults,t);return i.isConfigurableList(r)?n.spEasyForms.visibilityRuleCollection.getFormType(r).length===0?!1:n.spEasyForms.visibilityRuleCollection.getFormType(r)==="new"&&window.location.href.toLowerCase().indexOf("&type=1&")>=0?!1:window.location.href.toLowerCase().indexOf("&contenttypeid=0x0120")>=0?!1:!0:!1},transform:function(t){var r,i,u;t.currentConfig=n.spEasyForms.configManager.get(t);n.spEasyForms.defaults.formId="WPQ2";try{r=n("input[id$='_diidIOSaveItem']")[0].getAttributeNode("onclick").nodeValue;i=r.match(/SPClientForms\.ClientFormManager.SubmitClientForm\(\'([^\']*)\'/);i&&i.length>=2&&(n.spEasyForms.defaults.formId=i[1])}catch(f){}if(t.currentConfig.layout.def.length===1&&n.isEmptyObject(t.currentConfig.adapters.def)&&n.isEmptyObject(t.currentConfig.visibility.def)){u=SP.UI.ModalDialog.get_childDialog();u!==null&&setTimeout(function(){n.spEasyForms.utilities.resizeModalDialog()},3e3);return}n(".ms-lookuptypeintextbox").each(function(){n().SPServices.SPComplexToSimpleDropdown({columnName:n(this).attr("title"),debug:t.verbose})});n("table.ms-formtable").length===0&&n("td.ms-formlabel h3.ms-standardheader, td.ms-formlabel span.ms-standardheader").first().closest("table").addClass("ms-formtable");n.spEasyForms.containerCollection.transform(t);_spPageContextInfo.webUIVersion===4&&n(".ui-widget input").css("font-size","8pt");n("input[id$='_diidIOSaveItem']").each(function(){var n,t;null!==this.getAttributeNode("onclick")&&(n=this.getAttributeNode("onclick").nodeValue,n=n.replace(/return false;/g,"return spefjQuery.spEasyForms.containerCollection.postValidationAction();"),t=document.createAttribute("onclick"),t.value=n,this.setAttributeNode(t))})},toEditor:function(t){t.currentConfig=n.spEasyForms.configManager.get(t);n("#msCuiTopbar").prepend("<h2 class='speasyforms-breadcrumbs'><a href='"+t.source+"'>"+t.currentListContext.title+"<\/a>  -&gt; SPEasyForms Configuration<\/h2>");n.each(t.currentListContext.contentTypes.order,function(i,r){r.indexOf("0x0120")!==0&&n("#spEasyFormsContentTypeSelect").append("<option value='"+t.currentListContext.contentTypes[r].id+"'>"+t.currentListContext.contentTypes[r].name+"<\/option>")});n("#spEasyFormsContentTypeSelect").change(function(){delete n.spEasyForms.containerCollection.rows;delete n.spEasyForms.sharePointContext.formCache;t.contentTypeChanged=!0;t.refresh=n.spEasyForms.refresh.all;n.spEasyForms.containerCollection.toEditor(t)});n.spEasyForms.containerCollection.toEditor(t);n(window).on("beforeunload",function(){if(!n("#spEasyFormsSaveButton").hasClass("speasyforms-disabled"))return"You have unsaved changes, are you sure you want to leave the page?"});var i=n("#suiteBarTop").height()+n("#suitBar").height()+n("#s4-ribbonrow").height()+n("#spEasyFormsRibbon").height()+37;n("div.speasyforms-panel").height(n(window).height()-i);n("#spEasyFormsContent").height(n(window).height()-i).width(n(window).width()-460);n(window).resize(function(){n("div.speasyforms-panel").height(n(window).height()-i);n("#spEasyFormsContent").height(n(window).height()-i).width(n(window).width()-460)});n("#spEasyFormsRibbon").show()},insertListSettingsLink:function(t){var r=n("td.ms-descriptiontext:contains('description and navigation')").closest("table"),e=n("a:contains('Permissions for this list')"),i,u,f;e.length>0&&r.length>0&&(i=window.location.href,i.indexOf("start.aspx#")>=0&&(i=n.spEasyForms.utilities.webRelativePathAsAbsolutePath(i.substring(i.indexOf("#")+1))),u=n.spEasyForms.utilities.siteRelativePathAsAbsolutePath("/Style Library/SPEasyFormsAssets/2018.03/Pages/SPEasyFormsSettings.aspx")+"?ListId="+n.spEasyForms.sharePointContext.getCurrentListId(t)+"&SiteUrl="+n.spEasyForms.sharePointContext.getCurrentSiteUrl(t)+"&Source="+encodeURIComponent(i),f="<tr><td style='padding-top: 5px;' class='ms-descriptiontext ms-linksectionitembullet' vAlign='top' width='8' noWrap='nowrap'><img alt='' src='/_layouts/images/setrect.gif?rev=37' width='5' height='5' />&nbsp;<\/td><td class='ms-descriptiontext ms-linksectionitemdescription' vAlign='top'> <a href='"+u+"'>SPEasyForms Configuration<\/a><\/td><\/tr>",r.append(f))},insertSiteSettingsLink:function(){var f=n("h3:contains('Users and Permissions')"),e=f.next().find("a:contains('Site collection administrators')"),i,t,r,u;e.length>0&&(i=n("h3:contains('Site Collection Administration')").next(),i.length>0&&(t=window.location.href,t.indexOf("start.aspx#")>=0&&(t=n.spEasyForms.utilities.webRelativePathAsAbsolutePath(t.substring(t.indexOf("#")+1))),r=n.spEasyForms.utilities.siteRelativePathAsAbsolutePath("/Style Library/SPEasyFormsAssets/2018.03/Pages/SPEasyFormsSiteSettings.aspx")+"?Source="+encodeURIComponent(t),u="<li class='ms-linksection-listItem'><a title='Restore or permanently remove items that users have deleted on this site.' href='"+r+"'>SPEasyForms<\/a><\/li>",i.append(u)))},initCacheLibrary:function(n){typeof r=="undefined"&&n.cache!==t&&(r=n.cache);typeof ssw=="undefined"&&typeof ssw_init!="undefined"&&(ssw_init(window,document),typeof r=="undefined"&&(r=ssw.get()))},loadDynamicStyles:function(t){var r=n.extend({},i.defaults,t),u;r.currentConfig=n.spEasyForms.configManager.get(r);r.source="~sitecollection/Style Library/SPEasyFormsAssets/2018.03/Css/jquery-ui-smoothness/jquery-ui.css";u=this.replaceVariables(r);r.currentConfig&&r.currentConfig.jQueryUITheme?(r.source=r.currentConfig.jQueryUITheme,u=this.replaceVariables(r)):r.jQueryUITheme&&(r.source=r.jQueryUITheme,u=this.replaceVariables(r));n("head").append('<link rel="stylesheet" type="text/css" href="'+u+'">');r.source=r.css;u=this.replaceVariables(r);n("head").append('<link rel="stylesheet" type="text/css" href="'+u+'">');n.spEasyForms.userDefaults.additionalFiles&&n.each(n(n.spEasyForms.userDefaults.additionalFiles),function(t,i){if(/\.css$/.test(i)){r.source=i;var u=n.spEasyForms.replaceVariables(r);n("head").append('<link rel="stylesheet" type="text/css" href="'+u+'">')}})},replaceVariables:function(n){return n.source=n.currentContext.siteRelativeUrl.length===1?n.source.replace(/~sitecollection/g,""):n.source.replace(/~sitecollection/g,n.currentContext.siteRelativeUrl),n.source=n.source.replace(/~site/g,n.currentContext.webRelativeUrl),n.source=n.source.replace(/~version/g,n.version),n.source},clearCachedContext:function(t){var u=n.extend({},i.defaults,t);u.useCache&&(r={},ssw.clear())},writeCachedContext:function(t){var u=n.extend({},i.defaults,t),f,e;typeof ssw!="undefined"&&(f="spEasyForms_spContext_"+u.currentContext.webRelativeUrl,f in r||Object.keys(r).length>=u.maxWebCache&&ssw.remove(Object.keys(r)[0]),e={},e[f]=u.currentContext,ssw.add(e))},readCachedContext:function(u){var f=n.extend({},i.defaults,u),e;return f.useCache===!0?(e="spEasyForms_spContext_",f.siteUrl&&(e+=f.siteUrl),r[e]):t}},i=n.spEasyForms)})(typeof spefjQuery=="undefined"?undefined:spefjQuery);
/*
 * SPEasyForms.utilites - general helper functions for SPEasyForms
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n,t){n.spEasyForms.utilities={jsCase:function(n){return n[0].toLowerCase()+n.substring(1)},titleCase:function(n){return n[0].toUpperCase()+n.substring(1)},parseJSON:function(i){return typeof i=="undefined"||i===null||i.length===0?t:n.parseJSON(i)},getRequestParameters:function(){var f={},n,t,u,i,r;if(window.location.search.length>0&&window.location.search.indexOf("?")>=0?(t=window.location.search.indexOf("?")+1,n=window.location.search.substr(t)):window.location.href.indexOf("start.aspx#")>=0&&window.location.href.indexOf("?")>=0&&(t=window.location.href.indexOf("?")+1,n=window.location.href.substr(t)),n)for(u=n.split("&"),i=0;i<u.length;i++)r=u[i].split("=",2),r.length===2&&(f[r[0]]=decodeURIComponent(r[1]));return f},siteRelativePathAsAbsolutePath:function(n){var t=_spPageContextInfo.siteServerRelativeUrl;return n[0]!=="/"&&(n="/"+n),t!=="/"&&(n=t+n),n},webRelativePathAsAbsolutePath:function(t){var i=n.spEasyForms.sharePointContext.getCurrentSiteUrl();return t[0]!=="/"&&(t="/"+t),i!=="/"&&(t=i+t),t},extend:function(n,t){for(var i in t)i in n||(n[i]=t[i]);return n},isDate:function(n){var t=new Date(n);return t instanceof Date&&!isNaN(t.valueOf())},highlight:function(t,i){n("table.ms-formtable").attr("data-visibility"+i)!=="true"&&(n("head").append("<style>.speasyforms-"+i+" { background-color: "+i+"; }<\/style>"),n("table.ms-formtable").attr("data-visibility"+i,"true"));t.find("td").addClass("speasyforms-"+i).attr("data-visibilityclassadded","speasyforms-"+i)},resizeModalDialog:function(){var f,t;if(typeof SP.UI.ModalDialog!="undefined"&&typeof SP.UI.ModalDialog.get_childDialog=="function"&&(f=SP.UI.ModalDialog.get_childDialog(),f!==null)){SP.UI.ModalDialog.get_childDialog().autoSize();var i=n(".ms-dlgContent",window.parent.document),r=(n(window.top).height()-i.outerHeight())/2,u=(n(window.top).width()-i.outerWidth())/2;i.css({top:r>0?r:0,left:u>0?u:0});i.prev().css({top:r>0?r:0,left:u>0?u:0});t=n(".ms-dlgFrame",window.parent.document);t.height()>n(window.parent).height()&&t.height(n(window.parent).height());t.width()>n(window.parent).width()&&t.width(n(window.parent).width())}}};n.spEasyForms.relationshipListAdapterHelper=function(t){var i=n.extend({},n.spEasyForms.defaults,t),r=this;this.initDialog=function(){var t={modal:!0,buttons:{Ok:function(){if(i.currentConfig=n.spEasyForms.containerCollection.toConfig(i),i.adapters=i.currentConfig.adapters.def,i.relationship.relationshipParentColumn&&n.spEasyForms.adapterCollection.validateRequired({id:i.relationship.relationshipParentColumn.id,displayName:i.relationship.relationshipParentColumn.displayName}),n.spEasyForms.adapterCollection.validateRequired({id:i.relationship.relationshipChildColumn.id,displayName:i.relationship.relationshipChildColumn.displayName}),n.spEasyForms.adapterCollection.validateRequired({id:i.relationship.formParentColumn.id,displayName:i.relationship.formParentColumn.displayName}),n.spEasyForms.adapterCollection.validateRequired({id:i.relationship.formChildColumn.id,displayName:i.relationship.formChildColumn.displayName}),n("#"+i.relationship.dialogDiv).find(".speasyforms-error").length===0){if(i.currentConfig.adapters||(i.currentConfig.adapters={}),i.currentConfig.adapters.def||(i.currentConfig.adapters.def={}),i.adapters=i.currentConfig.adapters.def,n("#"+i.relationship.relationshipListColumn.id).val().length===0)i.adapterField in i.adapters&&delete i.adapters[i.adapterField],n.spEasyForms.configManager.set(i),n("#"+i.relationship.dialogDiv).dialog("close"),i.refresh=n.spEasyForms.refresh.adapters,n.spEasyForms.containerCollection.toEditor(i);else{var t={};i.fieldName&&i.fieldName in i.adapters?t=i.adapters[i.fieldName]:i.adapters[i.fieldName]=t;t.type=i.relationship.type;t.relationshipList=n("#"+i.relationship.relationshipListColumn.id).val();t.relationshipListTitle=n("#"+i.relationship.relationshipListColumn.id+" option:selected").text();i.relationship.relationshipParentColumn&&(t.relationshipListParentColumn=n("#"+i.relationship.relationshipParentColumn.id).val());t.relationshipListChildColumn=n("#"+i.relationship.relationshipChildColumn.id).val();t.parentColumnInternal=n("#"+i.relationship.formParentColumn.id).val();t.columnNameInternal=n("#"+i.relationship.formChildColumn.id).val();i.relationship.updateCallback&&i.relationship.updateCallback(t);n.spEasyForms.configManager.set(i);n("#"+i.relationship.dialogDiv).dialog("close");i.refresh=n.spEasyForms.refresh.adapters;n.spEasyForms.containerCollection.toEditor(i)}return!1}},Cancel:function(){return n("#"+i.relationship.dialogDiv).dialog("close"),!1}},autoOpen:!1,width:650};n("#"+i.relationship.dialogDiv).dialog(t)};this.initControls=function(){var u=n.spEasyForms.sharePointContext.getListCollection(i),t;n.each(u,function(t,r){n("#"+i.relationship.relationshipListColumn.id).append("<option value='"+r.id+"'>"+r.title+"<\/option>")});n("#"+i.relationship.formListColumn.id).val(i.currentListContext.title);n("#"+i.relationship.relationshipListColumn.id).attr("data-change")!=="true"&&(n("#"+i.relationship.relationshipListColumn.id).attr("data-change","true"),n("#"+i.relationship.relationshipListColumn.id).change(function(){r.initRelationshipFields(i)}),i.relationship.relationshipParentColumn&&n("#"+i.relationship.relationshipParentColumn.id).change(function(){n("#"+i.relationship.relationshipChildColumn.id).find("option[value='"+n("#"+i.relationship.relationshipParentColumn.id).val()+"']").length>0&&n("#"+i.relationship.relationshipChildColumn.id).find("option[text='"+n("#"+i.relationship.relationshipParentColumn.id).text()+"']")}));n("#"+i.relationship.formChildColumn.id).val(i.fieldName);i.adapters=i.currentConfig.adapters.def;i.fieldName in i.adapters&&(t=i.adapters[i.fieldName],n("#"+i.relationship.relationshipListColumn.id).val(t.relationshipList),r.initRelationshipFields(i),i.relationship.relationshipParentColumn&&n("#"+i.relationship.relationshipParentColumn.id).val(t.relationshipListParentColumn),n("#"+i.relationship.relationshipChildColumn.id).val(t.relationshipListChildColumn),n("#"+i.relationship.formParentColumn.id).val(t.parentColumnInternal))};this.initRelationshipFields=function(){var t,r,u,f,e,o;i.relationship.relationshipParentColumn&&(n("#"+i.relationship.relationshipParentColumn.id).find("option").remove(),n("#"+i.relationship.relationshipParentColumn.id).append("<option><\/option>"),n("#"+i.relationship.relationshipParentColumn.id).val(""),n("#"+i.relationship.relationshipParentColumn.id).attr("disabled","disabled"));n("#"+i.relationship.relationshipChildColumn.id).find("option").remove();n("#"+i.relationship.relationshipChildColumn.id).append("<option><\/option>");n("#"+i.relationship.relationshipChildColumn.id).val("");n("#"+i.relationship.relationshipChildColumn.id).attr("disabled","disabled");n("#"+i.relationship.relationshipListColumn.id).val().length>0&&(i.listId=n("#"+i.relationship.relationshipListColumn.id).val().toLowerCase(),t=n.spEasyForms.sharePointContext.getListContext(i),n.each(Object.keys(t.fields),function(r,u){i.relationship.relationshipParentColumn&&t.fields[u].spFieldType==="SPFieldLookup"&&n("#"+i.relationship.relationshipParentColumn.id).append("<option value='"+t.fields[u].internalName+"'>"+t.fields[u].displayName+"<\/option>");n("#"+i.relationship.relationshipChildColumn.id).append("<option value='"+t.fields[u].internalName+"'>"+t.fields[u].displayName+"<\/option>")}),i.relationship.relationshipParentColumn&&(n("#"+i.relationship.relationshipParentColumn.id).removeAttr("disabled"),r=n("#"+i.relationship.relationshipParentColumn.id).find("option"),r.length===2&&(n("#"+i.relationship.relationshipParentColumn.id).val(n(r[1]).attr("value")),u=n("#"+i.relationship.relationshipParentColumn.id+" option:selected").text(),f=n("#"+i.relationship.relationshipChildColumn.id).find("option:contains('"+u+"')"),n("#"+i.relationship.relationshipChildColumn.id).val(f.val()))),n("#"+i.relationship.relationshipChildColumn.id).removeAttr("disabled"),e=n("#"+i.relationship.formChildColumn.id+" option:selected").text(),o=n("#"+i.relationship.relationshipChildColumn.id).find("option:contains('"+e+"')"),n("#"+i.relationship.relationshipChildColumn.id).val(o.val()))};this.constructDialog=function(){if(n("#"+i.relationship.dialogDiv).length===0){var t="<div id='"+i.relationship.dialogDiv+"' title='Lookup Detail' class='speasyforms-dialogdiv'><table id='"+i.relationship.dialogDiv+"Table' width='100%' cellpadding='0' cellspacing='0'><tr><td>"+i.relationship.relationshipListColumn.displayName+"<\/td><td><select id='"+i.relationship.relationshipListColumn.id+"'><option><\/option><\/select><\/td><td><\/td><\/tr><tr>"+(i.relationship.relationshipParentColumn?"<td><\/td><td>"+i.relationship.relationshipParentColumn.displayName+"<\/td><td><select id='"+i.relationship.relationshipParentColumn.id+"'><option><\/option><\/select><\/td>":"")+"<\/tr><tr><td><\/td><td>"+i.relationship.relationshipChildColumn.displayName+"<\/td><td><select id='"+i.relationship.relationshipChildColumn.id+"'><option><\/option><\/select><\/td><\/tr><tr><td>&nbsp;<\/td><\/tr><tr><td>"+i.relationship.formListColumn.displayName+"<\/td><td><input type='text' disabled='disabled' id='"+i.relationship.formListColumn.id+"' value=''/><\/td><td><\/td><\/tr><tr><td><\/td><td>"+i.relationship.formParentColumn.displayName+"<\/td><td><select id='"+i.relationship.formParentColumn.id+"'><option><\/option><\/select><\/td><\/tr><tr><td><\/td><td>"+i.relationship.formChildColumn.displayName+"<\/td><td><input type='text' id='"+i.relationship.formChildColumn.id+"' disabled='disabled'/><\/td><\/tr><\/table><\/div>";n("#spEasyFormsContainerDialogs").append(t)}};this.clearDialog=function(){n("#"+i.relationship.dialogDiv).find(".speasyforms-error").remove();n("#"+i.relationship.dialogDiv).find(".implementation-specific").remove();n("#"+i.relationship.relationshipListColumn.id).find("option").remove();n("#"+i.relationship.relationshipListColumn.id).append("<option><\/option>");n("#"+i.relationship.relationshipListColumn.id).val("");i.relationship.relationshipParentColumn&&(n("#"+i.relationship.relationshipParentColumn.id).find("option").remove(),n("#"+i.relationship.relationshipParentColumn.id).append("<option><\/option>"),n("#"+i.relationship.relationshipParentColumn.id).val(""),n("#"+i.relationship.relationshipParentColumn.id).attr("disabled","disabled"));n("#"+i.relationship.relationshipChildColumn.id).find("option").remove();n("#"+i.relationship.relationshipChildColumn.id).append("<option><\/option>");n("#"+i.relationship.relationshipChildColumn.id).val("");n("#"+i.relationship.relationshipChildColumn.id).attr("disabled","disabled");n("#"+i.relationship.relationshipChildColumn.id).find("option").remove();n("#"+i.relationship.relationshipChildColumn.id).append("<option><\/option>");n("#"+i.relationship.relationshipChildColumn.id).val("");var t=n.spEasyForms.containerCollection.rows;n.each(Object.keys(n.spEasyForms.containerCollection.rows).sort(n.spEasyForms.sharePointFieldRows.compareField),function(r,u){t[u].spFieldType==="SPFieldLookup"&&n("#"+i.relationship.formParentColumn.id).append("<option value='"+t[u].internalName+"'>"+t[u].displayName+"<\/option>")})}}})(spefjQuery);
/*
 * SPEasyForms.sharePointContext - object for capturing SharePoint context information
 * using web services.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n,t){n.spEasyForms.sharePointContext={get:function(i){var u=n.extend({},n.spEasyForms.defaults,i),r=this.ctx;return r===t&&(u.useCache&&(u.siteUrl=this.getCurrentSiteUrl(u),r=n.spEasyForms.readCachedContext(u)),typeof r=="undefined"&&(r={},r.siteRelativeUrl=_spPageContextInfo.siteServerRelativeUrl,r.webAppUrl=window.location.href.substring(0,window.location.href.indexOf(window.location.pathname)),r.webRelativeUrl=u.siteUrl,r.webUIVersion=_spPageContextInfo.webUIVersion,r.listId=this.getCurrentListId(u),r.userId=_spPageContextInfo.userId,r.userProfile={},r.userInformation={},r.listContexts={})),r.listId=this.getCurrentListId(u),u.useCache&&(u.currentContext=r,n.spEasyForms.writeCachedContext(u)),this.ctx=r,r},initAsync:function(t){var u=this.get(t),r=n.extend({},n.spEasyForms.defaults,t),f=[];r.useCache&&u.user&&!n.isEmptyObject(u.user)||f.push(n.ajax({async:!0,url:n.spEasyForms.utilities.webRelativePathAsAbsolutePath("/_layouts/userdisp.aspx")+"?Force=True&"+(new Date).getTime()}));r.useCache&&u.siteGroups&&!n.isEmptyObject(u.siteGroups)||f.push(n().SPServices({webURL:i.getCurrentSiteUrl(r),operation:"GetGroupCollectionFromWeb",async:!0,debug:r.verbose}));u.userInformation&&u.userInformation.name&&(r.useCache&&u.groups&&!n.isEmptyObject(u.groups)||f.push(n().SPServices({webURL:i.getCurrentSiteUrl(r),operation:"GetGroupCollectionFromUser",userLoginName:u.userInformation.name,async:!0,debug:r.verbose})));f.length>0?n.when.apply(n,f).done(function(){n(f).each(function(){if(this.status===200)if(this.responseText.indexOf("Personal Settings")>0){u.userInformation={};r.input=n(this.responseText);var t=n.spEasyForms.sharePointFieldRows.init(r);n.each(t,function(t,i){var r=n.spEasyForms.utilities.jsCase(i.internalName);u.userInformation[r]=i.row.find("td[id^='SPField']").text().trim()})}else n(this.responseText).find("GetGroupCollectionFromWebResponse").length>0?(i.siteGroups={},n(this.responseText).find("Group").each(function(){var t={};t.name=n(this).attr("Name");t.id=n(this).attr("ID");i.siteGroups[t.id]=t;i.siteGroups[t.name]=t})):n(this.responseText).find("GetGroupCollectionFromUserResponse").length>0&&(i.groups={},n(this.responseText).find("Group").each(function(){var t={};t.name=n(this).attr("Name");t.id=n(this).attr("ID");i.groups[t.id]=t;i.groups[t.name]=t}))});r.useCache&&(r.currentContext=u,n.spEasyForms.writeCachedContext(r));r.callback(t)}).fail(function(){r.callback(t)}):r.callback(t)},getUserInformation:function(t){var r=this.get(t),i=n.extend({},n.spEasyForms.defaults,t),u="userInformation"in r?r.userInformation:{},f;return(!i.useCache||"userId"in i||n.isEmptyObject(u))&&(f=typeof i.userId!="undefined"?"ID="+i.userId+"&":"",n.ajax({async:!1,url:n.spEasyForms.utilities.webRelativePathAsAbsolutePath("/_layouts/userdisp.aspx")+"?Force=True&"+f+"&"+(new Date).getTime(),complete:function(t){i.input=n(t.responseText);var u=n.spEasyForms.sharePointFieldRows.init(i);n.each(u,function(t,i){var u=n.spEasyForms.utilities.jsCase(i.internalName);r.userInformation[u]=i.row.find("td[id^='SPField']").text().trim()})}}),!i.useCache||"userId"in i||(r.userInformation=u,i.currentContext=r,n.spEasyForms.writeCachedContext(i))),u},getUserProfile:function(t){var u=this.get(t),r=n.extend({},n.spEasyForms.defaults,t),f="userProfile"in u?u.userProfile:{},e;return(!r.useCache||"accountName"in r||n.isEmptyObject(f))&&(e={webURL:i.getCurrentSiteUrl(r),operation:"GetUserProfileByName",async:!1,debug:r.verbose,completefunc:function(t){n(t.responseXML).SPFilterNode("PropertyData").each(function(){var t=n(this).find("Name").text().replace("SPS-","");t=n.spEasyForms.utilities.jsCase(t);f[t]=n(this).find("Value").text()})}},n().SPServices(e),!r.useCache||"accountName"in r||(u.userProfile=f,r.currentContext=u,n.spEasyForms.writeCachedContext(r))),f},getListContext:function(r){var u=n.extend({},n.spEasyForms.defaults,r),f,e,o;return(n.spEasyForms.initCacheLibrary(u),u.currentContext||(u.currentContext=i.get()),u.listId||(u.listId=this.getCurrentListId(u)),!u.listId)?t:(f={},u.useCache&&u.listId in u.currentContext.listContexts?f=u.currentContext.listContexts[u.listId]:(f.title="Unknow List Title",f.fields={},u.listId in u.currentContext.listContexts&&(f=u.currentContext.listContexts[u.listId]),e={},u.listId===i.getCurrentListId(n.spEasyForms.defaults)&&(u.dontIncludeNodes=!0,e=n.spEasyForms.sharePointFieldRows.init(u)),Object.keys(e).length===0?n.ajax({async:!1,url:n.spEasyForms.utilities.webRelativePathAsAbsolutePath("/_layouts/listform.aspx")+"?PageType=6&ListId="+u.listId+"&RootFolder=",complete:function(t){u.listId===i.getCurrentListId(u)&&(i.formCache=t.responseText);u.input=n(t.responseText);u.skipCalculatedFields=!0;e=n.spEasyForms.sharePointFieldRows.init(u);n.each(e,function(n,t){f.fields[t.internalName]=t})}}):n.each(e,function(n,t){f.fields[t.internalName]=t}),n().SPServices({async:!1,webURL:i.getCurrentSiteUrl(u),operation:"GetList",listName:u.listId,debug:u.verbose,completefunc:function(t){f.title=n(t.responseText).find("List").attr("Title");f.template=n(t.responseText).find("List").attr("ServerTemplate");f.feature=n(t.responseText).find("List").attr("FeatureId");f.baseType=n(t.responseText).find("List").attr("BaseType");f.defaultUrl=n(t.responseText).find("List").attr("DefaultViewUrl");f.schema={};n.each(n(t.responseText).find("Field"),function(t,i){var r,u,e;n(i).attr("Hidden")!=="hidden"&&(r={},r.name=n(i).attr("Name"),r.staticName=n(i).attr("StaticName"),r.id=n(i).attr("ID"),r.displayName=n(i).attr("DisplayName"),r.type=n(i).attr("Type"),r.type==="Calculated"&&(r.hasFormula=n(i).find("formula").length>0,r.hasFormula&&(r.formula=n(i).find("formula").text())),u=n(i).attr("RichText"),e=n(i).attr("RichTextMode"),r.subtype=u&&u.toLowerCase()==="true"&&(!e||e.toLowerCase()==="compatible")?"RichText":"",r.required=n(i).attr("Required"),f.schema[r.displayName]=r,f.schema[r.name]=r)})}}),n().SPServices({webURL:i.getCurrentSiteUrl(u),operation:"GetListContentTypes",listName:u.listId,async:!1,debug:u.verbose,completefunc:function(t){var i={},r;n(t.responseText).find("ContentTypes").attr("ContentTypeOrder")&&(i.order=n(t.responseText).find("ContentTypes").attr("ContentTypeOrder").split(","));r=[];n.each(n(t.responseText).find("ContentType"),function(t,u){var f={};f.name=n(u).attr("Name");f.id=n(u).attr("ID");f.description=n(u).attr("Description");i[f.id]=f;r.push(f.id)});i.order||(i.order=r);f.contentTypes=i}}),o=Object.keys(u.currentContext.listContexts).length,!(u.listId in u.currentContext.listContexts)&&o>=u.maxListCache&&delete u.currentContext.listContexts[Object.keys(u.currentContext.listContexts)[0]],f.listId=u.listId,u.currentContext.listContexts[u.listId]=f,n.spEasyForms.writeCachedContext(u)),f)},getListCollection:function(t){var r=n.extend({},n.spEasyForms.defaults,t);return i.listCollection?i.listCollection:(r.siteRelativeUrl||(r.siteRelativeUrl=this.getCurrentSiteUrl(r)),i.listCollection=[],n().SPServices({webURL:r.siteRelativeUrl,async:!1,operation:"GetListCollection",debug:r.verbose,completefunc:function(t){n.each(n(t.responseText).find("List"),function(t,r){var f=n(r).attr("ID"),e=n(r).attr("Title"),u={};u.id=f;u.title=e;i.listCollection.push(u)})}}),i.listCollection)},getUserGroups:function(r){var f=this.get(r),u=n.extend({},n.spEasyForms.defaults,r);return this.groups||(this.groups="groups"in f?f.groups:{}),(!u.useCache||"accountName"in u||this.groups===t||n.isEmptyObject(this.groups))&&n().SPServices({webURL:i.getCurrentSiteUrl(u),operation:"GetGroupCollectionFromUser",userLoginName:"accountName"in u&&u.accountName.length>0?u.accountName:this.getUserInformation(u).name,async:!1,debug:u.verbose,completefunc:function(t){n(t.responseXML).find("Group").each(function(){var t={};t.name=n(this).attr("Name");t.id=n(this).attr("ID");i.groups[t.id]=t;i.groups[t.name]=t})}}),this.groups},getSiteGroups:function(r){if(this.siteGroups)return this.siteGroups;var u=n.extend({},n.spEasyForms.defaults,r),f=this.get(r);return u.useCache&&f.siteGroups!==t&&!n.isEmptyObject(f.siteGroups)&&(this.siteGroups=f.siteGroups),this.siteGroups||(this.siteGroups={}),n().SPServices({webURL:i.getCurrentSiteUrl(u),operation:"GetGroupCollectionFromSite",async:!1,debug:u.verbose,completefunc:function(t){n(t.responseXML).find("Group").each(function(){var t={};t.name=n(this).attr("Name");t.id=n(this).attr("ID");i.siteGroups[t.id]=t;i.siteGroups[t.name]=t})}}),this.siteGroups},getConfig:function(r){var u=n.extend({},n.spEasyForms.defaults,r);return(u.currentContext=this.get(u),u.listId=this.getCurrentListId(u),!u.listId)?t:this.config&&u.listId===this.configListId?this.config:(u.lstContext=this.getListContext(u),window.location.href.toLowerCase().indexOf("fiddle")>=0&&u.lstContext.config!==t)?(u.currentConfig=u.lstContext.config,u.currentConfig=this.layout2Config(u),this.config=u.currentConfig,this.configListId=u.lstContext.listId,u.currentConfig):(u.configFileName||(u.configFileName=n.spEasyForms.utilities.webRelativePathAsAbsolutePath("/SiteAssets")+"/spef-layout-"+u.listId.replace("{","").replace("}","")+".txt"),n.ajax({type:"GET",url:u.configFileName,headers:{"Content-Type":"text/plain"},async:!1,cache:!1,success:function(t){var r=t,f=r.replace(/fieldGroup/g,"fieldCollection").replace(/childColumnInternal/g,"columnNameInternal").replace(/LookupDetailAdapter/g,"Lookup Detail").replace(/DefaultToCurrentUser/g,"Default To Current User");u.currentConfig=n.spEasyForms.utilities.parseJSON(f);u.currentConfig=i.layout2Config(u)},error:function(n,t,i){n.status===409?alert("The web service returned 409 - CONFLICT. This most likely means you do not have a 'Site Assets' library in the current site with a URL of SiteAssets. This is required before you can load and save SPEasyForms configuration files."):n.status!==404&&u.configFileName.indexOf("{")<0&&alert("Error getting configuration.\nStatus: "+n.status+"\nStatus Text: "+i)}}),this.fixAdapterListReferences(u),this.config=u.currentConfig,this.configListId=u.listId,u.currentConfig)},fixAdapterListReferences:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u;r.currentConfig&&r.currentConfig.adapters&&r.currentConfig.adapters.def&&(u=Object.keys(r.currentConfig.adapters.def),n.each(n(u),function(t,u){var e=new RegExp("List$"),f=r.currentConfig.adapters.def[u];n.each(n(Object.keys(f)),function(t,u){e.test(u)&&(u+"Title"in f?n.each(n(i.getListCollection(r)),function(n,t){t.title===f[u+"Title"]&&(f[u]=t.id)}):n.each(n(i.getListCollection(r)),function(n,t){t.id===f[u]&&(f[u+"Title"]=t.title)}))})}))},setConfig:function(i){var r=n.extend({},n.spEasyForms.defaults,i);r.useCache&&r.listId in r.currentContext.listContexts&&(r.currentListContext=r.currentContext[r.listId]);r.currentListContext===t&&(r.currentListContext=this.getListContext(r));r.currentListContext.config=r.currentConfig;r.useCache&&n.spEasyForms.writeCachedContext(r)},getCurrentListId:function(i){var r=n.extend({},n.spEasyForms.defaults,i);return r.listId===t&&(r.listId=n.spEasyForms.utilities.getRequestParameters().ListId,r.listId||(r.listId=_spPageContextInfo.pageListId)),r.listId},getCurrentSiteUrl:function(i){var r=n.extend({},n.spEasyForms.defaults,i),u;return r.siteUrl===t&&(r.siteUrl=n.spEasyForms.utilities.getRequestParameters().SiteUrl,r.siteUrl===t?r.siteUrl=_spPageContextInfo.webServerRelativeUrl:(u=document.createElement("a"),u.href=r.siteUrl,r.siteUrl=u.pathname,r.siteUrl[0]!=="/"&&(r.siteUrl="/"+r.siteUrl))),r.siteUrl},layout2Config:function(t){var i=n.extend({},n.spEasyForms.defaults,t);return n.isArray(i.currentConfig)&&(i.currentConfig={layout:{def:i.currentConfig},visibility:{def:{}}}),i.currentConfig}};var i=n.spEasyForms.sharePointContext})(spefjQuery);
/*
 * SPEasyForms.sharePointFieldRows - object to parse field rows into a map.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n,t){n.spEasyForms.sharePointFieldRows={rows:{},init:function(i){var r=n.extend({},n.spEasyForms.defaults,i),f,u,s,h,e,o;return r.input!==t?f=r.input.find(r.formBodySelector).closest("tr"):(f=n(r.formBodySelector).closest("tr"),this.rows={}),u={},f.each(function(){r.tr=n(this);var i=n.spEasyForms.sharePointFieldRows.processTr(r);i.internalName!==t&&(u[i.internalName]=i)}),r.input===t&&(this.rows=u),s=n.spEasyForms.sharePointContext.get(r),h=n.spEasyForms.sharePointContext.getCurrentListId(r),h in s.listContexts&&!r.skipCalculatedFields&&n.spEasyForms.isSettingsPage(r)&&(e=!1,n.each(Object.keys(u),function(n,t){if(u[t].spFieldType==="SPFieldCalculated")return e=!0,!1}),e||(o=n.spEasyForms.sharePointContext.getListContext(i),n.each(Object.keys(o.schema),function(t,i){var f=o.schema[i],e,s;f.type==="Calculated"&&f.hasFormula&&(e=n("<tr><td class='ms-formlabel'><h3 class='ms-standardheader'><nobr>"+f.displayName+"<\/nobr><\/h3><\/td><td class='ms-formbody'>value<\/td><\/tr>"),e.appendTo("table.ms-formtable"),r.row=e,s={internalName:f.name,displayName:f.displayName,spFieldType:"SPFieldCalculated",value:"",row:e},u[f.name]=s)}))),u},processTr:function(i){var u=n.extend({},n.spEasyForms.defaults,i),f=u.tr,r={},e;if(f.html().indexOf("idAttachmentsRow")>=0)u.dontIncludeNodes||(r.row=f),r.internalName="Attachments",r.displayName="Attachments",r.spFieldType="SPFieldAttachments";else if(f.find("h3").text()==="Content Type"||f.children()[0].innerText==="Content Type")u.dontIncludeNodes||(r.row=f),r.internalName="ContentType",r.displayName="Content Type",r.spFieldType="SPFieldContentType";else{var o=this.capture({row:f,regex:u.fieldInternalNameRegex}),s=this.capture({row:f,regex:u.fieldDisplayNameRegex}),h=this.capture({row:f,regex:u.fieldTypeRegex});r={internalName:o,displayName:s,spFieldType:h};u.dontIncludeNodes||(r.row=f);r.internalName&&r.displayName&&r.spFieldType||u.currentListContext&&(e=u.currentListContext.schema,e&&r.internalName!==t?(r.displayName===t&&(r.displayName=r.internalName,r.internalName in e&&(r.displayName=e[r.internalName].displayName)),r.spFieldType===t&&(r.spFieldType="SPFieldText",r.internalName in e&&(r.spFieldType="SPField"+e[r.internalName].type))):e&&f.find(u.fieldDisplayNameAltSelector).length>0&&(r.displayName=f.find(u.fieldDisplayNameAltSelector).text().replace("*","").trim(),r.displayName in e&&(r.internalName=e[r.displayName].name,r.spFieldType="SPField"+e[r.displayName].type)));u.row=r;r.value=this.value(u)}return r.displayName&&r.internalName&&r.spFieldType&&n.each(Object.keys(r),function(n,t){r[t].row&&(r[t].row.attr("data-displayname",r.displayName),r[t].row.attr("data-internalname",r.internalName),r[t].row.attr("data-spfieldtype",r.spFieldType))}),r},capture:function(n){var i=n.row.html().match(n.regex);return i&&i.length>=2?i[1]:t},value:function(t){var c=n.extend({},n.spEasyForms.defaults,t),i=c.row,k,l,d,e,a,v,f,s,y,p,h,o,u,g,w,nt,tt,r,b;i.value="";try{if(n.spEasyForms.visibilityRuleCollection.getFormType(c)==="display")return i.value=i.row.find("td.ms-formbody").clone().children().remove().end().text().trim(),i.value;switch(i.spFieldType){case"SPFieldContentType":i.value=i.row.find("td.ms-formbody select option:selected").text();break;case"SPFieldChoice":k=i.row.find("td.ms-formbody select");k.length>0?(i.value=i.row.find("td.ms-formbody select").val(),l=i.row.find("input:checked").first(),d=new RegExp(/FillInButton$/i),l.length>0&&d.test(l[0].id)&&(i.value=i.row.find("input[type='text']").val())):(i.value="",i.row.find("input:checked").each(function(){i.value&&(i.value+=";");var t=new RegExp(/FillInRadio$/i);i.value+=n(this).length>0&&!t.test(n(this)[0].id)?n(this).val():i.row.find("input[type='text']").val()}));break;case"SPFieldNote":case"SPFieldMultiLine":i.value="";e=i.row.find("td.ms-formbody input");e.length>0&&!(e.val().search(/^<p>.*<\/p>$/)>=0&&e.val().length===8)&&(i.value=e.val().trim(),i.value.indexOf("<div")===0&&(i.value="<div class='ms-rtestate-field'>"+i.value+"<\/div>"));a=i.row.find("td.ms-formbody textarea");a.length>0&&(i.value=a.val().replace("\n","<br />\n"));v=i.row.find(".ms-imnSpan").parent().parent();v.length>0&&n.each(v,function(n,t){i.value+=t.outerHTML});break;case"SPFieldMultiChoice":i.value="";i.row.find("input:checked").each(function(){i.value.length>0&&(i.value+="; ");var t=new RegExp(/FillInRadio$/i);i.value+=n(this).length>0&&!t.test(n(this)[0].id)?n(this).next().text():i.row.find("input[type='text']").val()});break;case"SPFieldDateTime":if(i.value=i.row.find("td.ms-formbody input").val().trim(),f=i.row.find("select"),f.length===2)if(s=n(f[0]).find("option:selected").text().split(" "),s.length===2){var y=s[0],it=s[1],p=n(f[1]).val();i.value+=" "+y+":"+p+" "+it}else y=n(f[0]).val(),p=n(f[1]).val(),i.value+=" "+y+":"+p;break;case"SPFieldLookup":i.value=i.row.find("option:selected").text();break;case"SPFieldLookupMulti":if(i.value=i.row.find("td.ms-formbody input").val().trim(),i.value.indexOf("|t")>=0)for(h=i.value.split("|t"),i.value="",o=1;o<h.length;o+=2)i.value+=i.value.length===0?h[o]:"; "+h[o];break;case"SPFieldBoolean":i.value=i.row.find("td.ms-formbody input").is(":checked");i.value=i.value?"Yes":"No";break;case"SPFieldURL":u=i.row.find("td.ms-formbody input");i.value=n(u[0]).val().length>0&&n(u[1]).val().length>0?"<a href='"+n(u[0]).val()+"' target='_blank'>"+n(u[1]).val()+"<\/a>":n(u[0]).val().length>0?"<a href='"+n(u[0]).val()+"' target='_blank'>"+n(u[0]).val()+"<\/a>":"";break;case"SPFieldUser":case"SPFieldUserMulti":g=n("[id^='"+i.internalName+"'][id$='ClientPeoplePicker']");g.length>0?(w=i.row.find("input[type='hidden']").val(),typeof w!="undefined"&&(nt=n.spEasyForms.utilities.parseJSON(w),n.each(nt,function(n,t){i.value.length>0&&(i.value+="; ");i.value+=t.isResolved||t.IsResolved?"<a href='"+c.currentContext.webRelativeUrl+"/_layouts/userdisp.aspx?ID="+t.EntityData.SPUserID+"' target='_blank'>"+t.DisplayText+"<\/a>":t.DisplayText}))):(tt=n().SPServices.SPFindPeoplePicker({peoplePickerDisplayName:i.displayName}),i.value=tt.currentValue);break;case"SPFieldBusinessData":i.value=i.row.find("div.ms-inputuserfield span span").text().trim();break;case"SPFieldCalculated":i.value=i.find("td.ms-formbody").text().trim();break;case"SPFieldTaxonomyFieldType":case"SPFieldTaxonomyFieldTypeMulti":r=i.row.find("td.ms-formbody input").val();r.length>0&&(r.indexOf(";")>-1?(b=r.split(";"),b.length>0&&(r="",n.each(b,function(n,t){r+=";"+t.substr(0,t.indexOf("|"))}))):r=r.substr(0,r.indexOf("|")),i.value=r,i.value[0]===";"&&(i.value=i.value.substr(1)));break;default:i.row.find("td.ms-formbody input").length>0?i.value=i.row.find("td.ms-formbody input").val().trim():i.row.find("td.ms-formbody textarea").length>0?i.value=i.row.find("td.ms-formbody textarea").val().replace("\n","<br />\n").trim():i.row.find("td.ms-formbody select").length>0&&(i.value=i.row.find("td.ms-formbody select").val().trim())}}catch(rt){}return i.value||(i.value=""),i.value},setValue:function(t){var f=n.extend({},n.spEasyForms.defaults,t),i=f.row,e,u,l,r,o,s,h,c,a,v;i.value=f.value?f.value:"";try{if(n.spEasyForms.visibilityRuleCollection.getFormType(f)==="display")return;switch(i.spFieldType){case"SPFieldContentType":i.row.find("td.ms-formbody select").val(i.value);break;case"SPFieldChoice":case"SPFieldMultiChoice":e=i.row.find("td.ms-formbody select");e.length>0?e.find("option[value='"+i.value+"']").length>0?e.val(i.value):(u=i.row.find("input[type='text'][id$='FillInChoice']"),u.length===0&&(u=i.row.find("input[type='text'][title^='"+i.displayName+"']")),u.length>0&&(u.val(i.value),u.parent().parent().prev().find("input[type='radio']").prop("checked",!0))):(l=i.value.split(";"),i.row.find("input[type='checkbox']").prop("checked",!1),i.row.find("input[type='text'][id$='FillInText']").val(""),n.each(n(l),function(n,t){var u,r;t.length!==0&&(u=i.row.find("label:contains('"+t+"')"),u.length>0?u.prev().prop("checked",!0):(r=i.row.find("input[type='text'][id$='FillInText']"),r.length===0&&(r=i.row.find("input[type='text'][title^='"+i.displayName+"']")),r.length>0&&(r.val().length>0?(r.val(r.val()+";"+t),r.parent().parent().prev().find("input[type='checkbox']").prop("checked",!0),r.parent().parent().prev().find("input[type='radio']").prop("checked",!0)):(r.val(t),r.parent().parent().prev().find("input[type='checkbox']").prop("checked",!0),r.parent().parent().prev().find("input[type='radio']").prop("checked",!0)))))}));break;case"SPFieldNote":case"SPFieldMultiLine":i.row.find("iframe[Title='Rich Text Editor']").length>0?i.row.find("iframe[Title='Rich Text Editor']").contents().find("body").html(i.value):i.row.find("div[contenteditable='true']").length>0?(i.row.find("div[contenteditable='true']").html(i.value),i.row.find("td.ms-formbody input").val(i.value)):i.row.find("textarea").length>0&&i.row.find("textarea").text(i.value);break;case"SPFieldDateTime":r=new Date(i.value);r.toString()!=="Invalid Date"?(i.row.find("input").val(n.datepicker.formatDate("mm/dd/yy",r)),i.row.find("option[value='"+r.getHours()+"']").length>0?i.row.find("select[id$='Hours']").val(r.getHours()):(o=r.getHours(),s="",s=o<12?o+" AM":o-12+" PM",i.row.find("select[id$='Hours']").val(s)),i.row.find("select[id$='Minutes']").val(r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes())):(i.row.find("input").val(""),i.row.find("option[value='0']").length>0?i.row.find("select[id$='Hours']").val("0"):i.row.find("select[id$='Hours']").val("12 AM"),i.row.find("select[id$='Minutes']").val("00"));break;case"SPFieldBoolean":i.value.length===0||i.value==="0"||i.value.toLowerCase()==="false"||i.value.toLowerCase()==="no"?i.row.find("input").prop("checked",!1):i.row.find("input").prop("checked",!0);break;case"SPFieldURL":i.value.indexOf("|")<0?i.row.find("input").val(i.value):(h=i.value.split("|",2),i.row.find("input[id$='UrlFieldUrl']").val(h[0]),i.row.find("input[id$='UrlFieldDescription']").val(h[1]));break;case"SPFieldUser":case"SPFieldUserMulti":c=i.row.find("[id^='"+i.internalName+"'][id$='ClientPeoplePicker']");c.length>0?ExecuteOrDelayUntilScriptLoaded(function(){var t=SPClientPeoplePicker.SPClientPeoplePickerDict[c[0].id],r,u;t&&(r=n(document.getElementById(t.ResolvedListElementId)).find("span[class='sp-peoplepicker-userSpan']"),n(r).each(function(){t.DeleteProcessedUser(this)}),u=i.value.split(";"),n.each(n(u),function(n,i){t.AddUserKeys(i)}))},"clientpeoplepicker.js"):(i.row.find("div[title='People Picker']").html(""),i.row.find("textarea[title='People Picker']").val(""),a=i.displayName,ExecuteOrDelayUntilScriptLoaded(function(){setTimeout(function(){n().SPServices.SPFindPeoplePicker({peoplePickerDisplayName:a,valueToSet:i.value,checkNames:!0});i.row.find("img[title='Check Names']").trigger("click")},1e3)},"sp.js"));break;case"SPFieldLookup":i.row.find("option[value='"+i.value+"']").length>0?i.row.find("option[value='"+i.value+"']").prop("selected",!0):i.row.find("option:contains('"+i.value+"'):first").prop("selected",!0);break;case"SPFieldLookupMulti":v=i.value.split(";");n.each(n(v),function(n,t){i.row.find("option[value='"+t+"']").length>0?i.row.find("option[value='"+t+"']").remove().appendTo("select[id$='_SelectResult']"):i.row.find("option:contains('"+t+"'):first").remove().appendTo("select[id$='_SelectResult']")});break;default:i.row.find("input").val(i.value)}}catch(y){}},compareField:function(t,i){var r=n.spEasyForms.sharePointContext.getListContext().fields;if(t in r&&i in r){if(r[t].displayName<r[i].displayName)return-1;if(r[t].displayName>r[i].displayName)return 1}return 0}}})(spefjQuery);
/*
 * SPEasyForms.configManager - Object that encapsulates getting, setting, and saving the SPEasyForms
 * configuration file for the current list.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){n.spEasyForms.configManager={undoBuffer:[],redoBuffer:[],get:function(t){var f=n.extend({},n.spEasyForms.defaults,t),i,u,r;return n("#spEasyFormsJson pre").text().length>0?i=n.spEasyForms.utilities.parseJSON(n("#spEasyFormsJson pre").text()):(i=n.spEasyForms.sharePointContext.getConfig(f),u=1,r=function(n){for(var t,i=0;i<n.length;i++)t=n[i],t.index=u++,t.containerType||(t.containerType="FieldCollection"),t.name||(t.name=t.containerType),t.fieldCollections&&r(t.fieldCollections)},typeof i!="undefined"&&(r(i.layout.def),n("#spEasyFormsJson pre").text(JSON.stringify(i,null,4))),n("#spEasyFormsSaveButton").addClass("speasyforms-disabled").css({opacity:.3}),n("#spEasyFormsUndoButton").addClass("speasyforms-disabled").css({opacity:.3}),n("#spEasyFormsRedoButton").addClass("speasyforms-disabled").css({opacity:.3})),typeof i=="undefined"&&(n("#spEasyFormsExportButton").addClass("speasyforms-disabled").css({opacity:.3}),i={layout:{def:[{containerType:n.spEasyForms.defaultFormContainer.containerType}]},visibility:{def:{}},adapters:{def:{}}},n("#spEasyFormsJson pre").text(JSON.stringify(i,null,4)),n("#spEasyFormsSaveButton").addClass("speasyforms-disabled").css({opacity:.3}),n("#spEasyFormsUndoButton").addClass("speasyforms-disabled").css({opacity:.3}),n("#spEasyFormsRedoButton").addClass("speasyforms-disabled").css({opacity:.3})),t.layout=i.layout.def,n.each(t.layout,function(n,t){t.fieldGroups&&(t.fieldCollections=t.fieldGroups,delete t.fieldGroups)}),i},set:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r,u;i.currentConfig||(i.currentConfig={layout:{def:[{containerType:n.spEasyForms.defaultFormContainer.containerType}]},visibility:{def:{}},adapters:{def:{}}});i.currentConfig.version="2018.03";r=JSON.stringify(i.currentConfig,null,4);u=n("#spEasyFormsJson pre").text();r!==u&&(n("#spEasyFormsJson pre").text(r),n("#spEasyFormsSaveButton").removeClass("speasyforms-disabled").css({opacity:1}),n("#spEasyFormsExportButton").addClass("speasyforms-disabled").css({opacity:.3}),n("#spEasyFormsImportButton").addClass("speasyforms-disabled").css({opacity:.3}),this.undoBuffer.push(u),n("#spEasyFormsUndoButton").removeClass("speasyforms-disabled").css({opacity:1}))},save:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r=n.spEasyForms.sharePointContext.getCurrentListId(i);n.ajax({url:n.spEasyForms.utilities.webRelativePathAsAbsolutePath("/SiteAssets")+"/spef-layout-"+r.replace("{","").replace("}","")+".txt",type:"PUT",headers:{"Content-Type":"text/plain",Overwrite:"T"},data:n("#spEasyFormsJson pre").text(),success:function(){i.listId=r;i.currentConfig=n.spEasyForms.utilities.parseJSON(n("#spEasyFormsJson pre").text());n.spEasyForms.sharePointContext.setConfig(i);n("#spEasyFormsSaveButton").addClass("speasyforms-disabled").css({opacity:.3});n("#spEasyFormsExportButton").removeClass("speasyforms-disabled").css({opacity:1});n("#spEasyFormsImportButton").removeClass("speasyforms-disabled").css({opacity:1})},error:function(n,t,i){n.status===409?alert("The web service returned 409 - CONFLICT. This most likely means you do not have a 'Site Assets' library in the current site with a URL of SiteAssets. This is required before you can load and save SPEasyForms configuration files."):alert("Error uploading configuration.\nStatus: "+n.status+"\nStatus Text: "+i)}})}}})(spefjQuery);
/*
 * SPEasyForms.containerCollection - object to hold and manage all containers.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n,t){var r,i;n.spEasyForms.refresh={form:1,visibility:2,adapters:4,containers:8,panel:16,all:31};r=n.spEasyForms.refresh;n.spEasyForms.containerCollection={initialized:!1,nextContainerIndex:1,containerImplementations:{},hiddenObjects:{},rowCache:{},transform:function(t){var r=n.extend({},n.spEasyForms.defaults,t),s=[],u,f,e,o;return this.initRows(r),Object.keys(i.rows).length>0&&(n("#spEasyFormsContainersPre").remove(),n("#spEasyFormsContainersPost").remove(),u=n("<div/>",{id:"spEasyFormsContainersPre"}),f=n("<div/>",{id:"spEasyFormsContainersPost"}),u.insertBefore("table.ms-formtable"),f.insertAfter("table.ms-formtable"),!r.loadDynamicStylesAlways&&(r.currentConfig.layout.def.length||r.currentConfig.visibility.def.length||r.currentConfig.adapters.def.length)&&n.spEasyForms.loadDynamicStyles(r),r.currentConfig=n.spEasyForms.configManager.get(r),r.prepend=!0,n.each(r.currentConfig.layout.def,function(t,h){var c,l;e=n.spEasyForms.utilities.jsCase(h.containerType);e in i.containerImplementations&&(o=i.containerImplementations[e],c=r.prepend?u:f,h.containerType!==n.spEasyForms.defaultFormContainer.containerType?(l=n("<div/>",{"class":"speasyforms-container","data-containerindex":h.index,"data-containertype":h.containerType,"data-containername":h.name}),c.append(l),r.currentContainerParent=l):r.currentContainerParent=c,typeof o.transform=="function"&&(r.currentContainerLayout=h,n.merge(s,o.transform(r))),h.containerType===n.spEasyForms.defaultFormContainer.containerType&&(r.prepend=!1))}),n.spEasyForms.isSettingsPage(r)||(n.spEasyForms.visibilityRuleCollection.transform(r),n.spEasyForms.adapterCollection.transform(r)),r.currentConfig.formWidth&&r.currentConfig.formWidth!=="800"&&(u.width(r.currentConfig.formWidth),f.width(r.currentConfig.formWidth)),this.postTransform(r)),this.highlightValidationErrors(r),s},postTransform:function(t){function u(t){var f,e;t.fieldCollections&&n.each(t.fieldCollections,function(n,t){u(t)});f=n.spEasyForms.utilities.jsCase(t.containerType);f in i.containerImplementations&&(e=i.containerImplementations[f],typeof e.postTransform=="function"&&(r.currentContainerLayout=t,e.postTransform(r)))}var r=n.extend({},n.spEasyForms.defaults,t);n.each(r.currentConfig.layout.def,function(n,t){u(t)})},toEditor:function(t){var i=n.extend({},n.spEasyForms.defaults,t),u,f;i.currentConfig=n.spEasyForms.configManager.get(i);this.initRows(i);this.initialized||(this.wireRibbonButtonEvents(i),this.wireDialogEvents(i));(!this.initialized||i.refresh&r.panel)&&(this.initConditionalFieldChoices(i),n("ol.speasyforms-nestedsortable").empty(),this.initContainers(i),this.nextContainerIndex>2&&(u=n("ol.speasyforms-nestedsortable").find("li"),f=u.children(".speasyforms-menudiv").find(".speasyforms-nestedsortable-status"),u.children("ol").hide(),u.children(".speasyforms-nestedsortable-content").hide(),f.removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e")));(!this.initialized||i.refresh&r.form)&&(this.transform(i),this.postTransform(i),this.wireContainerEvents(i));(!this.initialized||i.refresh&r.visibility)&&n.spEasyForms.visibilityRuleCollection.toEditor(i);(!this.initialized||i.refresh&r.adapters)&&n.spEasyForms.adapterCollection.toEditor(i);n(".speasyforms-panel").show();n(".speasyforms-content").show();this.initialized=!0},toConfig:function(t){var r=n.extend({},n.spEasyForms.defaults,t),f=n("ol.speasyforms-nestedsortable").children(),u=n.spEasyForms.configManager.get(r);return u.layout={def:[]},n.each(f,function(t,f){var o=n(f).attr("data-containertype"),e=n.spEasyForms.utilities.jsCase(o);e in i.containerImplementations&&(r.container=f,u.layout.def.push(i.containerImplementations[e].toLayout(r)))}),u},postValidationAction:function(){var t=n.extend({},n.spEasyForms.defaults);return this.highlightValidationErrors(t),n.spEasyForms.utilities.resizeModalDialog(),!1},highlightValidationErrors:function(t){function o(t){var s=!0;return t.fieldCollections&&n.each(t.fieldCollections,function(n,t){s=o(t)&&s}),u=n.spEasyForms.utilities.jsCase(t.containerType),u in i.containerImplementations&&(e=i.containerImplementations[u],typeof e.postValidationAction=="function"&&(f.currentContainerLayout=t,r=e.postValidationAction(f)&&r)),s}var f=n.extend({},n.spEasyForms.defaults,t),r=!0,s=n.spEasyForms.configManager.get(f),u,e;return n.each(s.layout.def,function(t,f){u=n.spEasyForms.utilities.jsCase(f.containerType);u in i.containerImplementations&&(r=o(f)&&r)}),r},initRows:function(r){var u=n.extend({},n.spEasyForms.defaults,r),o=n("#spEasyFormsContentTypeSelect").val(),f,e;return n.spEasyForms.isSettingsPage(u)?i.rows&&Object.keys(i.rows).length!==0||(i.currentCt&&i.currentCt===o?i.rows=n.spEasyForms.sharePointFieldRows.init(u):(i.currentCt=o,i.currentCt in i.initRows&&(i.rows=i.rowCache[i.currentCt])),i.rows&&Object.keys(i.rows).length!==0||(f=n.spEasyForms.sharePointContext.getCurrentListId(u),f!==t&&f.length>0&&(e="",n.spEasyForms.sharePointContext.formCache!==t?e=n.spEasyForms.sharePointContext.formCache:n.ajax({async:!1,cache:!1,url:n.spEasyForms.utilities.webRelativePathAsAbsolutePath("/_layouts/listform.aspx")+"?PageType=6&ListId="+f+(n("#spEasyFormsContentTypeSelect").val()?"&ContentTypeId="+n("#spEasyFormsContentTypeSelect").val():"")+"&RootFolder=",complete:function(n){e=n.responseText}}),u.input=n(e),i.rows=n.spEasyForms.sharePointFieldRows.init(u),n.each(i.rows,function(t,i){var r=i.row.find("td.ms-formbody");r.html("");n(".ms-formtable").append(i.row)})))):i.rows=n.spEasyForms.sharePointFieldRows.init(u),n.each(i.rows,function(t,i){i.row.find("*[data-transformAdded='true']").remove();i.row.find("*[data-transformHidden='true']").attr("data-transformHidden","false").show();i.row.find(".speasyforms-columnheader").removeClass("speasyforms-columnheader").addClass("ms-h3").addClass("ms-standardheader").addClass("ms-formlabel");i.row.find("h3").addClass("ms-standardheader");i.fieldMissing?i.row.detach():i.row.appendTo(n("table.ms-formtable"))}),i.rowCache[i.currentCt]=i.rows,i.rows},initContainers:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u,f;return r.fieldsInUse=[],n.each(r.currentConfig.layout.def,function(t,e){e.name||(e.name=e.containerType);r.currentContainerLayout=e;r.currentContainerParent=n(".speasyforms-panel ol.speasyforms-nestedsortable");r.impl=i.containerImplementations[n.spEasyForms.utilities.jsCase(r.currentContainerLayout.containerType)];r.currentContainer=i.appendContainer(r);e.index=r.currentContainer.attr("data-containerindex");e.containerType===n.spEasyForms.defaultFormContainer.containerType?(u=r.currentContainer,f=r.currentContainerLayout):i.initContainer(r)}),r.verbose||n("#"+r.id).find("tr.speasyforms-fieldmissing").hide(),r.currentContainer=u,r.currentContainerLayout=f,n.spEasyForms.defaultFormContainer.toEditor(r),r.fieldsInUse},initContainer:function(t){var r=n.extend({},n.spEasyForms.defaults,t),f=n.spEasyForms.utilities.jsCase(r.currentContainerLayout.containerType),u,e;f in i.containerImplementations&&(u=i.containerImplementations[f],typeof u.toEditor=="function"&&(e=u.toEditor(r),n.merge(r.fieldsInUse,e)))},initConditionalFieldChoices:function(){var t={};n.each(Object.keys(i.rows),function(n,r){t[i.rows[r].displayName]=i.rows[r]});n(".speasyforms-conditionalfield").find("option").remove();n(".speasyforms-conditionalfield").append("<option><\/option>");n.each(Object.keys(t).sort(),function(i,r){var u=t[r].internalName;u!==n.spEasyForms.defaultFormContainer.containerType&&n(".speasyforms-conditionalfield").append('<option value="'+u+'">'+r+"<\/option>")});n("#addVisibilityRuleState").find("option").length<2&&n.each(Object.keys(n.spEasyForms.visibilityRuleCollection.stateHandlers),function(t,i){n("#addVisibilityRuleState").append("<option>"+n.spEasyForms.utilities.titleCase(i)+"<\/option>")});n.each(Object.keys(n.spEasyForms.visibilityRuleCollection.comparisonOperators),function(t,i){n(".speasyforms-conditionaltype").append("<option>"+n.spEasyForms.utilities.titleCase(i)+"<\/option>")});n(".speasyforms-conditionalvalue[value='']").not(":first").parent().hide()},wireContainerEvents:function(t){var u=n.extend({},n.spEasyForms.defaults,t),f,e;if(n("tbody.speasyforms-sortablefields").sortable({connectWith:".speasyforms-sortablefields",items:"> tr:not(:first)",helper:"clone",placeholder:"speasyforms-placeholder",zIndex:990,update:function(t){t.handled||(u.currentConfig=i.toConfig(u),n.spEasyForms.configManager.set(u),u.refresh=r.form,i.toEditor(u),t.handled=!0)}}),n("ol.speasyforms-nestedsortable").nestedSortable({forcePlaceholderSize:!0,handle:"div",helper:"clone",items:"li",opacity:.4,placeholder:"speasyforms-placeholder",revert:250,tabSize:20,tolerance:"pointer",toleranceElement:"> div",maxLevels:u.maxNestingLevels,isTree:!0,expandOnHover:700,startCollapsed:!1,branchClass:"speasyforms-nestedsortable-branch",collapsedClass:"speasyforms-nestedsortable-collapsed",disableNestingClass:"speasyforms-nestedsortable-no-nesting",errorClass:"speasyforms-nestedsortable-error",expandedClass:"speasyforms-nestedsortable-expanded",hoveringClass:"speasyforms-nestedsortable-hovering",leafClass:"speasyforms-nestedsortable-leaf",disabledClass:"speasyforms-nestedsortable-disabled",isAllowed:function(n,t,i){return i.hasClass("speasyforms-nestedsortable-nomove")?!1:t&&t.hasClass("speasyforms-nestedsortable-nochildren")||!t&&i.hasClass("speasyforms-nestedsortable-needsparent")||t&&i.hasClass("speasyforms-nestedsortable-noparent")&&!t.hasClass("speasyforms-nestedsortable")?!1:!0},update:function(t){t.handled||(u.currentConfig=i.toConfig(u),n.spEasyForms.configManager.set(u),u.refresh=r.form,i.toEditor(u),t.handled=!0)}}),n(".speasyforms-nestedsortable-delete").attr("title","Click to delete container."),n(".speasyforms-nestedsortable-edit").attr("title","Click to edit container."),n("td.speasyforms-icon-visibility").attr("title","Click to add or modify visibility rules."),n("td.speasyforms-icon-adapter").attr("title","Click to add or remove a field control adapter."),!this.initialized){f=function(){var t=n(this).closest("li"),i=t.children(".speasyforms-menudiv").find(".speasyforms-nestedsortable-status");t.children("ol").toggle();t.children(".speasyforms-nestedsortable-content").toggle();i.hasClass("ui-icon-triangle-1-s")?i.removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"):i.removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s")};e=function(){var t=n(this).closest("li"),i=t.find(".speasyforms-nestedsortable-status");t.children(".speasyforms-menudiv").find(".speasyforms-nestedsortable-status").hasClass("ui-icon-triangle-1-s")?(i.removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"),t.find("ol").hide(),t.find(".speasyforms-nestedsortable-content").hide()):(t.find("ol").show(),t.find(".speasyforms-nestedsortable-content").show(),i.removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s"))};n("ol.speasyforms-nestedsortable").on("click","span.speasyforms-nestedsortable-status",f);n("ol.speasyforms-nestedsortable").on("dblclick","div.speasyforms-menudiv",e);n("ol.speasyforms-nestedsortable").on("click","span.speasyforms-nestedsortable-edit",function(){var e=n(this).closest("li"),o=e.attr("data-containerindex"),t,r,f;u.currentConfig=i.toConfig(u);t=function(i){var r;return n.each(n(i),function(n,i){return i.index===o?(r=i,!1):(r=t(i.fieldCollections),typeof r!="undefined"?!1:void 0)}),r};u.currentContainerLayout=t(u.currentConfig.layout.def);r=n.spEasyForms.utilities.jsCase(u.currentContainerLayout.containerType);r in i.containerImplementations?(f=i.containerImplementations[r],f.settings(u)):n.spEasyForms.baseContainer.settings(u)});n("ol.speasyforms-nestedsortable").on("click","span.speasyforms-nestedsortable-delete",function(){n(this).closest("li").find("tr.speasyforms-sortablefields").each(function(){n("li.speasyforms-nestedsortable-defaultform table.speasyforms-sortablefields").append(this)});n(this).closest("li").remove();u.currentConfig=i.toConfig(u);n.spEasyForms.configManager.set(u);u.refresh=r.form;i.toEditor(u)});n("ol.speasyforms-nestedsortable").on("click","td.speasyforms-icon-visibility",function(){u.currentConfig=n.spEasyForms.configManager.get(u);u.fieldName=n(this).closest("tr").find(".speasyforms-fieldinternal").text();n.spEasyForms.visibilityRuleCollection.launchDialog(u);n(".tabs-min").hide();n("#tabs-min-visibility").show()});n("#tabs-min-visibility").on("dblclick","td.speasyforms-staticrules",function(){u.currentConfig=n.spEasyForms.configManager.get(u);u.fieldName=n(this).closest("tr").children(".speasyforms-hidden").text();n.spEasyForms.visibilityRuleCollection.launchDialog(u)});n("ol.speasyforms-nestedsortable").on("click","td.speasyforms-icon-adapter",function(){u.currentConfig=n.spEasyForms.configManager.get(u);u.fieldName=n(this).closest("tr").find(".speasyforms-fieldinternal").text();u.spFieldType=n(this).closest("tr").find(".speasyforms-fieldtype").text();n.spEasyForms.adapterCollection.launchDialog(u);n(".tabs-min").hide();n("#tabs-min-adapters").show()});n("#tabs-min-adapters").on("dblclick","td.speasyforms-adapter-static",function(){u.currentConfig=n.spEasyForms.configManager.get(u);u.fieldName=n(this).closest("tr").children(".speasyforms-hidden").text();i.rows[u.fieldName]?(u.spFieldType=i.rows[u.fieldName].spFieldType,n.spEasyForms.adapterCollection.launchDialog(u)):alert("The field '"+u.fieldName+"' does not appear to exist?")})}},wireRibbonButtonEvents:function(t){var u=n.extend({},n.spEasyForms.defaults,t),f;n("#spEasyFormsSaveButton").click(function(t){if(!n("#spEasyFormsSaveButton").hasClass("speasyforms-disabled"))return t.handled||(n.spEasyForms.configManager.save(u),t.handled=!0),!1});n("#spEasyFormsCancelButton").click(function(t){return t.handled||(window.location.href=n.spEasyForms.utilities.getRequestParameters(u).Source),!1});n("#spEasyFormsAddButton").click(function(t){return t.handled||(n("#containerType").val(""),n("#chooseContainerError").html(""),n("#chooseContainerDialog").dialog("open"),t.handled=!0),!1});n("#spEasyFormsUndoButton").click(function(t){if(!n("#spEasyFormsUndoButton").hasClass("speasyforms-disabled")&&!t.handled){var e=JSON.stringify(n.spEasyForms.configManager.get(u),null,4),f=n.spEasyForms.configManager.undoBuffer.pop();n.spEasyForms.configManager.redoBuffer.push(e);n("#spEasyFormsRedoButton").removeClass("speasyforms-disabled").css({opacity:1});u.currentConfig=n.spEasyForms.utilities.parseJSON(f);n.spEasyForms.configManager.set(u);f=n.spEasyForms.configManager.undoBuffer.pop();n.spEasyForms.configManager.undoBuffer.length===0&&n("#spEasyFormsUndoButton").addClass("speasyforms-disabled").css({opacity:.3});u.refresh=r.all;i.toEditor(u);t.handled=!0}});n("#spEasyFormsRedoButton").click(function(t){n("#spEasyFormsRedoButton").hasClass("speasyforms-disabled")||t.handled||(u.currentConfig=n.spEasyForms.utilities.parseJSON(n.spEasyForms.configManager.redoBuffer.pop()),n.spEasyForms.configManager.set(u),n.spEasyForms.configManager.redoBuffer.length===0&&n("#spEasyFormsRedoButton").addClass("speasyforms-disabled").css({opacity:.3}),u.refresh=r.all,i.toEditor(u),t.handled=!0)});n("#spEasyFormsExpandButton").click(function(){var t=n("ol.speasyforms-nestedsortable").find("li"),i=t.children(".speasyforms-menudiv").find(".speasyforms-nestedsortable-status");t.children("ol").show();t.children(".speasyforms-nestedsortable-content").show();i.removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s")});n("#spEasyFormsCollapseButton").click(function(){var t=n("ol.speasyforms-nestedsortable").find("li"),i=t.children(".speasyforms-menudiv").find(".speasyforms-nestedsortable-status");t.children("ol").hide();t.children(".speasyforms-nestedsortable-content").hide();i.removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e")});n("#spEasyFormsFormButton").click(function(t){return t.handled||(n(".tabs-min").hide(),n("#tabs-min-form").show(),i.transform(u)),!1});n("#spEasyFormsConditionalVisibilityButton").click(function(t){return t.handled||(n(".tabs-min").hide(),n("#tabs-min-visibility").show()),!1});n("#spEasyFormsFieldAdaptersButton").click(function(t){return t.handled||(n(".tabs-min").hide(),n("#tabs-min-adapters").show()),!1});n("#spEasyFormsSettingsButton").click(function(t){return t.handled||(n(".tabs-min").hide(),n("#tabs-min-settings").show()),!1});n("input:radio[name='jqueryuitheme']").change(function(){var t=n("input:radio[name='jqueryuitheme']:checked").val();t==="gallery"?(n("#selGalleryTheme").show(),n("#inpCustomTheme").hide()):t==="custom"?(n("#inpCustomTheme").show(),n("#selGalleryTheme").hide()):(n("#inpCustomTheme").hide(),n("#selGalleryTheme").hide())});n("#applyThemeButton").button({label:"Apply Theme"}).click(function(t){t.preventDefault();var r=n("input:radio[name='jqueryuitheme']:checked").val(),i;return u.currentConfig=n.spEasyForms.configManager.get(u),r==="gallery"&&n("#selGalleryTheme").val()!=="none"?(i=n("#selGalleryTheme").val(),i=n.spEasyForms.utilities.siteRelativePathAsAbsolutePath("/Style Library/SPEasyFormsAssets/~version/Css/jquery-ui-"+i+"/jquery-ui.css"),u.currentConfig.jQueryUITheme=i):r==="custom"?(i=n("#inpCustomTheme").val(),u.currentConfig.jQueryUITheme=i):delete u.currentConfig.jQueryUITheme,/^[0-9]*$/.test(n("#spFormWidth").val())?(n("#formWidthValidationError").hide(),n("#spFormWidth").val()!=="800"?u.currentConfig.formWidth=n("#spFormWidth").val():delete u.currentConfig.formWidth,n.spEasyForms.configManager.set(u),u.source=i?i:u.jQueryUITheme,n("head").append('<link rel="stylesheet" type="text/css" href="'+n.spEasyForms.replaceVariables(u)+'">')):n("#formWidthValidationError").show(),!1});n.each(n(u.jQueryUIGallery),function(t,i){u.currentConfig.jQueryUITheme&&u.currentConfig.jQueryUITheme.indexOf("/jquery-ui-"+i.toLowerCase()+"/")>0&&(f=i);n("#selGalleryTheme").append("<option value='"+i.toLowerCase()+"'>"+i+"<\/option>")});f?(n("input:radio[value='gallery']").prop("checked","checked"),n("#selGalleryTheme").val(f),n("#inpCustomTheme").hide(),n("#selGalleryTheme").show()):u.currentConfig.jQueryUITheme?(n("#inpCustomTheme").val(u.currentConfig.jQueryUITheme),n("input:radio[value='custom']").prop("checked","checked"),n("#inpCustomTheme").show(),n("#selGalleryTheme").hide()):(n("input:radio[value='none']").prop("checked","checked"),n("#inpCustomTheme").hide(),n("#selGalleryTheme").hide());u.currentConfig.formWidth&&n("#spFormWidth").val(u.currentConfig.formWidth);n("#spEasyFormsClearCacheButton").click(function(){return n.spEasyForms.clearCachedContext(u),window.location.reload(),!1});n("#spEasyFormsVerboseButton").click(function(){return window.location.href=u.verbose?window.location.href.replace("&spEasyFormsVerbose=true","").replace("SPEasyFormsSettingsVerbose.aspx","SPEasyFormsSettings.aspx"):window.location.href.replace("SPEasyFormsSettings.aspx","SPEasyFormsSettingsVerbose.aspx")+"&spEasyFormsVerbose=true",!1});n("#spEasyFormsAboutButton").click(function(t){return t.handled||n("#spEasyFormsAboutDialog").dialog("open"),!1});n("#spEasyFormsHelpLink").click(function(){var t=n.spEasyForms.utilities.siteRelativePathAsAbsolutePath("/Style Library/SPEasyFormsAssets/2018.03/Help/speasyforms_help.aspx");return window.open(t),!1});n("#spEasyFormsExportLink").click(function(){if(n("#spEasyFormsExportButton").hasClass("speasyforms-disabled"))return!1;var t=n.spEasyForms.utilities.webRelativePathAsAbsolutePath("/SiteAssets")+"/spef-layout-"+n.spEasyForms.sharePointContext.getCurrentListId(u).replace("{","").replace("}","")+".txt";window.open(t)});n("#spEasyFormsImportButton").click(function(){n("#spEasyFormsImportButton").hasClass("speasyforms-disabled")||(n("#importedJson").val(""),n("#importConfigurationDialog").dialog("open"))})},wireDialogEvents:function(t){var u=n.extend({},n.spEasyForms.defaults,t),f=n(window.top).height()-50,h={modal:!0,buttons:{OK:function(){n("#spEasyFormsAboutDialog").dialog("close")}},autoOpen:!1,width:800,height:f>900?900:f,open:function(){var t=n(window.top).height()-50;n("#spEasyFormsAboutDialog").dialog({height:t>900?900:t})}},e,o,s;n("#spEasyFormsAboutDialog").dialog(h);e={modal:!0,buttons:{Add:function(){var t,r;n("#containerType").val().length>0?(n("#chooseContainerDialog").dialog("close"),t=n.spEasyForms.utilities.jsCase(n("#containerType").val()),t in i.containerImplementations&&(r=i.containerImplementations[t],u.containerType=n("#containerType").val(),n("#settingsContainerType").val(u.containerType),r.settings(u))):n("#chooseContainerError").html("* You must select a container type.")},Cancel:function(){n("#chooseContainerDialog").dialog("close")}},autoOpen:!1};n("#containerType").find("option").remove();n("#containerType").append(n("<option>",{text:"",value:""}));n.each(i.containerImplementations,function(t){var r=i.containerImplementations[t].containerType;i.containerImplementations[t].cannotBeAdded||n("#containerType").append(n("<option>",{text:r,value:r}))});n("#chooseContainerDialog").dialog(e);o={modal:!0,buttons:{Save:function(){n("#"+n("#editFieldCollectionContainerId").val()).html(n("#fieldCollectionName").val());u.currentConfig=i.toConfig(u);n.spEasyForms.configManager.set(u);u.refresh=r.all;i.toEditor(u);n("#editFieldCollectionDialog").dialog("close")},Cancel:function(){n("#editFieldCollectionDialog").dialog("close")}},autoOpen:!1};n("#editFieldCollectionDialog").dialog(o);s={modal:!0,width:735,buttons:{Ok:function(){u.currentConfig=n.spEasyForms.utilities.parseJSON(n("#importedJson").val());n.spEasyForms.sharePointContext.fixAdapterListReferences(u);n.spEasyForms.configManager.set(u);u.refresh=r.all;i.toEditor(u);n("#importConfigurationDialog").dialog("close")}},autoOpen:!1};n("#importConfigurationDialog").dialog(s)},appendContainer:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r=n("#spEasyFormsTemplates .speasyforms-nestedsortable-container").clone();return i.currentContainerLayout.containerType&&i.currentContainerLayout.containerType!=="FieldCollection"?i.currentContainerLayout.containerType===n.spEasyForms.defaultFormContainer.containerType&&(r=n("#spEasyFormsTemplates .speasyforms-nestedsortable-defaultform").clone()):(i.currentContainerLayout.containerType="FieldCollection",r=n("#spEasyFormsTemplates .speasyforms-nestedsortable-fieldcollection").clone()),i.impl&&i.impl.noChildren?r.addClass("speasyforms-nestedsortable-nochildren"):i.impl&&i.impl.needsParent?r.addClass("speasyforms-nestedsortable-needsparent"):i.impl&&i.impl.noParent&&r.addClass("speasyforms-nestedsortable-noparent"),i.currentContainerParent.append(r),r.attr("id","spEasyFormsContainer"+this.nextContainerIndex),r.attr("data-containerindex",this.nextContainerIndex++),r.attr("data-containertype",i.currentContainerLayout.containerType),r.attr("data-containername",i.currentContainerLayout.name),r.find(".speasyforms-itemtitle").html(i.currentContainerLayout.name),i.currentContainerLayout.name!==i.currentContainerLayout.containerType&&r.find(".speasyforms-itemtype").html("&nbsp;["+i.currentContainerLayout.containerType+"]"),r},createFieldRow:function(t){var f=n.extend({},n.spEasyForms.defaults,t),r=f.row,i=n(n("#spEasyFormsTemplates .speasyforms-fieldrowtemplate").clone()),u;return r.fieldMissing&&(i.removeClass("ui-widget-content").addClass("speasyforms-fieldmissing").addClass("ui-state-error"),i.find("td").removeClass("ui-widget-content").addClass("speasyforms-fieldmissing").addClass("ui-state-error")),i.find(".speasyforms-fieldname").html(r.displayName),i.find(".speasyforms-fieldinternal").html(r.internalName),i.find(".speasyforms-fieldtype").html(r.spFieldType),f.spFieldType=r.spFieldType,n.spEasyForms.adapterCollection.getSupportedTypes(f).length===0&&(u=i.find(".speasyforms-icon-adapter"),u.parent().width(u.width),u.hide()),i},createFieldCollection:function(){return n("#spEasyFormsTemplates .speasyforms-fieldtabletemplate").clone()}};i=n.spEasyForms.containerCollection})(spefjQuery);
/*
 * SPEasyForms.containerCollection.baseContainer - This abstract container implements all 
 * of the editor functionality for any container type comprised of one or more 
 * groups of fields (which I imagine is all containers).  It implements everything 
 * but the transform function.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var t=n.spEasyForms.containerCollection;n.spEasyForms.baseContainer={fieldCollectionsDlgTitle:"Enter the names of the field collections, one per line",fieldCollectionsDlgPrompt:"Field Collection Names (one per line):",toEditor:function(i){var r=n.extend({},n.spEasyForms.defaults,i),u=[],f=n("<ol>");return r.currentContainer.append(f),n.each(r.currentContainerLayout.fieldCollections,function(i,e){var o,s;e.name||(e.name=e.containerType);e.containerType||(e.containerType="FieldCollection");r.currentContainerLayout=e;r.currentContainerParent=f;o=n.spEasyForms.utilities.jsCase(e.containerType);o in t.containerImplementations&&(r.impl=t.containerImplementations[o],r.currentContainer=t.appendContainer(r),e.index=r.currentContainer.attr("data-containerindex"),typeof r.impl.toEditor=="function"&&(r.currentContainerParent=r.currentContainer,s=r.impl.toEditor(r),n.merge(u,s)))}),this.wireDialogEvents(r),r.verbose||n(".speasyforms-panel .speasyforms-fieldmissing").hide(),u},toLayout:function(i){var r=n.extend({},n.spEasyForms.defaults,i),u={name:n(r.container).attr("data-containername"),containerType:n(r.container).attr("data-containertype"),index:n(r.container).attr("data-containerindex"),fieldCollections:[]},f=n(r.container).children("ol").children("li");return n.each(f,function(i,f){var e={name:n(f).attr("data-containername"),containerType:n(f).attr("data-containertype"),index:n(f).attr("data-containerindex"),fields:[]},o=n.spEasyForms.utilities.jsCase(n(f).attr("data-containertype"));o in t.containerImplementations&&(r.container=f,e=t.containerImplementations[o].toLayout(r));u.fieldCollections.push(e)}),u},settings:function(t){var i=n.extend({},n.spEasyForms.defaults,t);this.wireDialogEvents(i);n("#settingsCollectionNames").show().val("");n("#settingsCollectionNames").attr("title",this.fieldCollectionsDlgTitle);n("label[for='settingsCollectionNames']").show().text(this.fieldCollectionsDlgPrompt);i.currentContainerLayout?(n("#containerSettingsDialog").dialog("option","title","Edit Container"),n("#settingsContainerName").val(i.currentContainerLayout.name),n("#settingsContainerId").val(i.currentContainerLayout.index),n("#settingsContainerType").val(i.currentContainerLayout.containerType),i.currentContainerLayout.containerType==="FieldCollection"&&(n("#settingsCollectionNames").hide(),n("label[for='settingsCollectionNames']").hide())):(n("#containerSettingsDialog").dialog("option","title","Add Container"),n("#settingsContainerName").val(""),n("#settingsContainerId").val(""),n("#settingsContainerType").val(i.containerType));n("#containerSettingsDialog").dialog("open")},wireDialogEvents:function(i){var r=n.extend({},n.spEasyForms.defaults,i),u,f={width:500,modal:!0,buttons:{Ok:function(){var i,e,o,f;return n("#settingsContainerId").val().length===0?(i={name:n("#settingsContainerName").val(),containerType:n("#settingsContainerType").val(),index:n.spEasyForms.containerCollection.nextContainerIndex++,fieldCollections:[]},i.name||(i.name=i.containerType),u=n("#settingsCollectionNames").val().split("\n"),n.each(n(u),function(t,r){r.trim().length>0&&i.fieldCollections.push({name:r,containerType:"FieldCollection",index:n.spEasyForms.containerCollection.nextContainerIndex++,fields:[]})}),r.currentConfig=n.spEasyForms.configManager.get(r),r.currentConfig.layout.def.push(i),n.spEasyForms.configManager.set(r),r.currentContainerLayout=i,r.currentContainerParent=n(".speasyforms-panel").children("ol.speasyforms-nestedsortable"),e=n.spEasyForms.utilities.jsCase(i.containerType),e in t.containerImplementations&&(r.impl=t.containerImplementations[e],r.currentContainer=t.appendContainer(r),i.index=r.currentContainer.attr("data-containerindex"),typeof r.impl.toEditor=="function"&&r.impl.toEditor(r))):(o=n("#settingsContainerId").val(),f=n("#spEasyFormsContainer"+o),n("#settingsContainerName").val().length>0&&(r.currentContainerLayout.name=n("#settingsContainerName").val(),r.currentContainerLayout.name.length===0&&(r.currentContainerLayout.name=r.currentContainerLayout.containerType),f.attr("data-containername",r.currentContainerLayout.name),f.find(".speasyforms-itemtitle:first").text(r.currentContainerLayout.name),r.currentContainerLayout.name!==r.currentContainerLayout.containerType&&f.find(".speasyforms-itemtype:first").text(r.currentContainerLayout.containerType)),u=n("#settingsCollectionNames").val().split("\n"),n.each(n(u),function(i,u){var o,e;u.trim().length>0&&(r.currentContainerLayout={name:u.trim(),containerType:"FieldCollection",index:n.spEasyForms.containerCollection.nextContainerIndex++,fields:[]},o=t.createFieldCollection(r),f.find("ol").length===0&&f.append("<ol>"),r.currentContainerParent=f.children("ol"),r.impl=n.spEasyForms.fieldCollection,e=t.appendContainer(r),e.find(".speasyforms-itemtitle").html(r.currentContainerLayout.name),r.currentContainerLayout.name!==r.currentContainerLayout.containerType&&e.find(".speasyforms-itemtype").html("&nbsp;["+r.currentContainerLayout.containerType+"]"),e.find(".speasyforms-nestedsortable-content").append(o))}),r.currentConfig=t.toConfig(r),n.spEasyForms.configManager.set(r)),r.refresh=n.spEasyForms.refresh.form,t.toEditor(r),n("#containerSettingsDialog").dialog("close"),!1},Cancel:function(){return n("#containerSettingsDialog").dialog("close"),!1}},autoOpen:!1};n("#containerSettingsDialog").dialog(f)},appendRow:function(t){var i=n.extend({},n.spEasyForms.defaults,t),f=!1,e,r,u;return i.rowInfo&&!i.rowInfo.fieldMissing&&(e=i.rowInfo.row.find("iframe[id$='TextField_iframe']").length>0,e||(i.table.append(i.rowInfo.row),i.headerOnTop?(r=i.rowInfo.row.find("td.ms-formlabel"),n.spEasyForms.isSettingsPage(i)&&i.rowInfo.row.find("td.ms-formbody").prepend("<div data-transformAdded='true'>&nbsp;<\/div>"),u=r.find("nobr").html(),typeof u=="undefined"&&(u=r.text()),i.rowInfo.row.find("td.ms-formbody").prepend("<div><nobr data-transformAdded='true' class='speasyforms-columnheader'>"+u+"<\/nobr><\/div>"),r.attr("data-transformHidden","true").hide(),i.rowInfo.row.attr("data-headerontop","true")):(i.rowInfo.row.find("h3.ms-standardheader, span.ms-h3").removeClass("ms-standardheader").removeClass("ms-h3").addClass("speasyforms-columnsheader"),i.rowInfo.row.find(".ms-formlabel").removeClass("ms-formlabel").addClass("speasyforms-columnheader")),f=!0)),f},appendFieldCollection:function(i){var r=n.extend({},n.spEasyForms.defaults,i),u,f,e;r.fieldCollection.containerType||(r.fieldCollection.containerType="FieldCollection");r.fieldCollection.name||(r.fieldCollection.name=r.fieldCollection.containerType);u=n.spEasyForms.utilities.jsCase(r.fieldCollection.containerType);u in t.containerImplementations&&(f=t.containerImplementations[u],typeof f.transform=="function"&&(r.currentContainerLayout=r.fieldCollection,e=n("<div/>",{"class":"speasyforms-container","data-containerindex":r.currentContainerLayout.index,"data-containertype":r.currentContainerLayout.containerType,"data-containername":r.currentContainerLayout.name}),r.parentElement.append(e),r.currentContainerParent=e,n.merge(r.result,f.transform(r))))}}})(spefjQuery);
/*
 * SPEasyForms.containerCollection.defaultFormContainer - object representing the OOB SharePoint form.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var t=n.spEasyForms.containerCollection,i;n.spEasyForms.defaultFormContainer={containerType:"DefaultForm",cannotBeAdded:!0,noChildren:!0,noParent:!0,transform:function(){return[]},toEditor:function(i){var r=n.extend({},n.spEasyForms.defaults,i),f=t.createFieldCollection(r),u;n.each(t.rows,function(i,u){n.inArray(i,r.fieldsInUse)<0&&(f.append(t.createFieldRow({row:u})),n(".ms-formtable").append(u.row))});u=n("<div>",{"class":"speasyforms-nestedsortable-content"});u.append(f);r.currentContainer.append(u)},toLayout:function(t){var i=n.extend({},n.spEasyForms.defaults,t);return{containerType:this.containerType,index:n(i.container).attr("data-containerindex")}}};i=n.spEasyForms.defaultFormContainer;t.containerImplementations.defaultForm=i})(spefjQuery);
/*
 * SPEasyForms.containerCollection.fieldCollection - This is the leaf collection most of the time, a collection that contains
 * a single table of SharePoint fields.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n,t){var i=n.spEasyForms.containerCollection,r;n.spEasyForms.fieldCollection={containerType:"FieldCollection",cannotBeAdded:!0,noChildren:!0,needsParent:!0,transform:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u=[];return r.table=n("<table role='presentation' id='"+r.collectionType+"Table"+r.collectionIndex+"' class='speasyforms-fieldcollection "+r.tableClass+"'><\/table>"),r.currentContainerParent.append(r.table),n.each(r.fieldCollection.fields,function(t,f){r.rowInfo=i.rows[f.fieldInternalName];n.spEasyForms.baseContainer.appendRow(r)&&u.push(f.fieldInternalName)}),u},postTransform:function(t){var r=n.extend({},n.spEasyForms.defaults,t),i=n("div.speasyforms-container[data-containerindex='"+r.currentContainerLayout.index+"']");i.find("tr:not([data-visibilityhidden='true']) td.ms-formbody").length===0?i.attr("data-speasyformsempty","1").hide():i.attr("data-speasyformsempty","0").show()},postValidationAction:function(t){var r=n.extend({},n.spEasyForms.defaults,t),i=n("div.speasyforms-container[data-containerindex='"+r.currentContainerLayout.index+"']");return i.find("span[role='alert']").length>0?i.attr("data-speasyforms-validationerror","1"):i.attr("data-speasyforms-validationerror","0"),!0},toEditor:function(r){var u=n.extend({},n.spEasyForms.defaults,r),f=[],e=i.createFieldCollection(u);return n.each(u.currentContainerLayout.fields,function(r,o){u.row=i.rows[o.fieldInternalName];u.row===t&&(u.row={displayName:o.fieldInternalName,internalName:o.fieldInternalName,spFieldType:o.fieldInternalName,value:"",row:n("<tr><td class='ms-formlabel'><h3 class='ms-standardheader'><\/h3><\/td><td class='ms-formbody'><\/td><\/tr>"),fieldMissing:!0});e.append(i.createFieldRow(u));f.push(o.fieldInternalName)}),u.currentContainer.find(".speasyforms-itemtitle").html(u.currentContainerLayout.name),u.currentContainerLayout.name!==u.currentContainerLayout.containerType&&u.currentContainer.find(".speasyforms-itemtype").html("&nbsp;["+u.currentContainerLayout.containerType+"]"),u.currentContainer.find(".speasyforms-nestedsortable-content").append(e),f},toLayout:function(t){var i=n.extend({},n.spEasyForms.defaults,t),u=n(i.container).find("tr:not(:first)"),r={name:n(i.container).attr("data-containername"),containerType:n(i.container).attr("data-containertype"),index:n(i.container).attr("data-containerindex"),fields:[]};return n.each(u,function(t,i){var u=n(i).find("td");r.fields.push({fieldInternalName:n(u[1]).text()})}),r}};r=n.extend({},n.spEasyForms.baseContainer,n.spEasyForms.fieldCollection);i.containerImplementations.fieldCollection=r})(spefjQuery);-function(n){var t=n.spEasyForms.containerCollection,i=n.spEasyForms.baseContainer,r={containerType:"Accordion",fieldCollectionsDlgTitle:"Enter the names of the accordion pages, one per line",fieldCollectionsDlgPrompt:"Page Names (one per line):",transform:function(t){var i=n.extend({},n.spEasyForms.defaults,t);i.result=[];var u="spEasyFormsAccordionDiv"+i.currentContainerLayout.index,r=n("<div/>",{id:u,"class":"speasyforms-accordion"});i.currentContainerParent.append(r);n.each(i.currentContainerLayout.fieldCollections,function(t,u){i.collectionIndex=i.currentContainerLayout.index+"_"+t;i.parentElement=n("<div/>",{id:i.parentElement});i.collectionType="accordion";i.fieldCollection=u;i.tableClass="speasyforms-accordion";var f=n("<h3>",{id:"spEasyFormsAccordionHeader"+i.collectionIndex,"class":i.tableClass}).text(u.name);r.append(f);r.append(i.parentElement);n.spEasyForms.baseContainer.appendFieldCollection(i)});r.accordion({heightStyle:"content",active:!1,collapsible:!0,activate:function(n){n.preventDefault()}});r.on("mouseup","h3.speasyforms-accordion",function(t){t.which===1&&(r.find("h3.speasyforms-accordion").removeClass("ui-accordion-header-active").removeClass("ui-state-active").removeClass("ui-corner-top").addClass("ui-corner-all"),r.find(".ui-accordion-content").hide(),n(this).addClass("ui-accordion-header-active").addClass("ui-state-active").addClass("ui-corner-top").removeClass("ui-corner-all"),n(this).next().show(),n.spEasyForms.containerCollection.postTransform(i),n.spEasyForms.utilities.resizeModalDialog())});return i.result},postTransform:function(t){for(var s,h,c=n.extend({},n.spEasyForms.defaults,t),l=c.currentContainerLayout.index,u=n("div.speasyforms-container[data-containerindex='"+l+"']"),r=u.children("div.speasyforms-accordion"),f=r.children("h3.ui-accordion-header"),e=r.children("div.ui-accordion-content "),o=!0,i=0;i<e.length;i++)s=n(e[i]).children(".speasyforms-container"),s.attr("data-speasyformsempty")==="1"?(h=r.accordion("option","active"),h===i&&r.accordion({active:i+1}),n(f[i]).hide()):(n(f[i]).show(),o=!1);o?u.attr("data-speasyformsempty","1").hide():u.attr("data-speasyformsempty","0").show()},postValidationAction:function(t){var s=n.extend({},n.spEasyForms.defaults,t),h=s.currentContainerLayout.index,r=n("div.speasyforms-container[data-containerindex='"+h+"']"),u=r.children("div.speasyforms-accordion"),f=u.children("h3.ui-accordion-header"),e=u.children("div.ui-accordion-content "),i,o;for(r.attr("data-speasyforms-validationerror","0"),i=0;i<e.length;i++)o=n(e[i]).children(".speasyforms-container"),o.attr("data-speasyforms-validationerror")==="1"?(r.attr("data-speasyforms-validationerror")==="0"&&(r.attr("data-speasyforms-validationerror","1"),u.accordion({active:i})),n(f[i]).addClass("speasyforms-accordionvalidationerror")):n(f[i]).removeClass("speasyforms-accordionvalidationerror");return!0}};t.containerImplementations.accordion=n.extend({},i,r)}(spefjQuery);
/*
 * SPEasyForms.containerCollection.columns - Object representing a multi-column container.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var t=n.spEasyForms.containerCollection,i=n.spEasyForms.baseContainer,r={containerType:"Columns",fieldCollectionsDlgTitle:"Enter the names of the columns, one per line; these are only displayed on the settings page, not on the form itself.",fieldCollectionsDlgPrompt:"Column Names (one per line):",transform:function(t){var i=n.extend({},n.spEasyForms.defaults,t);i.result=[];var r="spEasyFormsColumnsOuterTable"+i.currentContainerLayout.index,u=n("<table role='presentation' id='"+r+"' class='speasyforms-columns' width='100%' ><\/table>"),f=n("<tr/>",{id:r+"Row"});return u.append(f),i.currentContainerParent.append(u),n.each(i.currentContainerLayout.fieldCollections,function(t,r){i.collectionIndex=i.currentContainerLayout.index+"_"+t;i.parentElement=n("<td/>",{id:"spEasyFormsColumnsCell"+i.collectionIndex});i.collectionType="columns";i.fieldCollection=r;i.tableClass="speasyforms-columncell";i.currentContainerLayout.fieldCollections.length>1&&(i.headerOnTop=!0);f.append(i.parentElement);n.spEasyForms.baseContainer.appendFieldCollection(i)}),i.result},postTransform:function(t){for(var o,i=n.extend({},n.spEasyForms.defaults,t),f=i.currentContainerLayout.index,r=n("div.speasyforms-container[data-containerindex='"+f+"']"),e=!0,u=0;u<i.currentContainerLayout.fieldCollections.length;u++)if(o="#spEasyFormsColumnsCell"+f+"_"+u,n(o).children("div.speasyforms-container").attr("data-speasyformsempty")!=="1"){e=!1;break}e?r.attr("data-speasyformsempty","1").hide():(r.attr("data-speasyformsempty","0").show(),i.tables=r.find("> table > tbody > tr > td > div > table.speasyforms-fieldcollection"),this.evenUpTableRows(i))},postValidationAction:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u=r.currentContainerLayout.index,f=n("div.speasyforms-container[data-containerindex='"+u+"']"),i,e;for(f.attr("data-speasyforms-validationerror","0"),i=0;i<r.currentContainerLayout.fieldCollections.length;i++)if(e="#spEasyFormsColumnsCell"+u+"_"+i,n(e).children("div.speasyforms-container").attr("data-speasyforms-validationerror")==="1"){f.attr("data-speasyforms-validationerror","1");break}return!0},evenUpTableRows:function(t){var e=n.extend({},n.spEasyForms.defaults,t),u=[],f=0,i,r;for(n.each(n(e.tables),function(t,i){var r=n(i).find("tr:not([data-visibilityhidden='true']) td.ms-formbody").closest("tr");u.push(r);r.length>f&&(f=r.length);n.each(n(r),function(t,i){n(i).css("height","auto")})}),i=0;i<f;i++)r=0,n.each(n(u),function(t,u){u.length>i&&n(u[i]).height()>r&&(r=n(u[i]).height())}),r>0&&n.each(n(u),function(t,u){u.length>i&&n(u[i]).height()!==r&&n(u[i]).height(r)})}};t.containerImplementations.columns=n.extend({},i,r)})(spefjQuery);
/*
 * SPEasyForms htmlSnippet
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var i=n.spEasyForms.containerCollection,t;n.spEasyForms.containerCollection.containerImplementations.htmlSnippet={containerType:"HtmlSnippet",noChildren:!0,transform:function(t){var i=n.extend({},n.spEasyForms.defaults,t);return i.currentContainerLayout.contents&&i.currentContainerParent.append(n("<span/>",{"class":"speasyforms-htmlsnippet"}).html(i.currentContainerLayout.contents)),[]},postTransform:function(){},postValidationAction:function(){return!0},toEditor:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r=n("<div/>",{"class":"speasyforms-nestedsortable-content ui-sortable-handle"}),f=n("<span/>",{"class":"speasyforms-htmlsnippet"}),u;return f.html(i.currentContainerLayout.contents.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")),r.append(f),u=n("<textarea/>",{"class":"speasyforms-htmlsnippet",style:"display:none"}),u.val(i.currentContainerLayout.contents),r.append(u),i.currentContainer.append(r),[]},toLayout:function(t){var i=n.extend({},n.spEasyForms.defaults,t);return{name:n(i.container).attr("data-containername"),containerType:n(i.container).attr("data-containertype"),index:n(i.container).attr("data-containerindex"),contents:n(i.container).find("textarea.speasyforms-htmlsnippet").val()}},settings:function(r){var u=n.extend({},n.spEasyForms.defaults,r),f,o,e;u.currentContainerLayout?n("#snippetContents").val(u.currentContainerLayout.contents):n("#snippetContents").val("");n("#spEasyFormsContainerDialogs").find("#configureSnippetDialog").length===0&&n("#spEasyFormsContainerDialogs").append("<div id='configureSnippetDialog' class='speasyforms-dialogdiv' title='HTML Snippet Container'><div style='margin-bottom:10px'>Name: <input name='snippetName' id='snippetName' type='text'><\/input><\/div><textarea  id='snippetContents' rows='15' cols='80'>"+(u.currentContainerLayout?u.currentContainerLayout.contents:"")+"<\/textarea><span style='display:none' id='snippetContainerId'><\/span><\/div>");o={width:830,modal:!0,open:function(){t.initRTE()},buttons:{Ok:function(){var c=n("#snippetContainerId").text(),r,s,e,o,h;return c.length>0?(r=n("li.speasyforms-nestedsortable-container[data-containerindex='"+c+"']"),f=r.find("span.speasyforms-htmlsnippet"),s=n("#snippetContents").val(),f.html(s.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")),r.find("textarea.speasyforms-htmlsnippet").val(s),e=n("#snippetName").val(),e.length>0&&(r.attr("data-containername",e),r.find(".speasyforms-itemtitle").text(e),e!==r.attr("data-containertype")&&r.find(".speasyforms-itemtype").text("[HtmlSnippet]"))):(u.currentContainerParent=n(".speasyforms-panel ol.speasyforms-nestedsortable"),u.currentContainerLayout={name:n("#snippetName").val().length>0?n("#snippetName").val():"HtmlSnippet",containerType:"HtmlSnippet",contents:n("#snippetContents").val()},u.impl=t,u.currentContainer=i.appendContainer(u),u.currentContainerLayout=u.currentContainer.attr("data-containerindex"),o=n("<div/>",{"class":"speasyforms-nestedsortable-content ui-sortable-handle"}),f=n("<span/>",{"class":"speasyforms-htmlsnippet"}),f.html(n("#snippetContents").val().replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")),o.append(f),h=n("<textarea/>",{"class":"speasyforms-htmlsnippet",style:"display:none"}),h.val(n("#snippetContents").val()),o.append(h),u.currentContainer.append(o)),u.currentConfig=n.spEasyForms.containerCollection.toConfig(u),n.spEasyForms.configManager.set(u),u.refresh=n.spEasyForms.refresh.form,i.toEditor(u),n("#configureSnippetDialog").dialog("close"),!1},Cancel:function(){return n("#configureSnippetDialog").dialog("close"),!1}},autoOpen:!1,resizable:!1};n("#configureSnippetDialog").dialog(o);u.currentContainerLayout?(n("#snippetContainerId").text(u.currentContainerLayout.index),n("#snippetName").val(u.currentContainerLayout.name)):(n("#snippetContainerId").text(""),n("#snippetName").val(""));n("#configureSnippetDialog").dialog("open");n("#snippetContents").hide();n("div[buttonname='source']").css({"background-color":"transparent"});e=n("#configureSnippetDialog").find("iframe")[0];u.currentConfig.jQueryUITheme?(u.source=u.currentConfig.jQueryUITheme,n("head",e.contentWindow.document).append('<link rel="stylesheet" type="text/css" href="'+n.spEasyForms.replaceVariables(u)+'">')):(u.source=u.jQueryUITheme,n("head",e.contentWindow.document).append('<link rel="stylesheet" type="text/css" href="'+n.spEasyForms.replaceVariables(u)+'">'))},initRTE:function(){n("#snippetContents").cleditor({width:800,height:200,controls:"font size style | bold italic underline strikethrough subscript superscript | alignleft center alignright | numbering bullets outdent indent | color highlight backgroundcolor | rule | cut copy paste pastetext | ltr rtl print source",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Narrow,Garamond,Georgia,Impact,Sans Serif,Serif,Tahoma,Times New Roman,Trebuchet MS,Verdana",useCSS:!0,bodyStyle:"font-face: Times New Roman; margin: 1px; cursor:text"});n("#configureSnippetDialog").css("overflow","hidden");var t=n("#configureSnippetDialog").find("textarea").cleditor();t.length>0&&t[0].refresh(t);n(".cleditorToolbar").height(25)}};t=n.spEasyForms.containerCollection.containerImplementations.htmlSnippet})(typeof spefjQuery=="undefined"?null:spefjQuery);
/*
 * SPEasyForms.containerCollection.stack - Object representing a container where multiple containers
 * can be stacked one on top of another.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var t=n.spEasyForms.containerCollection,i=n.spEasyForms.baseContainer,r={containerType:"Stack",fieldCollectionsDlgTitle:"Enter the names of the containers, one per line; these are only displayed on the settings page, not on the form itself.",fieldCollectionsDlgPrompt:"Container Names (one per line):",transform:function(t){var i=n.extend({},n.spEasyForms.defaults,t);return i.result=[],n.each(i.currentContainerLayout.fieldCollections,function(t,r){i.collectionIndex=i.currentContainerLayout.index+"_"+t;i.parentElement=i.currentContainerParent;i.collectionType="stack";i.fieldCollection=r;i.tableClass="speasyforms-stack";n.spEasyForms.baseContainer.appendFieldCollection(i)}),i.result},postTransform:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u=r.currentContainerLayout.index,i=n("div.speasyforms-container[data-containerindex='"+u+"']");i.attr("data-speasyformsempty","1").hide();i.children("div.speasyforms-container").length>0&&i.children("div.speasyforms-container").each(function(t,r){if(n(r).attr("data-speasyformsempty")==="0")return i.attr("data-speasyformsempty","0").show(),!1})},postValidationAction:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u=r.currentContainerLayout.index,i=n("div.speasyforms-container[data-containerindex='"+u+"']");return i.attr("data-speasyforms-validationerror","0"),i.children("div.speasyforms-container").each(function(t,r){if(n(r).attr("data-speasyforms-validationerror")==="1")return i.attr("data-speasyforms-validationerror","1"),!1}),!0}};t.containerImplementations.stack=n.extend({},i,r)})(spefjQuery);
/*
 * $.spEasyForms.containerCollection.tabs - Object representing a tabs container.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var t=n.spEasyForms.containerCollection,i=n.spEasyForms.baseContainer,r={containerType:"Tabs",fieldCollectionsDlgTitle:"Enter the names of the tabs, one per line",fieldCollectionsDlgPrompt:"Tab Names (one per line):",transform:function(t){var i=n.extend({},n.spEasyForms.defaults,t);i.result=[];var e="spEasyFormsTabDiv"+i.currentContainerLayout.index,u="speasyforms-tabs",o="spEasyFormsTabList"+i.currentContainerLayout.index,r=n("<div/>",{id:e,"class":u}),f=n("<ul/>",{id:o,"class":"speasyforms-tablist"});r.append(f);i.currentContainerParent.append(r);n.each(i.currentContainerLayout.fieldCollections,function(t,e){i.collectionIndex=i.currentContainerLayout.index+"_"+t;i.parentElement=n("<div/>",{id:"spEasyFormsTabsDiv"+i.collectionIndex,"class":u});i.collectionType="tab";i.fieldCollection=e;i.tableClass=u;var o=n("<li/>",{id:"spEasyFormsTabsLabel"+i.collectionIndex,"class":u});o.append(n("<a/>",{href:"#spEasyFormsTabsDiv"+i.collectionIndex}).text(e.name));f.append(o);r.append(i.parentElement);n.spEasyForms.baseContainer.appendFieldCollection(i)});r.tabs({beforeLoad:function(n,t){t.jqXHR.abort()},create:function(){n(this).children("div").hide();n(this).children(".speasyforms-tabs:first").show()},activate:function(t,r){var u=r.newTab.context.hash;n(u).parent().children("div").hide();n(u).show();n.spEasyForms.containerCollection.postTransform(i)}});r.on("mouseup","a.ui-tabs-anchor",function(t){t.which===1&&(r.tabs({active:n(this).parent().index()}),n.spEasyForms.utilities.resizeModalDialog())});return i.result},postTransform:function(t){for(var s,h=n.extend({},n.spEasyForms.defaults,t),u=n("div.speasyforms-container[data-containerindex='"+h.currentContainerLayout.index+"']"),r=u.children("div.speasyforms-tabs"),f=r.children("div.speasyforms-tabs").children("div.speasyforms-container"),e=r.children("ul").children("li"),o=!0,i=0;i<f.length;i++)n(f[i]).attr("data-speasyformsempty")==="1"?(s=r.tabs("option","active"),s===i&&r.tabs({active:i+1}),n(e[i]).hide()):(n(e[i]).show(),o=!1);o?u.attr("data-speasyformsempty","1").hide():u.attr("data-speasyformsempty","0").show()},postValidationAction:function(t){var o=n.extend({},n.spEasyForms.defaults,t),r=n("div.speasyforms-container[data-containerindex='"+o.currentContainerLayout.index+"']"),u=r.children("div.speasyforms-tabs"),f=u.children("div.speasyforms-tabs").children("div.speasyforms-container"),e=u.children("ul").children("li"),i;for(r.attr("data-speasyforms-validationerror","0"),i=0;i<f.length;i++)n(f[i]).attr("data-speasyforms-validationerror")==="1"?(r.attr("data-speasyforms-validationerror")==="0"&&(r.attr("data-speasyforms-validationerror","1"),u.tabs({active:i})),n(e[i]).find("a").addClass("speasyforms-tabvalidationerror")):n(e[i]).find("a").removeClass("speasyforms-tabvalidationerror");return!0}};t.containerImplementations.tabs=n.extend({},i,r)})(spefjQuery);
/*
 * SPEasyForms WizardContainer - container that allows users to page through sub-containers one at a time.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var i=n.spEasyForms.containerCollection,r=n.spEasyForms.baseContainer,t={containerType:"Wizard",transform:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r;return(i.result=[],n.spEasyForms.visibilityRuleCollection.getFormType(i)==="display")?i.result:(i.divId="spEasyFormsWizardDiv"+i.currentContainerLayout.index,r=n("<div/>",{id:i.divId,"class":"speasyforms-wizard-outer ui-widget-content ui-corner-all",role:"tablist"}),i.currentContainerParent.append(r),n.each(i.currentContainerLayout.fieldCollections,function(t,u){var e,f;i.collectionIndex=i.currentContainerLayout.index+"_"+t;i.tableClass="speasyforms-wizard";e=n("<h3/>",{id:"page"+i.collectionIndex,"class":i.tableClass+" ui-accordion-header ui-helper-reset ui-state-default ui-corner-all ui-accordion-icons","aria-controls":"pageContent"+i.collectionIndex,role:"tab"}).text(u.name);r.append(e);f=n("<div/>",{id:"pageContent"+i.collectionIndex,"class":i.tableClass,"aria-labelledby":"page"+i.collectionIndex,role:"tabPanel"});r.append(f);i.parentElement=f;i.collectionType="wizard";i.fieldCollection=u;n.spEasyForms.baseContainer.appendFieldCollection(i)}),i.outerDiv=r,this.wireButtons(i),i.result)},postTransform:function(i){var f=n.extend({},n.spEasyForms.defaults,i),s="#spEasyFormsWizardDiv"+f.currentContainerLayout.index+" h3.speasyforms-wizard-selected",u;if(n(s).length===0){var e=400,o=35,r=n("#spEasyFormsWizardDiv"+f.currentContainerLayout.index);r.children("div.speasyforms-wizard").each(function(){n(this).width()+100>e&&(e=n(this).width()+100);n(this).height()>o&&(o=n(this).height())});t.deselectall(r);u=!1;r.children("div.speasyforms-wizard").each(function(){n(this).width(e).height(o);u||n(this).children("div").attr("data-speasyformsempty")==="0"&&(t.select(n(this).prev(),r),u=!0)});u||r.parent().attr("data-speasyformsempty","1").hide()}this.setNextPrevVisibility(f)},postValidationAction:function(i){var e=n.extend({},n.spEasyForms.defaults,i),f=n("#spEasyFormsWizardDiv"+e.currentContainerLayout.index),r,o,u;return f.children("h3.speasyforms-wizard").removeClass("speasyforms-accordionvalidationerror"),r=f.children("div.speasyforms-wizard").children("div[data-speasyforms-validationerror='1']"),r.length>0&&(o=n(r[0]).closest("div.speasyforms-wizard"),u=o.prev(),this.select(u,f),r.each(function(){u=n(this).closest("div.speasyforms-wizard").prev();u.addClass("speasyforms-accordionvalidationerror")})),t.setNextPrevVisibility(e),!0},select:function(n,t){this.deselectall(t);var i=n.next();n.addClass("speasyforms-wizard-selected").attr("aria-selected","true").attr("aria-hidden","false").show();i.attr("aria-hidden","false").attr("aria-expanded","true").addClass("speasyforms-wizard-selected").show()},deselectall:function(t){t.find("h3.speasyforms-wizard").each(function(t,i){var r=n(i),u;r.removeClass("speasyforms-wizard-selected").attr("aria-selected","false").attr("aria-hidden","true").hide();u=r.next();u.removeClass("speashforms-wizard-selected").attr("aria-expanded","false").attr("aria-hidden","true").hide()})},wireButtons:function(i){var r=n.extend({},n.spEasyForms.defaults,i);r.outerDiv.append("<div  id='"+r.divId+"Buttons' align='right' style='margin-bottom: 10px; margin-right: 10px; font-size: .9em; font-weight: normal;'><button id='"+r.divId+"Previous' title='Previous' class='speasyforms-wizard-prev'>Previous<\/button><button id='"+r.divId+"Next' title='Next' class='speasyforms-wizard-next'>Next<\/button><\/div>");n("#"+r.divId+"Buttons").append("<img class='placeholder' align='right' style='display:none;margin:11px;' src='/_layouts/images/blank.gif?rev=38' height='1' width='"+n("#"+r.divId+"Next").outerWidth()+"' alt='' data-accessibility-nocheck='true'/>");n("#"+r.divId+"Previous").button().click(function(){return r.selectedHeader=n("#spEasyFormsWizardDiv"+r.currentContainerLayout.index+" h3.speasyforms-wizard-selected"),t.selectPrevious(r),!1});n("#"+r.divId+"Next").button().click(function(){return r.selectedHeader=n("#spEasyFormsWizardDiv"+r.currentContainerLayout.index+" h3.speasyforms-wizard-selected"),t.selectNext(r),!1})},selectPrevious:function(i){var u=n.extend({},n.spEasyForms.defaults,i),r=this.getPrevious(u),f;r&&(f=r.closest("div.speasyforms-wizard-outer "),this.select(r,f));t.setNextPrevVisibility(u)},selectNext:function(i){var u=n.extend({},n.spEasyForms.defaults,i),r=this.getNext(u),f;r&&(f=r.closest("div.speasyforms-wizard-outer "),this.select(r,f));t.setNextPrevVisibility(u)},getPrevious:function(t){var r=n.extend({},n.spEasyForms.defaults,t),i=null;if(r.selectedHeader.prev()&&r.selectedHeader.prev().prev())for(i=r.selectedHeader.prev().prev();i&&i.length;)if(i.next().children("div").attr("data-speasyformsempty")==="0")break;else i=i.prev()&&i.prev().prev()?i.prev().prev():null;return i},getNext:function(t){var r=n.extend({},n.spEasyForms.defaults,t),i=null;if(r.selectedHeader.next()&&r.selectedHeader.next().next())for(i=r.selectedHeader.next().next();i&&i.length;)if(i.next().children("div").attr("data-speasyformsempty")==="0")break;else i=i.next()&&i.next().next()?i.next().next():null;return i},setNextPrevVisibility:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r;i.selectedHeader=n("#spEasyFormsWizardDiv"+i.currentContainerLayout.index+" h3.speasyforms-wizard-selected");r=this.getPrevious(i);r&&r.length!==0?i.selectedHeader.closest("div.speasyforms-wizard-outer").find(".speasyforms-wizard-prev").show():i.selectedHeader.closest("div.speasyforms-wizard-outer").find(".speasyforms-wizard-prev").hide();r=this.getNext(i);r&&r.length!==0?(i.selectedHeader.closest("div.speasyforms-wizard-outer").find(".speasyforms-wizard-next").show(),i.selectedHeader.closest("div.speasyforms-wizard-outer").find(".placeholder").hide()):(i.selectedHeader.closest("div.speasyforms-wizard-outer").find(".speasyforms-wizard-next").hide(),i.selectedHeader.closest("div.speasyforms-wizard-outer").find(".placeholder").show())}};i.containerImplementations.wizard=n.extend({},r,t)})(typeof spefjQuery=="undefined"?null:spefjQuery);
/*
 * SPEasyForms.visibilityRuleCollection - object to hold and manage all field visibility rules.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n,t){var r=n.spEasyForms.utilities,i;n.spEasyForms.visibilityRuleCollection={initialized:!1,setTimeoutCalled:!1,siteGroups:[],comparisonOperators:{equals:function(n,t){return r.isDate(n)&&r.isDate(t)?new Date(n)===new Date(t):/^[0-9]*.?[0-9]*$/.test(n)&&/^[0-9]*.?[0-9]*$/.test(t)?Number(n)===Number(t):n.toLowerCase()===t.toLowerCase()},matches:function(n,t){var i=new RegExp(t,"i");return i.test(n)},notMatches:function(n,t){var i=new RegExp(t,"i");return!i.test(n)},greaterThan:function(n,t){return r.isDate(n)&&r.isDate(t)?new Date(n)>new Date(t):/^[0-9]*.?[0-9]*$/.test(n)&&/^[0-9]*.?[0-9]*$/.test(t)?Number(n)>Number(t):n>t},greaterThanOrEqual:function(n,t){return r.isDate(n)&&r.isDate(t)?new Date(n)>=new Date(t):/^[0-9]*.?[0-9]*$/.test(n)&&/^[0-9]*.?[0-9]*$/.test(t)?Number(n)>=Number(t):n>=t},lessThan:function(n,t){return r.isDate(n)&&r.isDate(t)?new Date(n)<new Date(t):/^[0-9]*.?[0-9]*$/.test(n)&&/^[0-9]*.?[0-9]*$/.test(t)?Number(n)<Number(t):n<t},lessThanOrEqual:function(n,t){return r.isDate(n)&&r.isDate(t)?new Date(n)<=new Date(t):/^[0-9]*.?[0-9]*$/.test(n)&&/^[0-9]*.?[0-9]*$/.test(t)?Number(n)<=Number(t):n<=t},notEqual:function(n,t){return r.isDate(n)&&r.isDate(t)?new Date(n)>new Date(t):/^[0-9]*.?[0-9]*$/.test(n)&&/^[0-9]*.?[0-9]*$/.test(t)?Number(n)!==Number(t):n!==t}},stateHandlers:{hidden:function(t){var r=n.extend({},n.spEasyForms.defaults,t),i=r.row;i.row.attr("data-visibilityhidden")!=="true"&&i.row.attr("data-visibilityhidden","true").hide()},readOnly:function(t){var u=n.extend({},n.spEasyForms.defaults,t),r=u.row,o=i.getFormType(u),e,f;o!=="display"&&(e=n.spEasyForms.sharePointFieldRows.value(u),e||i.setTimeoutCalled||(u.noRecurse||(i.setTimeoutCalled=!0,setTimeout(function(){var t=n.extend({},n.spEasyForms.defauts,u),f;t.row=r;f=n.spEasyForms.sharePointFieldRows.value(t);n("#readOnly"+r.internalName).html(f);u.noRecurse=!0;i.transform(u);n.spEasyForms.adapterCollection.transform(u);n.spEasyForms.containerCollection.postTransform(u)},1e3)),e="&nbsp;"),r.row.attr("data-headerontop")==="true"?(f=n("<tr/>",{"data-visibilityadded":"true"}),f.append(n("<td/>",{valign:"top","class":"ms-formbody"})),f.children("td").append("<div/>"),f.find("div").html("<nobr class='speasyforms-columnheader'>"+r.displayName+"<\/nobr>"),f.children("td").append(e.length>0?e:"&nbsp;")):(f='<tr data-visibilityadded="true"><td valign="top" width="350px" class="ms-formlabel"><div><nobr class="speasyforms-columnheader">'+r.displayName+'<\/nobr><\/td><td class="ms-formbody"><span id="readOnly'+r.internalName+'">'+e+"<\/span><\/td><\/tr>",r.row.find("td.ms-formbody h3.ms-standardheader").length>0&&(f='<tr data-visibilityadded="true"><td valign="top" width="350px" class="ms-formbody"><h3 class="ms-standardheader"><nobr>'+r.displayName+"<\/nobr><\/h3>"+e+"<\/td><\/tr>")),r.row.attr("data-visibilityhidden")!=="true"&&r.row.attr("data-visibilityhidden","true").hide(),r.row.next().attr("data-visibilityadded")!=="true"&&n(f).insertAfter(r.row))},editable:function(){},highlightRed:function(t){n.spEasyForms.utilities.highlight(t.row.row,"LightPink")},highlightYellow:function(t){n.spEasyForms.utilities.highlight(t.row.row,"Yellow")},highlightGreen:function(t){n.spEasyForms.utilities.highlight(t.row.row,"SpringGreen")},highlightBlue:function(t){n.spEasyForms.utilities.highlight(t.row.row,"Aqua")}},scrubCollection:function(t){t.each(function(t,i){n(i).attr("data-visibilityadded")==="true"?n(i).remove():(n(i).next().attr("data-visibilityadded")==="true"&&n(i).next().remove(),n(i).attr("data-visibilityhidden")==="true"&&n(i).attr("data-visibilityhidden","false").show(),n(i).attr("data-visibilityclassadded")&&(n(i).removeClass(n(i).attr("data-visibilityclassadded")),n(i).attr("data-visibilityclassadded","")),n(i).find("[data-visibilityadded='true']").remove(),n(i).find("[data-visibilityhidden='true']").attr("data-visibilityhidden","false").show(),n(i).find("[data-visibilityclassadded!=''][data-visibilityclassadded]").each(function(){var t=n(this).attr("data-visibilityclassadded");n(this).removeClass(t).attr("data-visibilityclassadded","")}))})},transform:function(r){var u=n.extend({},n.spEasyForms.defaults,r),f;if(u.currentConfig&&u.currentConfig.visibility&&u.currentConfig.visibility.def&&Object.keys(u.currentConfig.visibility.def).length>0&&(n.each(n.spEasyForms.containerCollection.rows,function(r,f){if(u.row=f,f.internalName in u.currentConfig.visibility.def){var e=!1;n.each(u.currentConfig.visibility.def[f.internalName],function(r,f){var o;if(u.rule=f,!e){var s=i.checkForm(u),h=i.checkAppliesTo(u),c=i.checkConditionals(u);s&&h&&c&&(o=n.spEasyForms.utilities.jsCase(f.state),o in i.stateHandlers&&(i.scrubCollection(u.row.row),i.stateHandlers[o](u),e=!0))}f.conditions&&n.each(f.conditions,function(i,r){var u=n.spEasyForms.containerCollection.rows[r.name];u===t&&(u={displayName:r.name,internalName:r.name,spFieldType:r.name,value:"",row:n("<tr><td class='ms-formlabel'><h3 class='ms-standardheader'><\/h3><\/td><td class='ms-formbody'><\/td><\/tr>"),fieldMissing:!0});u.row.find("input").addClass("speasyforms-visibilitychangelistener");u.row.find("select").addClass("speasyforms-visibilitychangelistener");u.row.find("textarea").addClass("speasyforms-visibilitychangelistener")})});e||i.scrubCollection(u.row.row)}}),f=n("#s4-bodyContainer"),f.attr("data-visibilitychangelistener")!=="true")){f.attr("data-visibilitychangelistener","true");f.on("change",".speasyforms-visibilitychangelistener",function(){i.transform(u);n.spEasyForms.adapterCollection.transform(u);n.spEasyForms.containerCollection.postTransform(u)})}},toEditor:function(t){var i=n.extend({},n.spEasyForms.defaults,t);this.initialized||this.wireDialogEvents(i);this.drawRuleTableTab(i);this.initialized=!0;i.verbose||n("#staticVisibilityRules .speasyforms-fieldmissing").hide();n("#staticVisibilityRules .speasyforms-fieldmissing").length>0&&i.verbose&&n("#staticVisibilityRules .speasyforms-fieldmissing").addClass("ui-state-error")},toConfig:function(t){var u=n.extend({},n.spEasyForms.defaults,t),r=[],f=n("#conditionalVisibilityField").val(),i;return n("#conditionalVisibilityRules tr:not(:first)").each(function(t,i){var u=n(i).find("td"),e=u[1].innerHTML!=="Everyone"?u[1].innerHTML:"",f={state:u[0].innerHTML,appliesTo:e,forms:u[2].innerHTML,conditions:[]};n.each(n(u[3]).find("div.speasyforms-conditiondisplay"),function(t,i){var r=n(i).text().split(";"),u;r.length>=2&&(u={name:r[0],type:r[1],value:r.length===3?r[2]:""},u.name&&f.conditions.push(u))});r.push(f)}),i=n.spEasyForms.configManager.get(u),i.visibility.def[f]=r,i},launchDialog:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u=r.fieldName;r.fieldName in r.currentListContext.fields&&(u=r.currentListContext.fields[r.fieldName].displayName);n("#conditionalVisibilityField").val(r.fieldName);n("#conditionalVisibilityDialogHeader").text("Rules for Column '"+u+"'");n("#conditonalVisibilityRulesDialog").dialog("open");r.currentConfig.visibility=i.getVisibility(r);r.stat=!1;i.drawRuleTable(r)},drawRuleTable:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r;n("#conditionalVisibilityRules").html("");i.currentConfig.visibility.def[i.fieldName].length===0?n("#conditionalVisibilityRules").html("There are currently no rules for this field. Click the plus sign to add one."):(r=n("#spEasyFormsTemplates .speasyforms-visibilityrulestabletemplate").clone().attr("id","conditionalVisibilityRulesTable"),n("#conditionalVisibilityRules").append(r),n.each(i.currentConfig.visibility.def[i.fieldName],function(t,i){var u=n("#spEasyFormsTemplates .speasyforms-visibilityrulesrowtemplate").clone(),f="";i.conditions?n.each(i.conditions,function(n,t){f+="<div class='speasyforms-conditiondisplay'>"+t.name+";"+t.type+";"+t.value+"<\/div>"}):f="&nbsp;";u.find(".speasyforms-state").text(i.state);u.find(".speasyforms-appliesto").text(i.appliesTo);u.find(".speasyforms-forms").text(i.forms);u.find(".speasyforms-when").html(f);u.find("button[title='Edit Rule']").attr("id","addVisililityRuleButton"+t);u.find("button[title='Delete Rule']").attr("id","delVisililityRuleButton"+t);r.append(u)}),this.wireVisibilityRulesTable(i))},drawRuleTableTab:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r;n("#staticVisibilityRules").remove();r=n("#spEasyFormsTemplates .speasyforms-staticrulestabletemplate").clone().attr("id","staticVisibilityRules");Object.keys(i.currentConfig.visibility.def).length===0?r.append("<td class='ui-widget-content ui-corner-all nobr' colspan='5'>There are no conditional visibility rules for the current form.<\/td>"):n.each(Object.keys(i.currentConfig.visibility.def).sort(),function(t,u){n.each(i.currentConfig.visibility.def[u],function(f,e){var o,s;i.index=t+"_"+f;i.rowInfo=n.spEasyForms.containerCollection.rows[u];i.rowInfo||(n.spEasyForms.containerCollection.rows[u]={displayName:u,internalName:u,spFieldType:u,value:"",row:n("<tr><td class='ms-formlabel'><h3 class='ms-standardheader'><\/h3><\/td><td class='ms-formbody'><\/td><\/tr>"),fieldMissing:!0},i.rowInfo=n.spEasyForms.containerCollection.rows[u]);o=n("#spEasyFormsTemplates .speasyforms-staticrulesrowtemplate").clone().attr("id","visibilityRule"+i.index);n.spEasyForms.containerCollection.rows[u].fieldMissing&&o.addClass("speasyforms-fieldmissing").addClass("ui-state-error");s="";e.conditions&&e.conditions.length>0&&n.each(e.conditions,function(t,i){s+="<div class='speasyforms-conditiondisplay'>"+i.name+";"+i.type+";"+i.value+"<\/div>";(!n.spEasyForms.containerCollection.rows[i.name]||n.spEasyForms.containerCollection.rows[i.name].fieldMissing)&&o.addClass("speasyforms-fieldmissing").addClass("ui-state-error")});o.find(".speasyforms-displayname").text(i.rowInfo.displayName);o.find(".speasyforms-internalname").text(i.rowInfo.internalName);o.find(".speasyforms-state").text(e.state);o.find(".speasyforms-appliesto").text(e.appliesTo.length>0?e.appliesTo:"Everyone");o.find(".speasyforms-forms").text(e.forms);o.find(".speasyforms-when").html(s);i.rowInfo.fieldMissing&&o.find("td").addClass("speasyforms-fieldmissing");r.append(o)})});n("#tabs-min-visibility").append(r)},wireVisibilityRulesTable:function(t){var r=n.extend({},n.spEasyForms.defaults,t);n("[id^='delVisililityRuleButton']").button({icons:{primary:"ui-icon-closethick"},text:!1}).click(function(){r.index=this.id.replace("delVisililityRuleButton","");r.fieldName=n("#conditionalVisibilityField").val();r.currentConfig=n.spEasyForms.configManager.get(r);r.currentConfig.visibility.def[r.fieldName].splice(r.index,1);n.spEasyForms.configManager.set(r);i.drawRuleTable(r);r.refresh=n.spEasyForms.refresh.visibility;n.spEasyForms.containerCollection.toEditor(r)});n("[id^='addVisililityRuleButton']").button({icons:{primary:"ui-icon-gear"},text:!1}).click(function(){i.clearRuleDialog(r);r.index=this.id.replace("addVisililityRuleButton","");n("#visibilityRuleIndex").val(r.index);r.fieldName=n("#conditionalVisibilityField").val();n("#addVisibilityRuleField").val(r.fieldName);r.currentConfig=n.spEasyForms.configManager.get(r);var t=r.currentConfig.visibility.def[r.fieldName][r.index];return n("#addVisibilityRuleState").val(t.state),n.each(t.appliesTo.split(";"),function(t,r){if(r==="AUTHOR")n("#addVisibilityRuleApplyToAuthor")[0].checked=!0;else if(r.length>0){var u=n("<span>").addClass("speasyforms-entity").attr("title",r).text(r);n("<a>").addClass("speasyforms-remove").attr({href:"#",title:"Remove "+r}).text("x").appendTo(u);n("#spEasyFormsEntityPicker").prepend(u);n("#addVisibilityRuleApplyTo").val("").css("top",2);i.siteGroups.splice(n.inArray(r,i.siteGroups),1)}}),t.forms.indexOf("New")>=0?n("#addVisibilityRuleNewForm")[0].checked=!0:t.forms.indexOf("Edit")>=0?n("#addVisibilityRuleEditForm")[0].checked=!0:t.forms.indexOf("Display")>=0&&(n("#addVisibilityRuleDisplayForm")[0].checked=!0),t.conditions&&n.each(t.conditions,function(t,i){n("#conditionalField"+(t+1)).val(i.name);n("#conditionalType"+(t+1)).val(i.type);n("#conditionalValue"+(t+1)).val(i.value);n("#condition"+(t+1)).show();n(".speasyforms-condition:hidden").length===0&&n("#spEasyFormsAddConditionalBtn").hide()}),n("#addVisibilityRuleDialog").dialog("open"),!1});n("tbody.speasyforms-sortablerules").sortable({connectWith:".speasyforms-rulestable",items:"> tr:not(:first)",helper:"clone",placeholder:"speasyforms-placeholder",zIndex:990,update:function(t){t.handled||(r.currentConfig=i.toConfig(r),n.spEasyForms.configManager.set(r),i.drawRuleTable(r),r.refresh=n.spEasyForms.refresh.visibility,n.spEasyForms.containerCollection.toEditor(r),t.handled=!0)}})},wireDialogEvents:function(t){var r=n.extend({},n.spEasyForms.defaults,t),f={modal:!0,buttons:{Ok:function(){return n("#conditonalVisibilityRulesDialog").dialog("close"),!1}},autoOpen:!1,width:800},u;n("#conditonalVisibilityRulesDialog").dialog(f);u={modal:!0,buttons:{Ok:function(){var t,u;return r.state=n("#addVisibilityRuleState").val(),r.state===""?n("#addVisibilityRuleStateError").text("You must select a value for state!"):(r.currentConfig=n.spEasyForms.configManager.get(r),r.fieldName=n("#addVisibilityRuleField").val(),r.currentConfig.visibility=i.getVisibility(r),r.index=n("#visibilityRuleIndex").val(),r.index.length===0?(t=i.getRule(r),r.currentConfig.visibility.def[r.fieldName].push(t)):(u=i.getRule(r),r.currentConfig.visibility.def[r.fieldName][r.index]=u),n.spEasyForms.configManager.set(r),n("#addVisibilityRuleDialog").dialog("close"),n("#conditonalVisibilityRulesDialog").dialog("open"),i.drawRuleTable(r),r.refresh=n.spEasyForms.refresh.visibility,n.spEasyForms.containerCollection.toEditor(r)),!1},Cancel:function(){return n("#addVisibilityRuleDialog").dialog("close"),n("#conditonalVisibilityRulesDialog").dialog("open"),!1}},autoOpen:!1,width:750};n("#addVisibilityRuleDialog").dialog(u);n("#addVisibilityRule").button({icons:{primary:"ui-icon-plusthick"},text:!1}).click(function(){return n("#conditonalVisibilityRulesDialog").dialog("close"),i.clearRuleDialog(r),n("#addVisibilityRuleDialog").dialog("open"),!1});n("#spEasyFormsAddConditionalBtn").button({icons:{primary:"ui-icon-plusthick"},text:!1}).click(function(){return n(".speasyforms-condition:hidden").first().show(),n(".speasyforms-condition:hidden").length===0&&n("#spEasyFormsAddConditionalBtn").hide(),!1});n("input.speasyforms-entitypicker").autocomplete({source:this.siteGroups.sort(),select:function(t,r){var u=r.item.value,f=n("<span>").addClass("speasyforms-entity").attr("title",u).text(u);return n("<a>").addClass("speasyforms-remove").attr({href:"#",title:"Remove "+u}).text("x").appendTo(f),f.insertBefore(this),n(this).val("").css("top",2),i.siteGroups.splice(n.inArray(u,i.siteGroups),1),n(this).autocomplete("option","source",i.siteGroups.sort()),!1}});n(".speasyforms-entitypicker").click(function(){n(this).find("input").focus()});n("#spEasyFormsEntityPicker").on("click",".speasyforms-remove",function(){i.siteGroups.push(n(this).parent().attr("title"));n(this).closest("div").find("input").autocomplete("option","source",i.siteGroups.sort()).focus();n(this).parent().remove()})},getVisibility:function(t){var i=n.extend({},n.spEasyForms.defaults,t);return i.currentConfig.visibility||(i.currentConfig.visibility={def:{}}),i.currentConfig.visibility.def[i.fieldName]||(i.currentConfig.visibility.def[i.fieldName]=[]),i.currentConfig.visibility},getRule:function(t){var f=n.extend({},n.spEasyForms.defaults,t),i={},r,u;return i.state=f.state,i.forms="",n(".speasyforms-formcb").each(function(n,t){t.checked&&(i.forms.length>0&&(i.forms+=";"),i.forms+=this.id.replace("addVisibilityRule","").replace("Form",""))}),i.appliesTo="",n("#spEasyFormsEntityPicker .speasyforms-entity").each(function(t,r){i.appliesTo.length>0&&(i.appliesTo+=";");i.appliesTo+=n(r).attr("title")}),r=n("#addVisibilityRuleApplyToAuthor")[0].checked,r&&(i.appliesTo.length>0&&(i.appliesTo=";"+i.appliesTo),i.appliesTo="AUTHOR"+i.appliesTo),u=n(".speasyforms-conditionalvalue"),i.conditions=[],u.each(function(){if(n(this).val().length>=0&&n(this).prev().prev().val().length>0){var t={};t.name=n(this).prev().prev().val();t.type=n(this).prev().val();t.value=n(this).val();i.conditions.push(t)}}),i},clearRuleDialog:function(t){var u=n.extend({},n.spEasyForms.defaults,t),r;n("#addVisibilityRuleField").val(n("#conditionalVisibilityField").val());n("#visibilityRuleIndex").val("");n("#addVisibilityRuleState").val("");n("#addVisibilityRuleStateError").text("");n("#addVisibilityRuleApplyToAuthor").attr("checked",!1);n("#addVisibilityRuleApplyTo").val("");n("#spEasyFormsEntityPicker .speasyforms-entity").remove();n("#addVisibilityRuleNewForm").attr("checked",!0);n("#addVisibilityRuleEditForm").attr("checked",!0);n("#addVisibilityRuleDisplayForm").attr("checked",!0);n(".speasyforms-conditionalvalue").val("").not(":first").parent().hide();n(".speasyforms-conditionalfield").val("");n("#spEasyFormsAddConditionalBtn").show();r=n.spEasyForms.sharePointContext.getSiteGroups(u);n.each(r,function(t,r){n.inArray(r.name,i.siteGroups)<0&&i.siteGroups.push(r.name)})},getFormType:function(){var t="",n=window.location.pathname;return n=n.substring(n.lastIndexOf("/")+1).toLowerCase(),n==="start.aspx"&&(n=window.location.href.substring(window.location.href.indexOf("#")+1),n=n.substring(n.lastIndexOf("/")+1,n.indexOf("?")).toLowerCase()),n.indexOf("new")>=0?t="new":n.indexOf("edit")>=0&&n.toLocaleLowerCase().indexOf("listedit.aspx")&&n.toLocaleLowerCase().indexOf("fldnew.aspx")&&n.toLocaleLowerCase().indexOf("fldedit.aspx")?t="edit":(n.indexOf("disp")>=0||n.indexOf("display")>=0)&&(t="display"),t},checkForm:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u=i.getFormType(r),f=n(r.rule.forms.split(";")).map(function(){return this.toLowerCase()});return n.inArray(u,f)>=0},checkAppliesTo:function(t){var f=n.extend({},n.spEasyForms.defaults,t),r=!1,e,o,u,s,h;return f.rule.appliesTo.length===0?r=!0:(e=f.rule.appliesTo.split(";"),o=i.getFormType(f),e[0]==="AUTHOR"&&o==="new"?r=!0:(e[0]==="AUTHOR"&&(u=n("span:contains('Created  at')").find("a.ms-subtleLink").attr("href"),u||(u=n("td.ms-descriptiontext span a").attr("href")),u&&(s=parseInt(u.substring(u.indexOf("ID=")+3),10),s===f.currentContext.userId&&(r=!0))),r||(h=n.spEasyForms.sharePointContext.getUserGroups(f),n.each(h,function(t,i){if(n.inArray(i.name,e)>=0)return r=!0,!1})))),r},checkConditionals:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r=!1;return i.rule.conditions&&i.rule.conditions.length!==0?(r=!0,n.each(i.rule.conditions,function(t,u){var f;if(i.row=n.spEasyForms.containerCollection.rows[u.name],i.row){var e=n.spEasyForms.sharePointFieldRows.value(i),o=n.spEasyForms.utilities.jsCase(u.type),s=n.spEasyForms.visibilityRuleCollection.comparisonOperators[o];if(i.condition=u,f=n.spEasyForms.visibilityRuleCollection.expandRuleValue(i),r=s(e,f),r===!1)return!1}else return r=!1,!1})):r=!0,r},expandRuleValue:function(t){var f=n.extend({},n.spEasyForms.defaults,t),i=f.condition.value,e,r,u;return f.condition.value.indexOf("[CurrentUser")>=0&&(e=n.spEasyForms.sharePointContext.get(f),i=i.replace(/\[CurrentUser\]/g,"userdisp.aspx\\?ID="+e.userId+"['&]"),i=i.replace(/\[CurrentUserId\]/g,e.userId),i=i.replace(/\[CurrentUserLogin\]/g,e.userInformation.userName),i=i.replace(/\[CurrentUserEmail\]/g,e.userInformation.eMail)),r=new Date,f.condition.value.indexOf("[Today")>=0&&(i=i.replace(/\[Today\]/g,n.datepicker.formatDate("mm-dd-yy",r)),u=i.match(/(\[Today[+-][0-9]*\])/g),u&&n.each(n(u),function(t,u){try{var e=Number(u.match(/\[Today[+-]([0-9]*)\]/)[1]),f=new Date;u.indexOf("+")>=0?f.setTime(r.getTime()+e*864e5):f.setTime(r.getTime()-e*864e5);i=i.replace(u,n.datepicker.formatDate("mm/dd/yy",f))}catch(o){}})),f.condition.value.indexOf("[Now")>=0&&(i=i.replace(/\[Now\]/g,n.datepicker.formatDate("mm-dd-yy",r)+" "+r.getHours()+":"+r.getMinutes()),u=i.match(/(\[Now[+-][0-9]*\])/g),u&&n.each(n(u),function(t,u){try{var e=Number(u.match(/\[Now[+-]([0-9]*)\]/)[1]),f=new Date;u.indexOf("+")>=0?f.setTime(r.getTime()+e*6e4):f.setTime(r.getTime()-e*6e4);i=i.replace(u,n.datepicker.formatDate("mm/dd/yy",f)+" "+f.getHours()+":"+f.getMinutes())}catch(o){}})),i}};i=n.spEasyForms.visibilityRuleCollection})(spefjQuery);
/*
 * SPEasyForms.adapterCollection - collection of field control adapters.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n,t){n.spEasyForms.adapterCollection={adapterImplementations:{},supportedTypes:function(t){var u=n.extend({},n.spEasyForms.defaults,t),r=[];return u.currentConfig.adapters&&u.currentConfig.adapters.def&&(n.each(Object.keys(i.adapterImplementations),function(n,t){t in i.adapterImplementations&&(r=r.concat(i.adapterImplementations[t].supportedTypes(u)))}),r=n(r).filter(function(t,i){return n.inArray(i,r)===t})),r},transform:function(t){var r=n.extend({},n.spEasyForms.defaults,t);n.spEasyForms.isSettingsPage(r)||r.currentConfig&&r.currentConfig.adapters&&r.currentConfig.adapters.def&&(r.adapters=r.currentConfig.adapters.def,n.each(r.adapters,function(n,t){r.adapter=t;r.adapter.type in i.adapterImplementations&&i.adapterImplementations[r.adapter.type].transform(r)}))},toEditor:function(t){var r=n.extend({},n.spEasyForms.defaults,t);r.adapters=r.currentConfig.adapters.def;n.each(Object.keys(i.adapterImplementations),function(n,t){t in i.adapterImplementations&&i.adapterImplementations[t].toEditor(r)});n("#spEasyFormsAdapterTable tr.speasyforms-adapter-static").remove();n.each(Object.keys(r.adapters).sort(this.compareAdapters),function(n,t){r.adapter=r.adapters[t];r.fieldName=t;r.adapter.type in i.adapterImplementations&&i.drawAdapter(r)});n("#spEasyFormsAdapterTable tr.speasyforms-adapter-static").length===0&&n("#spEasyFormsAdapterTable").append("<tr class='speasyforms-adapter-static'><td class='ui-widget-content ui-corner-all nobr' colspan='5'>There are no adpaters configured for the current form.<\/td><\/tr>");n(".speasyforms-deleteadapter").button({icons:{primary:"ui-icon-closethick"},text:!1}).click(function(){var t=n(n(this).closest("tr").find("td")[1]).text();return r.currentConfig=n.spEasyForms.containerCollection.toConfig(r),delete r.currentConfig.adapters.def[t],n.spEasyForms.configManager.set(r),r.refresh=n.spEasyForms.refresh.adapters,n.spEasyForms.containerCollection.toEditor(r),!1})},launchDialog:function(r){var u=n.extend({},n.spEasyForms.defaults,r),f;n("#adapterTypeDialog").dialog({modal:!0,autoOpen:!1,width:400,buttons:{Ok:function(){n("#adapterTypeDialog").dialog("close");u.adapterType=n("#adapterType option:selected").text();n.each(i.adapterImplementations,function(n,t){t.type===u.adapterType&&(u.adapterImpl=t)});u.adapterImpl&&u.adapterImpl.launchDialog(u)},Cancel:function(){n("#adapterTypeDialog").dialog("close")}}});u.dialogLaunched=!1;u.adapters=u.currentConfig.adapters.def;u.adapter=t;u.fieldName in u.adapters&&(u.adapter=u.adapters[u.fieldName]);u.adapter&&(f=u.adapters[u.fieldName],f.type in i.adapterImplementations&&(i.adapterImplementations[f.type].launchDialog(u),u.dialogLaunced=!0));u.dialogLaunced||(u.typeAdapters=[],n.each(i.adapterImplementations,function(t,i){n.inArray(u.spFieldType,i.supportedTypes(u))>=0&&u.typeAdapters.push({impl:i,type:u.spFieldType})}),u.typeAdapters.length===1?u.typeAdapters[0].impl.launchDialog(u):(n("#adapterFieldType").text(u.spFieldType),n("#adapterType").find("option:not(:first)").remove(),n.each(u.typeAdapters,function(t,i){n("#adapterType").append("<option value='"+t+"'>"+i.impl.type+"<\/option>")}),n("#adapterTypeDialog").dialog("open")));n(".tabs-min").hide();n("#tabs-min-adapters").show()},getSupportedTypes:function(t){var r=n.extend({},n.spEasyForms.defaults,t),u=[];return n.each(i.adapterImplementations,function(t,i){n.inArray(r.spFieldType,i.supportedTypes(r))>=0&&u.push(i.type)}),u},drawAdapter:function(t){var r=n.extend({},n.spEasyForms.defaults,t),f=r.fieldName,u="",i;n.each(Object.keys(r.adapter).sort(),function(t,i){i!=="type"&&i!=="columnNameInternal"&&(u.length>0&&(u+="<br />"),u+="<b>"+n.spEasyForms.utilities.titleCase(i)+"<\/b> = "+r.adapter[i])});i=n("#spEasyFormsTemplates .speasyforms-adapterrowtemplate").clone().attr("data-fieldname",r.adapter.columnNameInternal);n("#spEasyFormsAdapterTable").append(i);n.spEasyForms.containerCollection.rows[r.adapter.columnNameInternal]&&!n.spEasyForms.containerCollection.rows[r.adapter.columnNameInternal].fieldMissing?f=n.spEasyForms.containerCollection.rows[r.adapter.columnNameInternal].displayName:i.addClass("speasyforms-fieldmissing").find("td").addClass("speasyforms-fieldmissing");i.find(".speasyforms-displayname").text(f);i.find(".speasyforms-internalname").text(r.adapter.columnNameInternal);i.find(".speasyforms-adaptertype").text(r.adapter.type);i.find(".speasyforms-adapterconfig").html(u);i.find("button.speasyforms-deleteadapter").attr("id",r.adapter.columnNameInternal+"Delete");r.verbose&&i.hasClass("speasyforms-fieldmissing")?i.find("td.speasyforms-adapter-static").addClass("ui-state-error"):i.hasClass("speasyforms-fieldmissing")&&i.addClass("speasyforms-hidden").find("td").addClass("speasyforms-hidden")},compareAdapters:function(t,i){var r=n.spEasyForms.sharePointContext.getListContext();return(t in r.fields&&(t=r.fields[t].displayName),i in r.fields&&(i=r.fields[i].displayName),t<i)?-1:t>i?1:0},validateRequired:function(t){var i=n("#"+t.id),r;i.parent().find(".speasyforms-error").remove();i.val()||(r=n("<div/>",{"class":"speasyforms-error"}).text("'"+t.displayName+"' is a required field!"),i.parent().append(r))}};var i=n.spEasyForms.adapterCollection})(spefjQuery);
/*
 * SPEasyForms.adapterCollection.autocompleteAdapter - implementation of type ahead field control 
 * adapter for SPFieldText.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n,t){var r=n.spEasyForms.adapterCollection,i;n.spEasyForms.autocompleteAdapter={type:"Autocomplete",supportedTypes:function(){return["SPFieldText"]},transform:function(t){var i=n.extend({},n.spEasyForms.defaults,t),r;i.adapter.columnNameInternal in n.spEasyForms.containerCollection.rows&&(r=[],n().SPServices({operation:"GetListItems",async:!0,listName:i.adapter.sourceList,CAMLViewFields:"<ViewFields><FieldRef Name='"+i.adapter.sourceField+"' /><\/ViewFields>",CAMLQuery:"<Query><OrderBy><FieldRef Name='"+i.adapter.sourceField+"' Ascending='True' /><\/OrderBy><\/Query>",completefunc:function(t){n(t.responseXML).SPFilterNode("z:row").each(function(){r.push(n(this).attr("ows_"+i.adapter.sourceField))});r.length>0&&n.spEasyForms.containerCollection.rows[i.adapter.columnNameInternal].row.find("input").autocomplete({source:r,minLength:2})}}))},toEditor:function(t){var i=n.extend({},n.spEasyForms.defaults,t),u={modal:!0,buttons:{Ok:function(){if(i.currentConfig=n.spEasyForms.containerCollection.toConfig(i),i.adapters=i.currentConfig.adapters.def,r.validateRequired({id:"autocompleteFieldSelect",displayName:"Lookup Field"}),n("#autocompleteListSelect").val()&&n("#autocompleteListSelect").val().length>0){if(n("#AutocompleteDialog").find(".speasyforms-error").length===0){var t={type:"Autocomplete",sourceList:n("#autocompleteListSelect").val(),sourceListTitle:n("#autocompleteListSelect option:selected").text(),sourceField:n("#autocompleteFieldSelect").val(),columnNameInternal:n("#autocompleteChildSelect").val()};i.adapters[t.columnNameInternal]=t;n.spEasyForms.configManager.set(i);n("#autocompleteAdapterDialog").dialog("close");i.refresh=n.spEasyForms.refresh.adapters;n.spEasyForms.containerCollection.toEditor(i)}}else n("#autoCompleteHiddenFieldName").val()in i.adapters&&(delete i.adapters[n("#autoCompleteHiddenFieldName").val()],n.spEasyForms.configManager.set(i),i.refresh=n.spEasyForms.refresh.adapters,n.spEasyForms.containerCollection.toEditor(i)),n("#autocompleteAdapterDialog").dialog("close")},Cancel:function(){return n("#autocompleteAdapterDialog").dialog("close"),!1}},autoOpen:!1,width:600};n("#autocompleteAdapterDialog").dialog(u)},launchDialog:function(i){var r=n.extend({},n.spEasyForms.defaults,i),u;n("#autocompleteAdapterDialog").find(".speasyforms-error").remove();r.adapter=t;r.fieldName in r.adapters&&(r.adapter=r.adapters[r.fieldName]);n("#autocompleteListSelect").val("");n("#autocompleteListSelect option").remove();n("#autocompleteListSelect").append("<option><\/option>");u=n.spEasyForms.sharePointContext.getListCollection(r);n.each(u,function(t,i){n("#autocompleteListSelect").append("<option value='"+i.id+"'>"+i.title+"<\/option>")});r.adapter&&n("#autocompleteListSelect").val(r.adapter.sourceList);r.listId=n("#autocompleteListSelect").val();r.listId?(r.autocompleteContext=n.spEasyForms.sharePointContext.getListContext(r),n("#autocompleteFieldSelect option").remove(),n("#autocompleteFieldSelect").append("<option><\/option>"),n.each(Object.keys(r.autocompleteContext.fields),function(t,i){n("#autocompleteFieldSelect").append("<option value='"+r.autocompleteContext.fields[i].internalName+"'>"+r.autocompleteContext.fields[i].displayName+"<\/option>")})):n("#autocompleteFieldSelect option").remove();r.adapter&&n("#autocompleteFieldSelect").val(r.adapter.sourceField);n("#autocompleteChildSelect option").remove();n("#autocompleteChildSelect").append("<option><\/option>");n.each(Object.keys(r.currentListContext.fields),function(t,i){n("#autocompleteChildSelect").append("<option value='"+r.currentListContext.fields[i].internalName+"'>"+r.currentListContext.fields[i].displayName+"<\/option>")});n("#autocompleteChildSelect").val(r.fieldName).attr("disabled","disabled");n("#autoCompleteHiddenFieldName").val(r.fieldName);n("#autocompleteChildSelect").val()!==n("#autoCompleteHiddenFieldName").val()&&(n("#autocompleteChildSelect").append("<option value='"+r.fieldName+"'>"+r.fieldName+"<\/option>"),n("#autocompleteChildSelect").val(r.fieldName).attr("disabled","disabled"));n("#autocompleteListSelect").attr("data-changelistener")!=="true"&&(n("#autocompleteListSelect").attr("data-changelistener","true"),n("#autocompleteListSelect").change(function(){r.listId=n("#autocompleteListSelect").val();r.listId&&(r.autocompleteContext=n.spEasyForms.sharePointContext.getListContext(r),n("#autocompleteFieldSelect option").remove(),n("#autocompleteFieldSelect").append("<option><\/option>"),n.each(Object.keys(r.autocompleteContext.fields),function(t,i){n("#autocompleteFieldSelect").append("<option value='"+r.autocompleteContext.fields[i].internalName+"'>"+r.autocompleteContext.fields[i].displayName+"<\/option>")}))}));n("#autocompleteAdapterDialog").dialog("open")}};i=n.spEasyForms.autocompleteAdapter;r.adapterImplementations[i.type]=i})(spefjQuery);
/*
 * SPEasyForms.adapterCollection.cascadingLookupAdapter - implementaiton of a cascading lookup field adapter.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var i=n.spEasyForms.adapterCollection,t;n.spEasyForms.cascadingLookupAdapter={type:"Cascading Lookup",supportedTypes:function(){return["SPFieldLookup"]},transform:function(t){var i=n.extend({},n.spEasyForms.defaults,t);i.adapter.parentColumnInternal in n.spEasyForms.containerCollection.rows&&i.adapter.columnNameInternal in n.spEasyForms.containerCollection.rows&&(i.adapter.parentColumn=n.spEasyForms.containerCollection.rows[i.adapter.parentColumnInternal].displayName,i.adapter.childColumn=n.spEasyForms.containerCollection.rows[i.adapter.columnNameInternal].displayName,i.adapter.listName=n.spEasyForms.sharePointContext.getCurrentListId(i),i.adapter.debug=n.spEasyForms.defaults.verbose,n().SPServices.SPCascadeDropdowns(i.adapter))},toEditor:function(r){if(!this.initialized){var u=n.extend({},n.spEasyForms.defaults,r),f={modal:!0,buttons:{Ok:function(){if(u.currentConfig=n.spEasyForms.containerCollection.toConfig(u),u.adapters=u.currentConfig.adapters.def,u.currentConfig.adapters||(u.currentConfig.adapters={}),u.currentConfig.adapters.def||(u.currentConfig.adapters.def={}),u.adapters=u.currentConfig.adapters.def,u.adapterField=n("#cascadingLookupHiddenFieldName").val(),n("#cascadingRelationshipListSelect").val().length===0)u.adapterField in u.adapters&&delete u.adapters[u.adapterField],n.spEasyForms.configManager.set(u),n("#cascadingLookupAdapterDialog").dialog("close"),u.refresh=n.spEasyForms.refresh.adapters,n.spEasyForms.containerCollection.toEditor(u);else if(i.validateRequired({id:"cascadingLookupRelationshipParentSelect",displayName:"Parent Column"}),i.validateRequired({id:"cascadingLookupRelationshipChildSelect",displayName:"Child Column"}),i.validateRequired({id:"cascadingLookupParentSelect",displayName:"Form Parent Column"}),i.validateRequired({id:"cascadingLookupChildSelect",displayName:"Form Child Column"}),n("#cascadingLookupAdapterDialog").find(".speasyforms-error").length===0){var r={};u.adapterField&&u.adapterField in u.adapters?r=u.adapters[u.adapterField]:u.adapters[u.adapterField]=r;r.type=t.type;r.relationshipList=n("#cascadingRelationshipListSelect").val();r.relationshipListTitle=n("#cascadingRelationshipListSelect option:selected").text();r.relationshipListParentColumn=n("#cascadingLookupRelationshipParentSelect").val();r.relationshipListChildColumn=n("#cascadingLookupRelationshipChildSelect").val();r.parentColumnInternal=n("#cascadingLookupParentSelect").val();r.columnNameInternal=n("#cascadingLookupChildSelect").val();n.spEasyForms.configManager.set(u);n("#cascadingLookupAdapterDialog").dialog("close");u.refresh=n.spEasyForms.refresh.adapters;n.spEasyForms.containerCollection.toEditor(u)}return!1},Cancel:function(){return n("#cascadingLookupAdapterDialog").dialog("close"),!1}},autoOpen:!1,width:650};n("#cascadingLookupAdapterDialog").dialog(f)}},launchDialog:function(i){var r=n.extend({},n.spEasyForms.defaults,i),f,u;t.clearDialog(r);f=n.spEasyForms.sharePointContext.getListCollection(r);n.each(f,function(t,i){n("#cascadingRelationshipListSelect").append("<option value='"+i.id+"'>"+i.title+"<\/option>")});n("#cascadingLookupList").val(r.currentListContext.title);n("#cascadingRelationshipListSelect").attr("data-change")!=="true"&&(n("#cascadingRelationshipListSelect").attr("data-change","true"),n("#cascadingRelationshipListSelect").change(function(){r.listId=n("#cascadingRelationshipListSelect").val().toLowerCase();t.initRelationshipFields({listId:n("#cascadingRelationshipListSelect").val().toLowerCase()})}),n("#cascadingLookupRelationshipParentSelect").change(function(){n("#cascadingLookupParentSelect").find("option[value='"+n("#cascadingLookupRelationshipParentSelect").val()+"']").length>0&&n("#cascadingLookupParentSelect").find("option[text='"+n("#cascadingLookupRelationshipParentSelect").text()+"']")}));n("#cascadingLookupChildSelect").val(r.fieldName);n("#cascadingLookupHiddenFieldName").val(r.fieldName);r.adapters=r.currentConfig.adapters.def;r.fieldName in r.adapters&&(u=r.adapters[r.fieldName],n("#cascadingRelationshipListSelect").val(u.relationshipList),t.initRelationshipFields({listId:u.relationshipList}),n("#cascadingLookupRelationshipParentSelect").val(u.relationshipListParentColumn),n("#cascadingLookupRelationshipChildSelect").val(u.relationshipListChildColumn),n("#cascadingLookupParentSelect").val(u.parentColumnInternal));n("#cascadingLookupAdapterDialog").dialog("open")},initRelationshipFields:function(t){var u=n.extend({},n.spEasyForms.defaults,t),i,r,f,e,o,s;n("#cascadingLookupRelationshipParentSelect").find("option").remove();n("#cascadingLookupRelationshipParentSelect").append("<option><\/option>");n("#cascadingLookupRelationshipParentSelect").val("");n("#cascadingLookupRelationshipParentSelect").attr("disabled","disabled");n("#cascadingLookupRelationshipChildSelect").find("option").remove();n("#cascadingLookupRelationshipChildSelect").append("<option><\/option>");n("#cascadingLookupRelationshipChildSelect").val("");n("#cascadingLookupRelationshipChildSelect").attr("disabled","disabled");u.listId&&(i=n.spEasyForms.sharePointContext.getListContext(u),n.each(Object.keys(i.fields),function(t,r){i.fields[r].spFieldType==="SPFieldLookup"&&n("#cascadingLookupRelationshipParentSelect").append("<option value='"+i.fields[r].internalName+"'>"+i.fields[r].displayName+"<\/option>");n("#cascadingLookupRelationshipChildSelect").append("<option value='"+i.fields[r].internalName+"'>"+i.fields[r].displayName+"<\/option>")}),n("#cascadingLookupRelationshipParentSelect").removeAttr("disabled"),n("#cascadingLookupRelationshipChildSelect").removeAttr("disabled"),r=n("#cascadingLookupRelationshipParentSelect").find("option"),r.length===2&&(n("#cascadingLookupRelationshipParentSelect").val(n(r[1]).attr("value")),f=n("#cascadingLookupRelationshipParentSelect option:selected").text(),e=n("#cascadingLookupParentSelect").find("option:contains('"+f+"')"),n("#cascadingLookupParentSelect").val(e.val())),o=n("#cascadingLookupChildSelect option:selected").text(),s=n("#cascadingLookupRelationshipChildSelect").find("option:contains('"+o+"')"),n("#cascadingLookupRelationshipChildSelect").val(s.val()))},clearDialog:function(){n("#cascadingLookupAdapterDialog").find(".speasyforms-error").remove();n("#cascadingRelationshipListSelect").find("option").remove();n("#cascadingRelationshipListSelect").append("<option><\/option>");n("#cascadingRelationshipListSelect").val("");n("#cascadingLookupRelationshipParentSelect").find("option").remove();n("#cascadingLookupRelationshipParentSelect").append("<option><\/option>");n("#cascadingLookupRelationshipParentSelect").val("");n("#cascadingLookupRelationshipParentSelect").attr("disabled","disabled");n("#cascadingLookupRelationshipChildSelect").find("option").remove();n("#cascadingLookupRelationshipChildSelect").append("<option><\/option>");n("#cascadingLookupRelationshipChildSelect").val("");n("#cascadingLookupRelationshipChildSelect").attr("disabled","disabled");n("#cascadingLookupParentSelect").find("option").remove();n("#cascadingLookupParentSelect").append("<option><\/option>");n("#cascadingLookupParentSelect").val("");n("#cascadingLookupChildSelect").find("option").remove();n("#cascadingLookupChildSelect").append("<option><\/option>");n("#cascadingLookupChildSelect").val("");var t=n.spEasyForms.containerCollection.rows;n.each(Object.keys(n.spEasyForms.containerCollection.rows).sort(n.spEasyForms.sharePointFieldRows.compareField),function(i,r){t[r].spFieldType==="SPFieldLookup"&&(n("#cascadingLookupParentSelect").append("<option value='"+t[r].internalName+"'>"+t[r].displayName+"<\/option>"),n("#cascadingLookupChildSelect").append("<option value='"+t[r].internalName+"'>"+t[r].displayName+"<\/option>"))})}};t=n.spEasyForms.cascadingLookupAdapter;i.adapterImplementations[t.type]=t})(spefjQuery);
/*
 * $.spEasyForms.defaultToCurrentUserAdapter - an adapter plug-in for SPEasyForms
 * that creates an adapter for user fields to enter a default value of the current
 * user on new forms.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var i=n.spEasyForms.containerCollection,r=n.spEasyForms.visibilityRuleCollection,u=n.spEasyForms.adapterCollection,t;n.spEasyForms.defaultToCurrentUserAdapter={type:"Default To Current User",supportedTypes:function(){return["SPFieldUser","SPFieldUserMulti"]},transform:function(t){var u=n.extend({},n.spEasyForms.defaults,t),e,f,o,s;r.getFormType(u)==="new"&&i.rows[u.adapter.columnNameInternal]&&(e=n("[id^='"+u.adapter.columnNameInternal+"'][id$='ClientPeoplePicker']"),f=n.spEasyForms.sharePointContext.getUserInformation(u).name,e.length>0?ExecuteOrDelayUntilScriptLoaded(function(){setTimeout(function(){var n=SPClientPeoplePicker.SPClientPeoplePickerDict[e[0].id];n.GetAllUserInfo().length===0&&(n.AddUserKeys(f),n.OnValueChangedClientScript=function(t,i){i.length===0&&document.activeElement&&document.activeElement.id!==n.EditorElementId&&n.AddUserKeys(f)})},1e3)},"clientpeoplepicker.js"):(o=i.rows[u.adapter.columnNameInternal].displayName,s=n().SPServices.SPFindPeoplePicker({peoplePickerDisplayName:o}),s.currentValue||ExecuteOrDelayUntilScriptLoaded(function(){setTimeout(function(){n().SPServices.SPFindPeoplePicker({peoplePickerDisplayName:o,valueToSet:f,checkNames:!1})},1e3)},"sp.js")))},toEditor:function(r){var u=n.extend({},n.spEasyForms.defaults,r),f,e;n("#addDefaultToCurrentUserDialog").length===0&&(f="<div id='addDefaultToCurrentUserDialog' class='speasyforms-dialogdiv' title='Default to Current User Adapter'>Would you like to add/remove a Default to Current User adapter to '<span id='defaultToCurrentFieldName'><\/span>'?<\/div>",n("#spEasyFormsContainerDialogs").append(f));e={modal:!0,buttons:{Add:function(){if(u.currentConfig=n.spEasyForms.containerCollection.toConfig(u),u.adapters=u.currentConfig.adapters.def,n("#defaultToCurrentFieldName").text().length>0){var r={type:t.type,columnNameInternal:n("#defaultToCurrentFieldName").text()};u.adapters[r.columnNameInternal]=r;n.spEasyForms.configManager.set(u);u.refresh=n.spEasyForms.refresh.adapters;i.toEditor(u)}n("#addDefaultToCurrentUserDialog").dialog("close")},Remove:function(){return u.currentConfig=n.spEasyForms.containerCollection.toConfig(u),u.adapters=u.currentConfig.adapters.def,n("#defaultToCurrentFieldName").text().length>0&&n("#defaultToCurrentFieldName").text()in u.adapters&&(delete u.adapters[n("#defaultToCurrentFieldName").text()],n.spEasyForms.configManager.set(u)),n("#addDefaultToCurrentUserDialog").dialog("close"),u.adaptersChanged=!0,u.refresh=n.spEasyForms.refresh.adapters,!1}},autoOpen:!1,width:400};n("#addDefaultToCurrentUserDialog").dialog(e)},launchDialog:function(t){var i=n.extend({},n.spEasyForms.defaults,t);n("#defaultToCurrentFieldName").text(i.fieldName);n("#addDefaultToCurrentUserDialog").dialog("open")}};t=n.spEasyForms.defaultToCurrentUserAdapter;u.adapterImplementations[t.type]=t})(typeof spefjQuery=="undefined"?null:spefjQuery);
/*
 * $.spEasyForms.lookupDetailAdapter - an adapter plug-in for SPEasyForms
 * that creates an adapter for text fields to listen for changes to a lookup
 * and pull in data from another field in the lookup list.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var i=n.spEasyForms.containerCollection,u=n.spEasyForms.adapterCollection,r=n.spEasyForms.sharePointFieldRows,t;n.spEasyForms.lookupDetailAdapter={type:"Lookup Detail",supportedTypes:function(){return["SPFieldText","SPFieldNote","SPFieldMultiLine","SPFieldChoice","SPFieldMultiChoice","SPFieldDateTime","SPFieldBoolean","SPFieldURL","SPFieldUser","SPFieldUserMulti","SPFieldCurrency","SPFieldNumber"]},transform:function(r){var u=n.extend({},n.spEasyForms.defaults,r),e=u.adapter,o=i.rows[e.columnNameInternal],f;o&&(f=i.rows[e.parentColumnInternal],f.row.find("select").attr("data-relationshipListListener")!=="true"&&(f.row.find("select").attr("data-relationshipListListener","true").change(function(){u.lookup=n(this);t.updateAllDetailFields(u)}),n.spEasyForms.visibilityRuleCollection.getFormType(u)==="new"&&(u.lookup=f.row.find("select"),t.updateAllDetailFields(u))))},toEditor:function(n){this.getRelationshipHelper(n).constructDialog()},launchDialog:function(t){var i=this.getRelationshipHelper(t);i.clearDialog();i.initControls();i.initDialog();n("#lookupDetailDialog").dialog("open")},getRelationshipHelper:function(i){var r=n.extend({},n.spEasyForms.defaults,i);return r.relationship={type:t.type,dialogDiv:"lookupDetailDialog",relationshipListColumn:{id:"lookupDetailRelationshipList",displayName:"Relationship List"},relationshipChildColumn:{id:"lookupDetailRelationshipDetailColumn",displayName:"Detail Column"},formListColumn:{id:"lookupDetailList",displayName:"This List"},formParentColumn:{id:"lookupDetailLookupColumn",displayName:"Form Lookup Column"},formChildColumn:{id:"lookupDetailDetailColumn",displayName:"Form Detail Column"}},new n.spEasyForms.relationshipListAdapterHelper(r)},updateAllDetailFields:function(t){var u=n.extend({},n.spEasyForms.defaults,t);if(u.lookup.val()==="0")n.each(Object.keys(u.adapters),function(n,t){var e=u.adapters[t],f;u.row=i.rows[e.columnNameInternal];u.row.value="";r.setValue(u);u.row.row.next().attr("data-visibilityadded")==="true"&&(f="",u.row.row.next().find("td.ms-formbody").find("h3").length>0&&(f=u.row.row.next().find("td.ms-formbody").find("h3")[0].outerHTML),u.row.row.next().find("td.ms-formbody").html(""),u.row.row.next().find("td.ms-formbody").append(f+"<span class='readonly'>"+u.row.value+"<\/span>"))});else{var o="<Query><Where><Eq><FieldRef Name='ID' /><Value Type='Counter'>"+u.lookup.val()+"<\/Value><\/Eq><\/Where><\/Query>",f="<ViewFields>",e=[];n.each(Object.keys(u.adapters),function(n,t){var i=u.adapters[t];i.parentColumnInternal===i.parentColumnInternal&&(e.push(i),f+="<FieldRef Name='"+i.relationshipListChildColumn+"'><\/FieldRef>")});f+="<\/ViewFields>";n().SPServices({operation:"GetListItems",async:!1,listName:u.adapter.relationshipList,CAMLQuery:o,CAMLViewFields:f,completefunc:function(t){n(t.responseXML).SPFilterNode("z:row").each(function(){var t=n(this);n.each(n(e),function(n,f){var s,h,e,o;if(u.row=i.rows[f.columnNameInternal],s=t.attr("ows_"+f.relationshipListChildColumn),typeof s!="undefined"&&s!==null)switch(u.row.spFieldType){case"SPFieldUser":case"SPFieldUserMulti":if(u.value=t.attr("ows_"+f.relationshipListChildColumn),u.value.indexOf(";#")>-1)for(h=u.value.split(";#"),u.value="",e=1;e<h.length;e+=2)u.value.length>0&&(u.value+=";"),u.value+=h[e];break;case"SPFieldDateTime":u.value=t.attr("ows_"+f.relationshipListChildColumn).replace(/-/g,"/");break;case"SPFieldURL":u.value=t.attr("ows_"+f.relationshipListChildColumn).replace(", ","|");break;default:u.value=t.attr("ows_"+f.relationshipListChildColumn).replace(/;#/g,";")}else u.value="";r.setValue(u);u.row.row.next().attr("data-visibilityadded")==="true"&&(o="",u.row.row.next().find("td.ms-formbody").find("h3").length>0?o=u.row.row.next().find("td.ms-formbody").find("h3")[0].outerHTML:u.row.row.next().find("td.ms-formbody").find("nobr.speasyforms-columnheader")&&(o=u.row.row.next().find("td.ms-formbody").find("nobr.speasyforms-columnheader").parent()[0].outerHTML),u.row.row.next().find("td.ms-formbody").html(""),u.row.row.next().find("td.ms-formbody").append(o+"<span class='readonly'>"+u.row.value+"<\/span>"))})})}})}n.spEasyForms.utilities.resizeModalDialog()}};t=n.spEasyForms.lookupDetailAdapter;u.adapterImplementations[t.type]=t})(typeof spefjQuery=="undefined"?null:spefjQuery);
/*
 * $.spEasyForms.starRatingAdapter - an adapter plug-in for SPEasyForms that
 * can be applied to integer fields and allows users to enter 0-5 stars as the
 * value by clicking on the stars or a slider-like interface.
 *
 * 
 * @copyright 2014-2018 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){var t=n.spEasyForms.containerCollection,r=n.spEasyForms.visibilityRuleCollection,u=n.spEasyForms.adapterCollection,i;n.spEasyForms.starRatingAdapter={type:"Star Rating",supportedTypes:function(){return["SPFieldNumber"]},transform:function(i){var u=n.extend({},n.spEasyForms.defaults,i),f,o,s,e;t.rows[u.adapter.columnNameInternal]&&(f=t.rows[u.adapter.columnNameInternal],o=f.value?f.value:0,r.getFormType(u)==="display"?n("#"+u.adapter.columnNameInternal+"Stars").length===0&&(s=f.row.find("td.ms-formbody"),s.html("<div id='"+u.adapter.columnNameInternal+"Stars' class='speasyforms-stars'>"),n("#"+u.adapter.columnNameInternal+"Stars").css("background-position","0px "+20*o+"px")):n("#"+u.adapter.columnNameInternal+"Stars").length===0&&(e=f.row.find("input"),e.hide(),e.parent().prepend("<div id='"+u.adapter.columnNameInternal+"Stars' class='speasyforms-stars'><div id='"+u.adapter.columnNameInternal+"StarsSlider' class='speasyforms-starsslider'><\/div><\/div>"),n("#"+u.adapter.columnNameInternal+"Stars").css("background-position","0px "+20*o+"px"),n("#"+u.adapter.columnNameInternal+"StarsSlider").click(function(t){var r=n(this).offset().left,i=Math.floor((t.pageX-r+10)/20);e.val(i);n("#"+u.adapter.columnNameInternal+"Stars").css("background-position","0px "+20*i+"px")})))},toEditor:function(r){var u=n.extend({},n.spEasyForms.defaults,r),f,e;n("#addStarRatingAdapterDialog").length===0&&(f="<div id='addStarRatingAdapterDialog' class='speasyforms-dialogdiv' title='Star Rating Adapter'>Would you like to add/remove a Star Rating adapter to '<span id='starRatingFieldName'><\/span>'?<\/div>",n("#spEasyFormsContainerDialogs").append(f));e={modal:!0,buttons:{Add:function(){if(u.currentConfig=n.spEasyForms.containerCollection.toConfig(u),u.adapters=u.currentConfig.adapters.def,n("#starRatingFieldName").text().length>0){var r={type:i.type,columnNameInternal:n("#starRatingFieldName").text()};u.adapters[r.columnNameInternal]=r;n.spEasyForms.configManager.set(u);u.refresh=n.spEasyForms.refresh.adapters;t.toEditor(u)}n("#addStarRatingAdapterDialog").dialog("close")},Remove:function(){return u.currentConfig=n.spEasyForms.containerCollection.toConfig(u),u.adapters=u.currentConfig.adapters.def,n("#starRatingFieldName").text().length>0&&n("#starRatingFieldName").text()in u.adapters&&(delete u.adapters[n("#starRatingFieldName").text()],n.spEasyForms.configManager.set(u)),n("#addStarRatingAdapterDialog").dialog("close"),u.refresh=n.spEasyForms.refresh.adapters,t.toEditor(u),!1}},autoOpen:!1,width:400};n("#addStarRatingAdapterDialog").dialog(e)},launchDialog:function(t){var i=n.extend({},n.spEasyForms.defaults,t);n("#starRatingFieldName").text(i.fieldName);n("#addStarRatingAdapterDialog").dialog("open")}};i=n.spEasyForms.starRatingAdapter;u.adapterImplementations[i.type]=i})(typeof spefjQuery=="undefined"?null:spefjQuery);
/*!
 CLEditor WYSIWYG HTML Editor v1.4.5
 http://premiumsoftware.net/CLEditor
 requires jQuery v1.4.2 or later
 Copyright 2010, Chris Landowski, Premium Software, LLC
 Dual licensed under the MIT or GPL Version 2 licenses.
 Modified for sharepoint plugin by Joe McShea - all my changes have a comment with my name.
*/
(function(n){function vi(i){var e=this,y=i.target,p=n.data(y,a),w=s[p],b=w.popupName,g=f[b],v,k;if(!e.disabled&&n(y).attr(r)!==r){if(v={editor:e,button:y,buttonName:p,popup:g,popupName:b,command:w.command,useCSS:e.options.useCSS},w.buttonClick&&w.buttonClick(i,v)===!1)return!1;if(p==="source")if(l(e)){delete e.range;e.$area.hide();e.$frame.show();y.title=w.title;try{t?e.doc.body.contentEditable=!0:e.doc.designMode="on"}catch(nt){}}else{e.$frame.hide();e.$area.show();y.title="Show Rich Text";try{t?e.doc.body.contentEditable=!1:e.doc.designMode="off"}catch(nt){}e.$area.focus()}else if(!l(e)){if(b){if(k=n(g),b==="url"){if(p==="link"&&ri(e)==="")return ut(e,"A selection is required when inserting a link.",y),!1;k.children(":button").unbind(u).bind(u,function(){var t=k.find(":text"),i=n.trim(t.val());i!==""&&h(e,v.command,i,null,v.button);t.val("http://");o();c(e)})}else b==="pastetext"&&k.children(":button").unbind(u).bind(u,function(){var n=k.find("textarea"),t=n.val().replace(/\n/g,"<br />");t!==""&&h(e,v.command,t,null,v.button);n.val("");o();c(e)});return y!==n.data(g,d)?(ui(e,g,y),!1):void 0}if(p==="print")e.$frame[0].contentWindow.print();else if(!h(e,v.command,v.value,v.useCSS,y))return!1}if(v.editor.options.buttonClickCallBack)return v.editor.options.buttonClickCallBack(i,v);c(e)}}function kt(t){var i=n(t.target).closest("div");i.css(et,i.data(a)?"#FC6":"#FFC")}function dt(t){n(t.target).closest("div").css(et,"transparent")}function yi(i){var v=this,y=i.data.popup,r=i.target,l;if(y!==f.msg&&!n(y).hasClass(tt)){var w=n.data(y,d),u=n.data(w,a),p=s[u],b=p.command,e,k=v.options.useCSS;if(u==="font"?e=r.style.fontFamily.replace(/"/g,""):u==="size"?(r.tagName.toUpperCase()==="DIV"&&(r=r.children[0]),e=r.innerHTML):u==="style"?e="<"+r.tagName+">":u==="color"?e=ti(r.style.backgroundColor):u==="highlight"&&(e=ti(r.style.backgroundColor),t?b="backcolor":k=!0),l={editor:v,button:w,buttonName:u,popup:y,popupName:p.popupName,command:b,value:e,useCSS:k},!p.popupClick||p.popupClick(i,l)!==!1){if(l.command&&!h(v,l.command,l.value,l.useCSS,w))return!1;o();c(v)}}}function it(n){for(var t=1,i=0,r=0;r<n.length;++r)t=(t+n.charCodeAt(r))%65521,i=(i+t)%65521;return i<<16|t}function pi(n){n.$area.val("");ft(n)}function gt(r,u,e,o,s){var h,c;return f[r]?f[r]:(h=n(i).hide().addClass(si).appendTo("body"),o?h.html(o):r==="color"?(c=u.colors.split(" "),c.length<10&&h.width("auto"),n.each(c,function(t,r){n(i).appendTo(h).css(et,"#"+r)}),e=hi):r==="font"?n.each(u.fonts.split(","),function(t,r){n(i).appendTo(h).css("fontFamily",r).html(r)}):r==="size"?n.each(u.sizes.split(","),function(t,r){n(i).appendTo(h).html('<font size="'+r+'">'+r+"<\/font>")}):r==="style"?n.each(u.styles,function(t,r){n(i).appendTo(h).html(r[1]+r[0]+r[1].replace("<","<\/"))}):r==="url"?(h.html('<label>Enter URL:<br /><input type="text" value="http://" style="width:200px" /><\/label><br /><input type="button" value="Submit" />'),e=tt):r==="pastetext"&&(h.html('<label>Paste your content here:<br /><textarea rows="3" style="width:200px"><\/textarea><\/label><br /><input type="button" value="Submit" />'),e=tt),e||o||(e=pt),h.addClass(e),t&&h.attr(ot,"on").find("div,font,p,h1,h2,h3,h4,h5,h6").attr(ot,"on"),(h.hasClass(pt)||s===!0)&&h.children().hover(kt,dt),f[r]=h[0],h[0])}function ni(n,i){i?(n.$area.attr(r,r),n.disabled=!0):(n.$area.removeAttr(r),delete n.disabled);try{t?n.doc.body.contentEditable=!i:n.doc.designMode=i?"off":"on"}catch(u){}b(n)}function h(n,i,r,u,f){var c,h,o,s,l;if(rt(n),t||((u===undefined||u===null)&&(u=n.options.useCSS),n.doc.execCommand("styleWithCSS",0,u.toString())),c=i.toLowerCase()==="inserthtml",t&&c)w(n).pasteHTML(r);else if(y&&c)h=e(n),o=h.getRangeAt(0),o.deleteContents(),o.insertNode(o.createContextualFragment(r)),h.removeAllRanges(),h.addRange(o);else{s=!0;try{s=n.doc.execCommand(i,0,r||null)}catch(a){l=a.message;s=!1}s||("cutcopypaste".indexOf(i)>-1?ut(n,"For security reasons, your browser does not support the "+i+" command. Try using the keyboard shortcut or context menu instead.",f):ut(n,l?l:"Error executing the "+i+" command.",f))}return b(n),ct(n,!0),s}function c(n){setTimeout(function(){l(n)?n.$area.focus():n.$frame[0].contentWindow.focus();b(n)},0)}function w(n){return t?e(n).createRange():e(n).getRangeAt(0)}function e(n){return t?n.doc.selection:n.$frame[0].contentWindow.getSelection()}function ti(n){var i=/rgba?\((\d+), (\d+), (\d+)/.exec(n),t;if(i){for(n=(i[1]<<16|i[2]<<8|i[3]).toString(16);n.length<6;)n="0"+n;return"#"+n}return(t=n.split(""),n.length===4)?"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:n}function o(){n.each(f,function(t,i){n(i).hide().unbind(u).removeData(d)})}function ii(){var t=n("link[href*=cleditor]").attr("href");return t.replace(/^(.*\/)[^\/]+$/,"$1")+"images/"}function wi(n){return"url("+ii()+n+")"}function ht(i){var h=i.$main,r=i.options;i.$frame&&i.$frame.remove();var u=i.$frame=n('<iframe frameborder="0" src="about:blank" />').hide().appendTo(h),l=u[0].contentWindow,f=i.doc=l.document,s=n(f);f.open();f.write(r.docType+"<html>"+(r.docCSSFile===""?"":'<head><link rel="stylesheet" type="text/css" href="'+r.docCSSFile+'" /><\/head>')+'<body style="'+r.bodyStyle+'"><\/body><\/html>');f.close();(t||y)&&s.click(function(){c(i)});ft(i);t||y?(s.bind("beforedeactivate beforeactivate selectionchange keypress keyup keydown",function(n){if(n.type==="beforedeactivate")i.inactive=!0;else if(n.type==="beforeactivate")!i.inactive&&i.range&&i.range.length>1&&i.range.shift(),delete i.inactive;else if(!i.inactive)for(i.range||(i.range=[]),i.range.unshift(w(i));i.range.length>2;)i.range.pop();return n.type==="keydown"&&r.keyDownCallback?r.keyDownCallback(n,i):n.type==="selectionchange"&&r.selectionChangeCallback?r.selectionChangeCallback(n,i):void 0}),u.focus(function(){rt(i);n(i).triggerHandler(nt)}),u.blur(function(){n(i).triggerHandler(k)})):(n(u[0].contentWindow).focus(function(){n(i).triggerHandler(nt)}).blur(function(){n(i).triggerHandler(k)}),s.bind("keydown selectionchange",function(n){return n.type==="keydown"&&r.keyDownCallback?r.keyDownCallback(n,i):n.type==="selectionchange"&&r.selectionChangeCallback?r.selectionChangeCallback(n,i):void 0}));s.click(o).keydown(function(n){t&&e(i).type==="Control"&&n.keyCode===8&&(e(i).clear(),n.preventDefault())}).bind("keyup mouseup",function(){b(i);ct(i,!0)});st?i.$area.show():u.show();n(function(){var t=i.$toolbar,f=t.children("div:last"),e=h.width(),n=f.offset().top+f.outerHeight()-t.offset().top+1;t.height(n);n=(/%/.test(""+r.height)?h.height():parseInt(r.height,10))-n;u.width(e).height(n);i.$area.width(e).height(li?n-27:n-25);ni(i,i.disabled);b(i)})}function b(i){var u,e;st||!ai||i.focused||(i.$frame[0].contentWindow.focus(),window.focus(),i.focused=!0);u=i.doc;t&&(u=w(i));e=l(i);n.each(i.$toolbar.find("."+vt),function(o,s){var v=n(s),h=n.cleditor.buttons[n.data(s,a)],c=h.command,l=!0,p;if(i.disabled)l=!1;else if(h.getEnabled)p={editor:i,button:s,buttonName:h.name,popup:f[h.popupName],popupName:h.popupName,command:h.command,useCSS:i.options.useCSS},l=h.getEnabled(p),l===undefined&&(l=!0);else if((e||st)&&h.name!=="source"||t&&(c==="undo"||c==="redo"))l=!1;else if(c&&c!=="print"&&(t&&c==="hilitecolor"&&(c="backcolor"),!t&&!y||c!=="inserthtml"))try{l=u.queryCommandEnabled(c)}catch(w){l=!1}l?(v.removeClass(yt),v.removeAttr(r)):(v.addClass(yt),v.attr(r,r))})}function rt(n){n.range&&(t?n.range[0].select():y&&e(n).addRange(n.range[0]))}function bi(n){setTimeout(function(){l(n)?n.$area.select():h(n,"selectall")},0)}function ki(i){var u,r,f;return(rt(i),u=w(i),t)?u.htmlText:(r=n("<layer>")[0],r.appendChild(u.cloneContents()),f=r.innerHTML,r=null,f)}function ri(n){return(rt(n),t)?w(n).text:e(n).toString()}function ut(n,t,i){var r=gt("msg",n.options,ci);r.innerHTML=t;ui(n,r,i)}function ui(t,i,r){var f,h,c,e=n(i),l,s;r?(l=n(r),f=l.offset(),h=--f.left,c=f.top+l.height()):(s=t.$toolbar,f=s.offset(),h=Math.floor((s.width()-e.width())/2)+f.left,c=f.top+s.height()-2);o();e.css({left:h,top:c}).show();r&&(n.data(i,d,r),e.bind(u,{popup:i},n.proxy(yi,t)));setTimeout(function(){e.find(":text,textarea").eq(0).focus().select()},100)}function l(n){return n.$area.is(":visible")}function ft(t,i){var r=t.$area.val(),o=t.options,f=o.updateFrame,s=n(t.doc.body),e,u;if(r.length===0&&(r="<div><\/div>",t.$area.val(r)),f){if(e=it(r),i&&t.areaChecksum===e)return;t.areaChecksum=e}u=f?f(r):r;u=u.replace(/<(?=\/?script)/ig,"&lt;");o.updateTextArea&&(t.frameChecksum=it(u));u!==s.html()&&(s.html(u),n(t).triggerHandler(g))}function ct(t,i){var r=n(t.doc.body).html(),o=t.options,f=o.updateTextArea,s=t.$area,e,u;if(r==="<div><\/div>"&&(r=""),f){if(e=it(r),i&&t.frameChecksum===e)return;t.frameChecksum=e}u=f?f(r):r;o.updateFrame&&(t.areaChecksum=it(u));u!==s.val()&&(s.val(u),n(t).triggerHandler(g))}var p,bt;if(n){n.cleditor={defaultOptions:{width:"auto",height:250,controls:"bold italic underline strikethrough subscript superscript | font size style | color highlight removeformat | bullets numbering | outdent indent | alignleft center alignright justify | undo redo | rule image link unlink | cut copy paste pastetext | print source",colors:"FFF FCC FC9 FF9 FFC 9F9 9FF CFF CCF FCF CCC F66 F96 FF6 FF3 6F9 3FF 6FF 99F F9F BBB F00 F90 FC6 FF0 3F3 6CC 3CF 66C C6C 999 C00 F60 FC3 FC0 3C0 0CC 36F 63F C3C 666 900 C60 C93 990 090 399 33F 60C 939 333 600 930 963 660 060 366 009 339 636 000 300 630 633 330 030 033 006 309 303",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Narrow,Garamond,Georgia,Impact,Sans Serif,Serif,Tahoma,Trebuchet MS,Verdana",sizes:"1,2,3,4,5,6,7",styles:[["Paragraph","<p>"],["Header 1","<h1>"],["Header 2","<h2>"],["Header 3","<h3>"],["Header 4","<h4>"],["Header 5","<h5>"],["Header 6","<h6>"]],useCSS:!0,docType:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',docCSSFile:"",bodyStyle:"margin:4px; font:10pt Arial,Verdana; cursor:text"},buttons:{init:"bold,,|italic,,|underline,,|strikethrough,,|subscript,,|superscript,,|font,,fontname,|size,Font Size,fontsize,|style,,formatblock,|color,Font Color,forecolor,|highlight,Text Highlight Color,hilitecolor,color|removeformat,Remove Formatting,|bullets,,insertunorderedlist|numbering,,insertorderedlist|outdent,,|indent,,|alignleft,Align Text Left,justifyleft|center,,justifycenter|alignright,Align Text Right,justifyright|justify,,justifyfull|undo,,|redo,,|rule,Insert Horizontal Rule,inserthorizontalrule|image,Insert Image,insertimage,url|link,Insert Hyperlink,createlink,url|unlink,Remove Hyperlink,|cut,,|copy,,|paste,,|pastetext,Paste as Text,inserthtml,|print,,|source,Show Source"},imagesPath:function(){return ii()}};n.fn.cleditor=function(t){var i=n([]);return this.each(function(r,u){if(u.tagName.toUpperCase()==="TEXTAREA"){var f=n.data(u,lt);f||(f=new cleditor(u,t));i=i.add(f)}}),i};var et="backgroundColor",k="blurred",d="button",a="buttonName",g="change",lt="cleditor",u="click",r="disabled",i="<div>",nt="focused",ot="unselectable",fi="cleditorMain",ei="cleditorToolbar",at="cleditorGroup",vt="cleditorButton",yt="cleditorDisabled",oi="cleditorDivider",si="cleditorPopup",pt="cleditorList",hi="cleditorColor",tt="cleditorPrompt",ci="cleditorMsg",v=navigator.userAgent.toLowerCase(),t=/msie/.test(v),li=/msie\s6/.test(v),y=/(trident)(?:.*rv:([\w.]+))?/.test(v),ai=/webkit/.test(v),st=/iPhone|iPad|iPod/i.test(v),f={},wt,s=n.cleditor.buttons;n.each(s.init.split("|"),function(n,t){var i=t.split(","),r=i[0];s[r]={stripIndex:n,name:r,title:i[1]===""?r.charAt(0).toUpperCase()+r.substr(1):i[1],command:i[2]===""?r:i[2],popupName:i[3]===""?r:i[3]}});delete s.init;cleditor=function(r,f){var e=this;e.options=f=n.extend({},n.cleditor.defaultOptions,f);var l=e.$area=n(r).css({border:"none",margin:0,padding:0}).hide().data(lt,e).blur(function(){ft(e,!0)}),v=e.$main=n(i).addClass(fi).width(f.width).height(f.height),y=e.$toolbar=n(i).addClass(ei).appendTo(v),h=n(i).addClass(at).appendTo(y),c=0;n.each(f.controls.split(" "),function(r,o){var l,v,p;if(o==="")return!0;o==="|"?(n(i).addClass(oi).appendTo(h),h.width(c+1),c=0,h=n(i).addClass(at).appendTo(y)):(l=s[o],v=n(i).data(a,l.name).attr("buttonName",l.name),v.addClass(vt).attr("title",l.title),v.bind(u,n.proxy(vi,e)).appendTo(h),v.hover(e.options.hoverEnter?e.options.hoverEnter:kt,e.options.hoverLeave?e.options.hoverLeave:dt),c+=22,h.width(c+1),p={},l.css?p=l.css:l.image&&(p.backgroundImage=wi(l.image)),l.stripIndex&&(p.backgroundPosition=l.stripIndex*-22),v.css(p),t&&v.attr(ot,"on"),l.popupName&&gt(l.popupName,f,l.popupClass,l.popupContent,l.popupHover))});v.insertBefore(l).append(l);wt||(n(document).click(function(t){var i=n(t.target);i.add(i.parents()).is("."+tt)||o()}),wt=!0);/auto|%/.test(""+f.width+f.height)&&n(window).bind("resize.cleditor",function(){ht(e)});ht(e)};p=cleditor.prototype;bt=[["clear",pi],["disable",ni],["execCommand",h],["focus",c],["hidePopups",o],["sourceMode",l,!0],["refresh",ht],["select",bi],["selectedHTML",ki,!0],["selectedText",ri,!0],["showMessage",ut],["updateFrame",ft],["updateTextArea",ct]];n.each(bt,function(n,t){p[t[0]]=function(){for(var u,n=this,r=[n],i=0;i<arguments.length;i++)r.push(arguments[i]);return(u=t[1].apply(n,r),t[2])?u:n}});p.blurred=function(t){var i=n(this);return t?i.bind(k,t):i.trigger(k)};p.change=function(t){var i=n(this);return t?i.bind(g,t):i.trigger(g)};p.focused=function(t){var i=n(this);return t?i.bind(nt,t):i.trigger(nt)}}})(typeof spefjQuery=="undefined"?null:spefjQuery);
/*
 * jquery.cleditor.sharepoint plugin to make cleditor look and act like the OOBSharePoint
 * rich text editor (except less buggy/finicky).
 *
 * @copyright 2015 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
(function(n){function s(n,t){return c(t.editor,"rtl")}function h(n,t){return c(t.editor,"ltr")}function a(t,i){var r=i.editor,s=r.$frame[0].contentDocument||r.$frame[0].contentWindow.document,h=r.$frame[0].contentWindow||r.$frame[0].contentDocument.defaultView,e=o(h,s),u;return e&&(u=f(e,["div"]),u.length>0?u.css("background-color",t.target.style.backgroundColor):n("body",r.doc).html("<div style='background-color: "+t.target.style.backgroundColor+"'>"+n("body",r.doc).html()+"<\/div>"),r.updateTextArea(r),r.focus()),!1}function c(t,i){var e=t.$frame[0].contentDocument||t.$frame[0].contentWindow.document,s=t.$frame[0].contentWindow||t.$frame[0].contentDocument.defaultView,u=o(s,e),r;return u&&(r=f(u,["div","span","p"]),r.length>0?r.attr("dir",i):n("body",t.doc).html("<div dir='"+i+"'>"+n("body",t.doc).html()+"<\/div>"),t.updateTextArea(t),t.focus()),!1}function l(i){n.each(n(Object.keys(n.cleditor.stickyButtons)),function(n,u){var e=r[u],l,h;if(e.tagNames){var s=i.$main.find("div[buttonName='"+u+"']"),a=i.$frame[0].contentDocument||i.$frame[0].contentWindow.document,v=i.$frame[0].contentWindow||i.$frame[0].contentDocument.defaultView,c=o(v,a);c&&(l=e.tagNames.constructor===Array?e.tagNames:[e.tagNames],h=f(c,l),h.length>0?e.attrName&&e.attrValue?h.attr(e.attrName)===e.attrValue?t(s,!0):t(s,!1):t(s,!0):t(s,!1))}})}function f(t,i){return t.tagName&&n.inArray(t.tagName.toLowerCase(),i)>-1?n(t):n(t).closest(i.join())}function t(t,i){!i&&e(t)?n(t).css("background-color","transparent"):i&&!e(t)&&n(t).css("background-color","rgb(255, 229, 204)")}function e(t){return n(t).css("background-color")==="rgb(255, 229, 204)"?!0:!1}function o(n,t){var i=null,r,u,f;return n.getSelection?(r=n.getSelection(),r.rangeCount>0&&(u=r.getRangeAt(0),i=u.commonAncestorContainer)):t.selection&&(f=t.selection.createRange(),i=f.parentElement()),i}var i,r,u;n&&(n.cleditor.buttonShortcuts={key66:{name:"bold",title:"Bold (Ctrl + B)",keyCode:66,shift:!1},key73:{name:"italic",title:"Italic (Ctrl + I)",keyCode:73,shift:!1},key85:{name:"underline",title:"Underline (Ctrl + U)",keyCode:85,shift:!1},key117:{name:"underline",title:"Underline (Ctrl + U)",keyCode:117,shift:!1},key76:{name:"alignleft",title:"Align Left (Ctrl + L)",keyCode:76,shift:!1},key69:{name:"center",title:"Align Center (Ctrl + E)",keyCode:69,shift:!1},key82:{name:"alignright",title:"Align Right (Ctrl + R)",keyCode:114,shift:!1},keyS69:{name:"numbering",title:"Numbered List (Ctrl + Shift + E)",keyCode:69,shift:!0},keyS76:{name:"bullets",title:"Bulleted List (Ctrl + Shift + L)",keyCode:76,shift:!0},keyS77:{name:"outdent",title:"Decrease Indent (Ctrl + Shift + M)",keyCode:77,shift:!0},key77:{name:"indent",title:"Increase Indent (Ctrl + M)",keyCode:77,shift:!1},keyS188:{name:"ltr",title:"Left to Right (Ctrl + Shift + >)",keyCode:188,shift:!0},keyS190:{name:"rtl",title:"Right to Left (Ctrl + Shift + <)",keyCode:190,shift:!0}},i=n.cleditor.buttonShortcuts,n.cleditor.stickyButtons={bold:{tagNames:"strong"},italic:{tagNames:"em"},underline:{tagNames:"u"},alignleft:{tagNames:"div",attrName:"align",attrValue:"left"},center:{tagNames:"div",attrName:"align",attrValue:"center"},alignright:{tagNames:"div",attrName:"align",attrValue:"right"},bullets:{tagNames:"ul"},numbering:{tagNames:"ol"},ltr:{tagNames:["div","ol","ul","span","p"],attrName:"dir",attrValue:"ltr"},rtl:{tagNames:["div","ol","ul","span","p"],attrName:"dir",attrValue:"rtl"},source:!0},r=n.cleditor.stickyButtons,n.cleditor.buttons.rtl={name:"rtl",stripIndex:33,title:"Right to Left",buttonClick:s},n.cleditor.buttons.ltr={name:"ltr",stripIndex:32,title:"Left to Right",buttonClick:h},n.cleditor.buttons.backgroundcolor={name:"backgroundcolor",stripIndex:34,title:"Background Color",popupName:"color",popupClick:a},n.cleditor.defaultOptions.controls=n.cleditor.defaultOptions.controls.replace("source","ltr rtl source"),n.cleditor.defaultOptions.controls=n.cleditor.defaultOptions.controls.replace("highlight","highlight backgroundcolor"),u=!1,n.fn.sharePoint_Original_cleditor=n.fn.cleditor,n.fn.cleditor=function(t){if(!u){var r=n.spEasyForms.utilities.siteRelativePathAsAbsolutePath("/Style Library/SPEasyFormsAssets/2018.03/Css/jquery.cleditor.css");n("head").append('<link rel="stylesheet" type="text/css" href="'+r+'">');u=!0}return n.each(n(Object.keys(i)),function(t,r){var u=i[r];n.cleditor.buttons[u.name].title=u.title}),this.sharePoint_Original_cleditor(t)},n.cleditor.defaultOptions.cleditor_sharepoint_keyDownCallback=n.cleditor.defaultOptions.keyDownCallback,n.cleditor.defaultOptions.keyDownCallback=function(t,r){var f,u,e;if(t.keyCode>17){if(f="key"+(t.shiftKey?"S":"")+t.keyCode,t.type==="keydown"&&t.ctrlKey&&f in i)return u=i[f],u.name==="ltr"?s(t,{editor:r}):u.name==="rtl"?h(t,{editor:r}):(e=n.cleditor.buttons[u.name],r.execCommand(e.command,undefined,r.options.useCSS,t.target)),t.preventDefault(),t.keyCode=0,!1;if(n.cleditor.defaultOptions.cleditor_sharepoint_keyDownCallback)return l(r),n.cleditor.defaultOptions.cleditor_sharepoint_keyDownCallback(t,r);l(r)}return!0},n.cleditor.defaultOptions.cleditor_sharepoint_buttonClickCallBack=n.cleditor.defaultOptions.buttonClickCallBack,n.cleditor.defaultOptions.buttonClickCallBack=function(n,i){i.buttonName in r&&!r[i.buttonName].closestSelector&&(e(i.button)?t(i.button,!1):t(i.button,!0))},n.cleditor.defaultOptions.hoverEnter=function(t){var i=n(t.target).closest("div");i.css("background-color")!=="rgb(255, 229, 204)"&&i.css("background-color","rgb(255, 204, 153)")},n.cleditor.defaultOptions.hoverLeave=function(t){var i=n(t.target).closest("div");i.css("background-color")!=="rgb(255, 229, 204)"&&i.css("background-color","transparent")})})(typeof spefjQuery=="undefined"?null:spefjQuery);
/*!
 CLEditor XHTML Plugin v1.0.1
 http://premiumsoftware.net/cleditor
 requires CLEditor v1.3.0 or later
 
 Copyright 2010, Chris Landowski, Premium Software, LLC
 Dual licensed under the MIT or GPL Version 2 licenses.
 Based on John Resig's HTML Parser Project (ejohn.org)
 http://ejohn.org/files/htmlparser.js
 Original code by Erik Arvidsson, Mozilla Public License
 http://erik.eae.net/simplehtmlparser/simplehtmlparser.js
*/
(function(n){if(n){var t=n.cleditor.defaultOptions.updateTextArea;n.cleditor.defaultOptions.updateTextArea=function(i){return t&&(i=t(i)),n.cleditor.convertHTMLtoXHTML(i)};n.cleditor.convertHTMLtoXHTML=function(n){function f(n){for(var i={},r=n.split(","),t=0;t<r.length;t++)i[r[t]]=!0;return i}function k(n,r,u,f){var o,s;if(r=r.toLowerCase(),r==="p"&&(n=n.replace("<p","<div"),r="div"),v[r])while(t.last()&&y[t.last()])e("",t.last());for(p[r]&&t.last()==r&&e("",r),f=a[r]||!!f,f||t.push(r),o=[],u.replace(l,function(n,t){var i=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:w[t]?t:"";o.push({name:t,escaped:i.replace(/(^|[^\\])"/g,'$1\\"')})}),i+="<"+r,s=0;s<o.length;s++)i+=" "+o[s].name+'="'+o[s].escaped+'"';i+=(f?"/":"")+">"}function e(n,r){var u,f;if(r){for(r=r.toLowerCase(),r==="p"&&(n=n.replace("p","div"),r="div"),u=t.length-1;u>=0;u--)if(t[u]==r)break}else u=0;if(u>=0){for(f=t.length-1;f>=u;f--)i+="<\/"+t[f]+">";t.length=u}}function c(n,t){i=i.replace(n,t)}var s=/^<(\w+)((?:\s+[\w+-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,h=/^<\/(\w+)[^>]*>/,l=/([\w+-]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,a=f("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),v=f("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),y=f("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),p=f("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),w=f("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),b=f("script,style"),t=[],r,u,o,i;for(t.last=function(){return this[this.length-1]},o=n,i="";n;){if(t.last()&&b[t.last()]?(n=n.replace(new RegExp("(.*)<\/"+t.last()+"[^>]*>"),function(n,t){return t=t.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),i+=t,""}),e("",t.last())):n.indexOf("<!--")===0?(r=n.indexOf("-->"),r>=0&&(i+=n.substring(0,r+3),n=n.substring(r+3))):n.indexOf("<\/")===0?(u=n.match(h),u&&(n=n.substring(u[0].length),u[0].replace(h,e))):n.indexOf("<")===0?(u=n.match(s),u&&(n=n.substring(u[0].length),u[0].replace(s,k))):(r=n.indexOf("<"),i+=r<0?n:n.substring(0,r),n=r<0?"":n.substring(r)),n==o)throw"Parse Error: "+n;o=n}return e(),c(/<b>(.*?)<\/b>/g,"<strong>$1<\/strong>"),c(/<i>(.*?)<\/i>/g,"<em>$1<\/em>"),i}}})(typeof spefjQuery=="undefined"?null:spefjQuery);
//# sourceMappingURL=jQuery.SPEasyForms.min.js.map